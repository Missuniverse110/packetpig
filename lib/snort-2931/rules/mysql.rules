# Copyright 2001-2012 Sourcefire Inc. All Rights Reserved.
#
# This file may contain proprietary rules that were created, tested and
# certified by Sourcefire, Inc. (the "VRT Certified Rules") as well as
# rules that were created by Sourcefire and other third parties and
# distributed under the GNU General Public License (the "GPL Rules").  The
# VRT Certified Rules contained in this file are the property of
# Sourcefire, Inc. Copyright 2012 Sourcefire, Inc. All Rights Reserved.
# The GPL Rules created by Sourcefire, Inc. are the property of
# Sourcefire, Inc. Copyright 2002-2012 Sourcefire, Inc. All Rights
# Reserved.  All other GPL Rules are owned and copyrighted by their
# respective owners (please see www.snort.org/contributors for a list of
# owners and their respective copyrights).  In order to determine what
# rules are VRT Certified Rules or GPL Rules, please refer to the VRT
# Certified Rules License Agreement.
#
#-------------
# MYSQL RULES
#-------------
#
# These signatures detect unusual and potentially malicious mysql traffic.
#
# These signatures are not enabled by default as they may generate false
# positive alarms on networks that do mysql development.
#

# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL root login attempt"; flow:to_server,established; content:"|0A 00 00 01 85 04 00 00 80|root|00|"; fast_pattern:only; metadata:service mysql; classtype:protocol-command-decode; sid:1775; rev:7;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL show databases attempt"; flow:to_server,established; content:"|0F 00 00 00 03|show databases"; fast_pattern:only; metadata:service mysql; classtype:protocol-command-decode; sid:1776; rev:7;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL 4.0 root login attempt"; flow:to_server,established; content:"|01|"; depth:1; offset:3; content:"root|00|"; within:5; distance:5; nocase; metadata:service mysql; classtype:protocol-command-decode; sid:3456; rev:7;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL create function access attempt"; flow:to_server,established; content:"|03|create"; offset:4; nocase; pcre:"/\x03create\s+(aggregate\s+)*function/smi"; metadata:service mysql; reference:bugtraq,12781; reference:cve,2005-0709; classtype:misc-activity; sid:3528; rev:7;)
# alert tcp $SQL_SERVERS 3306 -> $EXTERNAL_NET any (msg:"MYSQL server greeting"; flow:to_client,established; content:"|00|"; depth:1; offset:3; flowbits:set,mysql.server_greeting; flowbits:noalert; metadata:service mysql; reference:bugtraq,10655; reference:cve,2004-0627; reference:nessus,12639; reference:url,www.nextgenss.com/advisories/mysql-authbypass.txt; classtype:attempted-user; sid:3665; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL protocol 41 secure client overflow attempt"; flow:to_server,established; flowbits:isset,mysql.server_greeting; content:"|01|"; depth:1; offset:3; byte_test:1,&,0x80,4; byte_test:1,&,0x02,4; content:"|00 14|"; offset:36; isdataat:74,relative; content:!"|00|"; within:74; metadata:service mysql; reference:bugtraq,10655; reference:cve,2004-0627; reference:nessus,12639; reference:url,www.nextgenss.com/advisories/mysql-authbypass.txt; classtype:misc-attack; sid:3669; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL client authentication bypass attempt"; flow:to_server,established; flowbits:isset,mysql.server_greeting; content:"|01|"; depth:1; offset:3; byte_test:1,&,0x80,4; byte_test:1,!&,0x02,4; content:"|00 14 00|"; offset:9; metadata:service mysql; reference:bugtraq,10655; reference:cve,2004-0627; reference:nessus,12639; reference:url,www.nextgenss.com/advisories/mysql-authbypass.txt; classtype:misc-attack; sid:3668; rev:11;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL client overflow attempt"; flow:to_server,established; flowbits:isset,mysql.server_greeting; content:"|01|"; depth:1; offset:3; byte_test:1,!&,0x80,4; byte_test:1,!&,0x02,4; content:"|00|"; offset:9; isdataat:74,relative; content:!"|00|"; within:74; metadata:service mysql; reference:bugtraq,10655; reference:cve,2004-0627; reference:nessus,12639; reference:url,www.nextgenss.com/advisories/mysql-authbypass.txt; classtype:misc-attack; sid:3672; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL secure client overflow attempt"; flow:to_server,established; flowbits:isset,mysql.server_greeting; content:"|01|"; depth:1; offset:3; byte_test:1,&,0x80,4; byte_test:1,!&,0x02,4; content:"|00 14|"; offset:9; isdataat:74,relative; content:!"|00|"; within:74; metadata:service mysql; reference:bugtraq,10655; reference:cve,2004-0627; reference:nessus,12639; reference:url,www.nextgenss.com/advisories/mysql-authbypass.txt; classtype:misc-attack; sid:3670; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL protocol 41 client authentication bypass attempt"; flow:to_server,established; flowbits:isset,mysql.server_greeting; content:"|01|"; depth:1; offset:3; byte_test:1,&,0x80,4; byte_test:1,&,0x02,4; content:"|00 14 00|"; offset:36; metadata:service mysql; reference:bugtraq,10655; reference:cve,2004-0627; reference:nessus,12639; reference:url,www.nextgenss.com/advisories/mysql-authbypass.txt; classtype:misc-attack; sid:3667; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL protocol 41 client overflow attempt"; flow:to_server,established; flowbits:isset,mysql.server_greeting; content:"|01|"; depth:1; offset:3; byte_test:1,!&,0x80,4; byte_test:1,&,0x02,4; content:"|00|"; offset:36; isdataat:74,relative; content:!"|00|"; within:74; metadata:service mysql; reference:bugtraq,10655; reference:cve,2004-0627; reference:nessus,12639; reference:url,www.nextgenss.com/advisories/mysql-authbypass.txt; classtype:misc-attack; sid:3671; rev:9;)
# alert tcp $SQL_SERVERS 3306 -> $EXTERNAL_NET any (msg:"MYSQL server greeting finished"; flow:to_client,established; byte_test:1,>,0,3; flowbits:isset,mysql.server_greeting; flowbits:unset,mysql.server_greeting; flowbits:noalert; metadata:service mysql; reference:bugtraq,10655; reference:cve,2004-0627; reference:nessus,12639; reference:url,www.nextgenss.com/advisories/mysql-authbypass.txt; classtype:attempted-user; sid:3666; rev:11;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL create function buffer overflow attempt"; flow:to_server,established; content:"|03|create"; offset:4; nocase; pcre:"/\x03create\s+(aggregate\s+)*function\s+\S{50}/smi"; metadata:service mysql; reference:bugtraq,14509; reference:cve,2005-2558; classtype:misc-activity; sid:4649; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL Date_Format denial of service attempt"; flow:to_server,established; content:"DATE_FORMAT"; nocase; pcre:"/DATE_FORMAT\x28\s*(\x22[^\x22]+\x25[^\x22]*\x22|\x27[^\x27]+\x25[^\x27]*\x27)/smi"; metadata:service mysql; reference:bugtraq,19032; reference:cve,2006-3469; reference:url,dev.mysql.com/doc/refman/5.0/en/news-5-0-21.html; classtype:attempted-dos; sid:8057; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL yaSSL SSLv2 Client Hello Message Cipher Length Buffer Overflow attempt"; flow:to_server,established; flowbits:isnotset,sslv2.server_hello.request; flowbits:isnotset,tlsv1.server_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|01|"; depth:1; offset:6; byte_test:2,>,64,9; flowbits:set,sslv2.client_hello.request; metadata:policy security-ips drop, service mysql; reference:bugtraq,27140; reference:cve,2008-0226; reference:url,bugs.mysql.com/bug.php?id=33814; classtype:attempted-user; sid:13711; rev:8;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL yaSSL SSLv2 Client Hello Message Session ID Buffer Overflow attempt"; flow:to_server,established; flowbits:isnotset,sslv2.server_hello.request; flowbits:isnotset,tlsv1.server_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|01|"; depth:1; offset:6; byte_test:2,>,32,11; flowbits:set,sslv2.client_hello.request; metadata:policy security-ips drop, service mysql; reference:bugtraq,27140; reference:cve,2008-0226; reference:url,bugs.mysql.com/bug.php?id=33814; classtype:attempted-user; sid:13712; rev:8;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL yaSSL SSLv3 Client Hello Message Cipher Specs Buffer Overflow attempt"; flow:to_server,established; flowbits:isnotset,sslv2.server_hello.request; flowbits:isnotset,tlsv1.server_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|16 03 01|"; content:"|01|"; within:1; distance:2; content:"|03 01|"; within:2; distance:3; byte_jump:1,32,relative; byte_test:2,>,64,0,relative; metadata:policy security-ips drop, service mysql; reference:bugtraq,27140; reference:cve,2008-0226; reference:url,bugs.mysql.com/bug.php?id=33814; classtype:attempted-user; sid:13714; rev:9;)
# alert tcp $SQL_SERVERS 3306 -> $EXTERNAL_NET any (msg:"MYSQL yaSSL TLSv1 Server_Hello request"; flow:to_client,established; flowbits:isset,tlsv1.client_hello.request; content:"|16 03 01|"; depth:3; content:"|02|"; depth:1; offset:5; flowbits:set,tlsv1.server_hello.request; flowbits:noalert; metadata:service mysql; classtype:protocol-command-decode; sid:13710; rev:4;)
# alert tcp $SQL_SERVERS 3306 -> $EXTERNAL_NET any (msg:"MYSQL yaSSL SSLv2 Server_Hello request"; flow:to_client,established; flowbits:isset,sslv2.client_hello.request; content:"|04|"; depth:1; offset:2; content:"|00 02|"; depth:2; offset:5; flowbits:set,sslv2.server_hello.request; flowbits:noalert; metadata:service mysql; classtype:protocol-command-decode; sid:13709; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL yaSSL SSLv2 Client Hello Message Challenge Buffer Overflow attempt"; flow:to_server,established; flowbits:isnotset,sslv2.server_hello.request; flowbits:isnotset,tlsv1.server_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|01|"; depth:1; offset:6; byte_test:2,>,32,13; flowbits:set,sslv2.client_hello.request; metadata:policy security-ips drop, service mysql; reference:bugtraq,27140; reference:cve,2008-0226; reference:url,bugs.mysql.com/bug.php?id=33814; classtype:attempted-user; sid:13713; rev:8;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL XML Functions ExtractValue Scalar XPath denial of service attempt"; flow:to_server,established; content:"|03|"; depth:1; offset:4; content:"SELECT"; distance:0; nocase; content:"ExtractValue"; distance:1; nocase; pcre:"/^.{4}\x03\s*SELECT\s+ExtractValue\s*\x28.*?\x2c\s*((\x22|\x27)?[0-9].*?|(?P<q1>(\x22|\x27)?)\x28.*?\x29(?P=q1)|.*?\x24\x40.*?|\x22.*?\x27.*?|\x27.*?\x22.*?)\s*\x29/siO"; metadata:policy balanced-ips drop, policy security-ips drop, service mysql; reference:bugtraq,33972; reference:cve,2009-0819; reference:url,dev.mysql.com/doc/refman/5.1/en/news-5-1-32.html; reference:url,secunia.com/advisories/34115; classtype:attempted-dos; sid:15442; rev:4;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL XML Functions UpdateXML Scalar XPath denial of service attempt"; flow:to_server,established; content:"|03|"; depth:1; offset:4; content:"SELECT"; distance:0; nocase; content:"UpdateXML"; distance:1; nocase; pcre:"/^.{4}\x03\s*SELECT\s+UpdateXML\s*\x28.*?\x2c\s*((\x22|\x27)?[0-9].*?|(?P<q1>(\x22|\x27)?)\x28.*?\x29(?P=q1)|.*?\x24\x40.*?|\x22.*?\x27.*?|\x27.*?\x22.*?)\s*\x2c.*?\x29/siO"; metadata:policy balanced-ips drop, policy security-ips drop, service mysql; reference:bugtraq,33972; reference:cve,2009-0819; reference:url,dev.mysql.com/doc/refman/5.1/en/news-5-1-32.html; reference:url,secunia.com/advisories/34115; classtype:attempted-dos; sid:15443; rev:4;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL create function libc arbitrary code execution attempt"; flow:to_server,established; content:"|03|create function"; depth:16; offset:4; content:"libc.so"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service mysql; reference:bugtraq,12781; reference:cve,2005-0709; classtype:attempted-user; sid:15952; rev:3;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL yaSSL library cert parsing stack overflow attempt"; flow:to_server,established; content:"|16 03 01|"; depth:3; content:"|0B|"; within:1; distance:2; content:"*|86 00 84 00 00 04|>"; within:8; distance:56; metadata:policy balanced-ips drop, policy security-ips drop, service mysql; reference:bugtraq,37640; reference:cve,2009-4484; classtype:attempted-user; sid:16385; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL mysql_log COM_CREATE_DB format string vulnerability exploit attempt"; flow:to_server,established; content:"|05|"; depth:1; offset:4; content:"|25|"; distance:0; byte_jump:3,0,little; isdataat:0,relative; isdataat:!1,relative; metadata:policy security-ips drop, service mysql; reference:bugtraq,35609; reference:cve,2009-2446; classtype:attempted-user; sid:16707; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL mysql_log COM_DROP_DB format string vulnerability exploit attempt"; flow:to_server,established; content:"|06|"; depth:1; offset:4; content:"|25|"; distance:0; byte_jump:3,0,little; isdataat:0,relative; isdataat:!1,relative; metadata:policy security-ips drop, service mysql; reference:bugtraq,35609; reference:cve,2009-2446; classtype:attempted-user; sid:16708; rev:5;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL create function mysql.func arbitrary library injection attempt"; flow:to_server,established; content:"|03|"; depth:5; content:"mysql.func"; distance:0; nocase; pcre:"/(INSERT|UPDATE)\s*[\s\w]*((mysql\.)?func)[^\r\n]+values\s*\([^\)]+\x2c[\x22\x27][^\x22\x27]*\x2f/i"; metadata:policy balanced-ips drop, policy security-ips drop, service mysql; reference:bugtraq,12781; reference:cve,2005-0710; classtype:attempted-user; sid:17412; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL IN NULL argument denial of service attempt"; flow:to_server,established; content:"|03|"; depth:1; offset:4; content:"SELECT"; distance:0; nocase; content:"IN"; distance:0; nocase; content:"NULL"; within:10; fast_pattern; nocase; pcre:"/IN\s*\x28\s*NULL\s*\x2C\s*[0-9a-z\x24\x5F\x60]/i"; metadata:service mysql; reference:bugtraq,42596; reference:cve,2010-3678; classtype:attempted-dos; sid:19001; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL yaSSL SSL Hello Message Buffer Overflow attempt"; flow:to_server,established; content:"|16 03 01|"; content:"|01|"; content:"|03 01|"; within:2; distance:3; byte_jump:1,32,relative; byte_test:2,>,64,0,relative; reference:bugtraq,27140; reference:cve,2008-0226; reference:url,bugs.mysql.com/bug.php?id=33814; classtype:attempted-admin; sid:13593; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL yaSSL SSL Hello Message Buffer Overflow attempt"; flow:to_server,established; flowbits:isnotset,sslv2.server_hello.request; flowbits:isnotset,tlsv1.server_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|20 00 00 01|"; depth:4; content:"|8D|"; within:2; content:"|00 00 00 00 00 40 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 03 01 00 00 00 00 0F FF|"; within:42; metadata:policy security-ips drop, service mysql; reference:cve,2008-0226; reference:url,aluigi.altervista.org/adv/yasslick-adv.txt; reference:url,bugs.mysql.com/bug.php?id=33814; classtype:attempted-admin; sid:18513; rev:6;)
alert tcp any any -> $SQL_SERVERS 3306 (msg:"MYSQL MySQL/MariaDB client authentication bypass attempt"; flow:to_server,established; content:"|00 00 01|"; depth:3; offset:1; fast_pattern; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; within:23; distance:9; pcre:"/^\w+\x00/iRm"; detection_filter:track by_src,count 100, seconds 5; metadata:policy balanced-ips drop, policy security-ips drop, service mysql; reference:cve,2012-2122; classtype:attempted-admin; sid:23115; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"MYSQL MaxDB WebSQL wppassword buffer overflow"; flow:to_server,established; content:"websql?logon"; nocase; content:"wqPassword="; distance:0; nocase; pcre:"/wqPassword=[^\r\n\x26]{294}/i"; metadata:service http; reference:bugtraq,12265; reference:cve,2005-0111; reference:url,www.osvdb.org/displayvuln.php?osvdb_id=12919; classtype:web-application-attack; sid:3518; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 9999 (msg:"MYSQL MaxDB WebSQL wppassword buffer overflow default port"; flow:to_server,established; content:"websql?logon"; nocase; content:"wqPassword="; distance:0; nocase; pcre:"/wqPassword=[^\r\n\x26]{294}/i"; reference:bugtraq,12265; reference:cve,2005-0111; reference:url,www.osvdb.org/displayvuln.php?osvdb_id=12919; classtype:web-application-attack; sid:3519; rev:7;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL Database COM_FIELD_LIST Buffer Overflow attempt"; flow:to_server,established; content:"|04|"; depth:1; offset:4; pcre:"/^[^\x0D\x0A\x00]{512}/iR"; metadata:policy balanced-ips drop, policy security-ips drop, service mysql; reference:cve,2010-1850; classtype:attempted-user; sid:16703; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 9999 (msg:"MYSQL MaxDB Webtool GET command overflow attempt"; flow:to_server,established; content:"GET /%AAAAAAAA"; depth:14; metadata:service http; reference:bugtraq,13368; reference:cve,2005-0684; classtype:attempted-user; sid:15951; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL login handshake information disclosure attempt"; flow:to_server,established; content:"|01 0D A6 03 00 00 00 00 01 08|"; fast_pattern:only; metadata:policy security-ips drop, service mysql; reference:bugtraq,17780; reference:cve,2006-1516; classtype:misc-activity; sid:16020; rev:7;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL database Procedure Analyse denial of service attempt - 2"; flow:to_server,established; content:",|00 00 00 03|select * from `theview` procedure analyse|28 29|"; depth:48; metadata:policy balanced-ips drop, policy security-ips drop, service mysql; reference:cve,2009-4019; reference:url,dev.mysql.com/doc/refman/5.1/en/news-5-1-41.html; classtype:attempted-dos; sid:16349; rev:4;)
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL database PROCEDURE ANALYSE denial of service attempt - 1"; flow:to_server,established; content:"'|00 00 00 03|select * from `v1` procedure analyse|28 29|"; depth:43; metadata:policy balanced-ips drop, policy security-ips drop, service mysql; reference:cve,2009-4019; reference:url,dev.mysql.com/doc/refman/5.1/en/news-5-1-41.html; classtype:attempted-dos; sid:16348; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL Database CASE NULL argument denial of service attempt"; flow:to_server,established; content:"|03|select|20 28|case|20 28 60|a|60 29 20|when"; depth:30; content:"group|20|by|20 60|a|60 0A|with|20|rollup"; within:100; metadata:service mysql; reference:bugtraq,42596; reference:cve,2010-3678; classtype:attempted-dos; sid:19000; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL Database unique set column denial of service attempt"; flow:to_server,established; content:"select 1 from |60|t2|60| join |60|t1|60| on 1 like |60|a|60|"; fast_pattern:only; metadata:policy security-ips drop, service mysql; reference:bugtraq,42646; reference:cve,2010-3677; classtype:attempted-dos; sid:19093; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL Database unique set column denial of service attempt"; flow:to_server,established; content:"select |2A| from A join B on |27|val|27| like colA"; fast_pattern:only; metadata:policy security-ips drop, service mysql; reference:bugtraq,42646; reference:cve,2010-3677; classtype:attempted-dos; sid:19094; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"MYSQL Database SELECT subquery denial of service attempt"; flow:to_server,established; content:"|65 6C 65 63 74 20 2A 20 66 72 6F 6D 20 62 6F 6F 6D 29 20 69|"; fast_pattern:only; metadata:policy security-ips drop, service mysql; reference:cve,2009-4019; reference:url,bugs.mysql.com/bug.php?id=48291; classtype:attempted-dos; sid:20053; rev:4;)
# alert tcp $SQL_SERVERS 3306 -> $EXTERNAL_NET any (msg:"MYSQL failed Oracle Mysql login attempt"; flow:established,to_client; content:"|15 04|"; depth:2; offset:5; metadata:policy security-ips alert, service mysql; reference:url,dev.mysql.com/doc/refman/5.1/en/error-messages-server.html; classtype:misc-activity; sid:13357; rev:5;)
# alert tcp $SQL_SERVERS 3306 -> $EXTERNAL_NET any (msg:"MYSQL Oracle Mysql login attempt from unauthorized location"; flow:established,to_client; content:"j|04|"; depth:2; offset:5; metadata:policy security-ips alert, service mysql; reference:url,dev.mysql.com/doc/refman/5.1/en/error-messages-server.html; classtype:misc-activity; sid:13358; rev:5;)
