# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Nullsoft Winamp XM file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xm; file_data; content:"Extended Module|3A 20|"; nocase; byte_test:1,!=,26,20,relative; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2004-1896; reference:url,www.securityfocus.com/bid/10045; classtype:attempted-user; sid:2550; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER GNOME Project libxslt RC4 key string buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"xsl|3A|stylesheet"; fast_pattern; nocase; content:"crypto|3A|rc4_"; nocase; pcre:"/^(encrypt|decrypt)\x28\x27[^\x27]{129}/smiR"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,30467; reference:cve,2008-2935; classtype:attempted-user; sid:14039; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ClamAV CHM File Handling Integer Overflow attempt"; flow:to_client,established; flowbits:isset,file.chm; file_data; content:"|50 4D 47 4C 4A 0D 00 00 00 00 00 00 FF FF FF FF FF FF FF FF 01 2F 00 00 00 8F FF FF FF 7F 58 48 44 52|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:bugtraq,14359; reference:cve,2005-2450; classtype:attempted-user; sid:17352; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER OpenType Font file parsing denial of service attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"|4F 53 2F 32 55 97 5B 6C 00 00 01 20 00 00 00 60|"; content:"|68 65 61 64 EF 99 CF 00 FF 00 FF FF 00 FF 00 36|"; within:16; distance:16; content:"|68 6D 74 78 01 F4 00 00 00 00 05 A4 00 00 00 08|"; within:16; distance:16; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2741; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-078; classtype:denial-of-service; sid:17752; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Video Spirit visprj buffer overflow"; flow:established,to_client; flowbits:isset,file.visprj; file_data; content:"valitem"; nocase; pcre:"/<\s*valitem[^>]*\s(value|name)\s*=\s*([\x22\x27])[^\x22\x27]{104}/i"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-0499; classtype:attempted-user; sid:20889; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Autodesk 3D Studio Maxscript dangerous scripting method attempt"; flow:to_client,established; flowbits:isset,file.autodesk_max; file_data; content:"WriteString"; fast_pattern:only; content:"fopen"; nocase; pcre:"/^\s+(\w+)\s+\x22wb?\x22/R"; metadata:service http, service imap, service pop3; reference:bugtraq,36634; reference:cve,2009-3577; classtype:attempted-user; sid:20870; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Autodesk Maya dangerous scripting method attempt"; flow:to_client,established; flowbits:isset,file.autodesk_ma; file_data; content:"requires maya"; fast_pattern:only; content:"fopen"; nocase; content:"fwrite"; distance:0; nocase; pcre:"/(?P<q1>\x24\w+)\s*=\s*\x60\s*fopen[^\x60]*[\x22\x27]wb?.+?fwrite\s+(?P=q1)/i"; metadata:service http, service imap, service pop3; reference:bugtraq,36636; reference:cve,2009-3578; classtype:attempted-user; sid:20861; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER DAZ Studio dangerous scripting method attempt"; flow:to_client,established; flowbits:isset,file.daz_ds; file_data; content:"DzFile"; fast_pattern:only; pcre:"/var\s+(?P<q1>\w+)\s+=\s+new\s+DzFile.+?(?P=q1)\.open\(\s*2\s*\)/ms"; metadata:service http, service imap, service pop3; reference:bugtraq,37176; reference:cve,2009-4148; classtype:attempted-user; sid:20853; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ESTsoft ALZip MIM file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.mime; file_data; content:"Content-Type"; fast_pattern:only; content:"name"; nocase; content:"="; within:5; isdataat:300,relative; content:!"|3B|"; within:300; content:!"|0A|"; within:302; metadata:service http, service imap, service pop3; reference:cve,2011-1336; reference:url,osvdb.org/show/osvdb/73684; classtype:attempted-user; sid:20034; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director remote code execution attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"muhT|9B 00 00 00 00 04 00 00|FCRD|A8 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2874; classtype:attempted-user; sid:17193; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director remote code execution attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"EyeL|04 00 00 00 01 00 00 00 42 00 00 00 70 00 00 00 99 00 00 00 56 55 55 15|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2871; classtype:attempted-user; sid:17190; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|32 02 30 82 02 31 30 02 38 38 02 30 82 02 31 30 02 38 38 03 30 30 30 41 30 30 30 30 30 30 31 33 00 00 30 30 30 30 30 32 02 30 82 02 31 30 02 38|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2879; classtype:attempted-user; sid:17197; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director remote code execution attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|00 23 6F 98 00 00 00 00 00 00 00 62 00 00 00 01 00 0F FF FF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2873; classtype:attempted-user; sid:17192; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|01 36 01 00 00 00 80 80 00 00 00 15 00 00 00 03 00 00 00 27 00 00 00 24 00 00 00 02 00 00 00 06 00 00 00 00 00 00 00 00 00 00 00 06 00 01 00 00 00 0F E1 FD|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2877; classtype:attempted-user; sid:17196; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director remote code execution attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"39VMpami|18 00 00 00 01 41 41 41 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2872; classtype:attempted-user; sid:17191; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|6D 9E 54 65 78 74 00 00 00 00 00 00 00 00 00 00 00 00 0F 00 00 01 1A 3A 36 23 16 3A 37 0C 29 47 72 65 67 20 42 61 72 6E 65 74 74 00 80 80 00 04 74 65 78 74 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2878; classtype:attempted-user; sid:17198; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows MPEG Layer-3 audio heap corruption attempt"; flow:to_client,established; flowbits:isset,file.asx; file_data; content:"|FF FA 92 60 3C 6F|"; content:"|FF FA 92 C9 B9 56|"; within:6; distance:412; fast_pattern; content:"|A9 00 04 48 58 DC E1 83 4B 68 32 01 9B BC 04 A3 27 0E A5 3D 71 66 0D 2D A8 D3 84 AF 3C 14 88 94 3E 89 CA BF 80 9C|"; within:38; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-1882; reference:url,www.microsoft.com/technet/Bulletin/advisory/MS10-052.mspx; classtype:attempted-user; sid:18463; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file tSAC tag exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|FF FF 00 00|shockwave3d|00 00 01|P3DPR|00 00 01|P|00 00 00 06 00 00 00 01|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,42668; reference:cve,2010-2875; reference:url,www.adobe.com/support/security/bulletins/apsb10-20.html; classtype:attempted-user; sid:17194; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Flash arbitrary memory access attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"BB|00 00 03|PAA|00 00 03|P|00 05 00 00 03|h"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-3465; reference:url,www.adobe.com/support/security/bulletins/apsb09-16.html; classtype:attempted-user; sid:16225; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows C Run-Time Library remote code execution attempt"; flow:to_client,established; flowbits:isset,file.asx; file_data; content:"<ASX"; fast_pattern; nocase; content:"VERSION="; within:50; nocase; pcre:"/<ASX[^>]*?VERSION\s*=\s*[0-9\x22\x27][0-9\x2e]{20}/smi"; metadata:service http, service imap, service pop3; reference:cve,2012-0150; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-013; classtype:attempted-user; sid:21308; rev:3;)
# Copyright 2001-2012 Sourcefire Inc. All Rights Reserved.
#
# This file may contain proprietary rules that were created, tested and
# certified by Sourcefire, Inc. (the "VRT Certified Rules") as well as
# rules that were created by Sourcefire and other third parties and
# distributed under the GNU General Public License (the "GPL Rules").  The
# VRT Certified Rules contained in this file are the property of
# Sourcefire, Inc. Copyright 2012 Sourcefire, Inc. All Rights Reserved.
# The GPL Rules created by Sourcefire, Inc. are the property of
# Sourcefire, Inc. Copyright 2002-2012 Sourcefire, Inc. All Rights
# Reserved.  All other GPL Rules are owned and copyrighted by their
# respective owners (please see www.snort.org/contributors for a list of
# owners and their respective copyrights).  In order to determine what
# rules are VRT Certified Rules or GPL Rules, please refer to the VRT
# Certified Rules License Agreement.
#
#------------------
# FILE-OTHER RULES
#------------------

alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows download of .lnk file that executes cmd.exe detected"; flow:to_client,established; flowbits:isset,file.lnk; file_data; content:"WINDOWS|5C|system32|5C|cmd|2E|exe"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,15069; reference:cve,2005-2122; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-049; classtype:attempted-user; sid:17442; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java attempt to write in system32"; flow:to_client,established; flowbits:isset,file.class; file_data; content:"java/io/FileInputStream"; nocase; content:"|5C|system32|5C|"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; classtype:policy-violation; sid:21056; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Visual Studio .addin file access"; flow:to_client,established; flowbits:isset,file.addin; file_data; content:"<Assembly>"; fast_pattern; nocase; content:".dll"; distance:1; nocase; content:"</Assembly>"; distance:0; nocase; metadata:service http, service imap, service pop3; reference:cve,2012-0008; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-021; classtype:attempted-user; sid:21576; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Help Workshop CNT Help contents buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.cnt; content:"Content-Type: text/plain"; fast_pattern:only; file_data; pcre:"/[^\n]{513}/Rsi"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,22100; reference:cve,2007-0352; classtype:web-application-attack; sid:17365; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Visual Studio PKP file handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pkp; content:"|22|projectname|22| = |22|"; nocase; content:!"|22|"; within:200; metadata:service http, service imap, service pop3; reference:cve,2006-1043; reference:url,www.securityfocus.com/bid/16953; classtype:attempted-user; sid:22030; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Visual Studio DBP file handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.dbp; content:"dataproject = |22|"; nocase; content:!"|22|"; within:200; metadata:service http, service imap, service pop3; reference:cve,2006-1043; reference:url,www.securityfocus.com/bid/16953; classtype:attempted-user; sid:22029; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Visual Studio SLN file handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.sln; content:"Project"; nocase; pcre:"/^\x28\x22[^\x22]+\x22\x29\s*\x3d\s*\x22[^\x22]{200}/iR"; metadata:service http, service imap, service pop3; reference:cve,2006-1043; reference:url,www.securityfocus.com/bid/16953; classtype:attempted-user; sid:22031; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Visual Studio VAP file handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.vap; content:"|22|projectname|22| = |22|"; nocase; content:!"|22|"; within:200; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2006-1043; reference:url,www.securityfocus.com/bid/16953; classtype:attempted-user; sid:22032; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows True Type Font maxComponentPoints overflow attempt"; flow:established,to_client; flowbits:isset,file.ttf; file_data; content:"maxp"; depth:250; byte_jump:4,4,relative,from_beginning, post_offset 10,big; byte_test:2,>,0x8000,0,relative,big; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-0159; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-034; classtype:attempted-user; sid:22087; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Novell Groupwise Addressbook buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.nab; file_data; content:"TAGMAP"; fast_pattern:only; pcre:"/\x2c[^\x2c]{3500}/"; metadata:service http, service imap, service pop3; reference:cve,2011-4189; reference:url,novell.com/support/kb/doc.php?id=7010205; classtype:attempted-user; sid:22947; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Photoshop asset elements stack based buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.collada; content:"<COLLADA"; content:"<asset>"; distance:0; content:">"; distance:0; isdataat:2048,relative; content:!"</"; within:2048; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,53464; reference:url,osvdb.org/show/osvdb/81832; classtype:attempted-user; sid:23014; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER OpenType Font file integer overflow attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"OTTO"; depth:4; content:"name"; byte_test:4,>=,0x80000000,4,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2741; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-078; classtype:attempted-user; sid:23154; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER OpenType Font file integer overflow attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"OTTO"; depth:4; content:"head"; byte_test:4,>=,0x80000000,8,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2741; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-078; classtype:attempted-user; sid:23153; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER OpenType Font file integer overflow attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"OTTO"; depth:4; content:"name"; byte_test:4,>=,0x80000000,8,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2741; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-078; classtype:attempted-user; sid:23155; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER OpenType Font file integer overflow attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"OTTO"; depth:4; content:"head"; byte_test:4,>=,0x80000000,4,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2741; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-078; classtype:attempted-user; sid:23152; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ELF multiple antivirus evasion attempts"; flow:to_client,established; flowbits:isset,file.elf; file_data; content:"ustar"; depth:5; offset:257; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1429; classtype:attempted-user; sid:23318; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple Quicktime TeXML Style attribute overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"karaoke"; distance:0; content:"color|3A|"; pcre:"/^\s*[^\x7d]{62}/Rsmi"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-0663; classtype:attempted-user; sid:23465; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple Quicktime TeXML description attribute overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"description"; distance:0; content:"backgroundColor|3A|"; pcre:"/^\s*[^\x3e]{62}/Rsmi"; metadata:service http, service imap, service pop3; reference:cve,2012-0663; classtype:attempted-user; sid:23464; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER TAR multiple antivirus evasion attempt"; flow:to_client,established; flowbits:isset,file.tar; file_data; content:"|4A 46 49 46|"; depth:4; offset:6; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1428; classtype:attempted-user; sid:23358; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ACDSee FotoSlate PLP file buffer overflow attempt"; flow:established,to_client; flowbits:isset,file.plp; file_data; content:"<int"; fast_pattern:only; pcre:"/<int[^>]*?id\s*=\s*(\x22|\x27)[^\x22\x27]{50}/i"; metadata:service http, service imap, service pop3; reference:bugtraq,49558; reference:cve,2011-2595; classtype:attempted-user; sid:23479; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER TAR multiple antivirus evasion attempt"; flow:to_client,established; flowbits:isset,file.tar; file_data; content:"|19 04 00 10|"; depth:4; offset:8; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1424; classtype:attempted-user; sid:23326; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ACDSee FotoSlate PLP file buffer overflow attempt"; flow:established,to_client; flowbits:isset,file.plp; file_data; content:"<string"; fast_pattern:only; pcre:"/<string[^>]*?id\s*=\s*(\x22|\x27)[^\x22\x27]{50}/i"; metadata:service http, service imap, service pop3; reference:bugtraq,49558; reference:cve,2011-2595; classtype:attempted-user; sid:23478; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER TAR multiple antivirus evasion attempt"; flow:to_client,established; flowbits:isset,file.tar; file_data; content:"|50 4B 03 04|"; depth:4; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1425; classtype:attempted-user; sid:23325; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple Quicktime TeXML sampleData attribute overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"sampleData"; distance:0; content:"highlightColor|3A|"; pcre:"/^\s*[^\x3e]{62}/Rsmi"; metadata:service http, service imap, service pop3; reference:cve,2012-0663; classtype:attempted-user; sid:23463; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER TAR multiple antivirus evasion attempt"; flow:to_client,established; flowbits:isset,file.tar; file_data; content:"MZ"; depth:2; metadata:service http, service imap, service pop3; reference:cve,2012-1423; classtype:attempted-user; sid:23327; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER TAR multiple antivirus evasion attempt"; flow:to_client,established; flowbits:isset,file.tar; file_data; content:"[aliases]"; depth:9; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1419; classtype:attempted-user; sid:23351; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER TAR multiple antivirus evasion attempt"; flow:to_client,established; flowbits:isset,file.tar; file_data; content:"|7F|ELF"; depth:4; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1420; classtype:attempted-user; sid:23323; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple Quicktime JPEG2000 length integer underflow attempt"; flow:to_client,established; file_data; content:"|6A 50 20 20|"; depth:4; offset:4; byte_jump:4,-8,relative; content:"|66 74 79 70|"; within:4; byte_jump:4,-8,relative; content:"|6A 70 32 68|"; within:4; byte_jump:4,-8,relative; content:"|6A 70 32 63 FF 4F FF 51|"; distance:0; byte_jump:2,0,relative; content:"|FF 52|"; within:2; distance:-2; byte_test:2,<,12,0,relative; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-3250; classtype:attempted-user; sid:23400; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple Quicktime TeXML Style attribute overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"style"; distance:0; content:"color|3A|"; pcre:"/^\s*[^\x7d]{62}/Rsmi"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-0663; classtype:attempted-user; sid:23462; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER TAR multiple antivirus evasion attempt"; flow:to_client,established; flowbits:isset,file.tar; file_data; content:"ITSF"; depth:4; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1422; classtype:attempted-user; sid:23328; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER TAR multiple antivirus evasion attempt"; flow:to_client,established; flowbits:isset,file.tar; file_data; content:"|42 5A 68|"; depth:3; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1426; classtype:attempted-user; sid:23324; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle outside in Lotus 1-2-3 heap overflow attempt"; flow:to_client,established; flowbits:isset,file.wk4; file_data; content:"|1B 00|"; byte_test:2,>,1024,0,relative,little; metadata:service http, service imap, service pop3; reference:cve,2012-0110; reference:url,osvdb.org/76571; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20111026-webex; classtype:attempted-user; sid:23346; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple Quicktime TeXML Transform attribute overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"transform"; distance:0; pcre:"/^\s*\x3d\s*[\x27\x22](translate|matrix)[^\x27\x22]{62}/Rsmi"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-0663; classtype:attempted-user; sid:23461; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ELF multiple antivirus evasion attempts"; flow:to_client,established; flowbits:isset,file.elf; file_data; content:"|19 04 00 10|"; depth:4; offset:8; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1430; classtype:attempted-user; sid:23357; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER TAR multiple antivirus evasion attempt"; flow:to_client,established; flowbits:isset,file.tar; file_data; content:"MSCF"; depth:4; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1421; classtype:attempted-user; sid:23329; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple Quicktime TeXML sampleData attribute overflow attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"sampleData"; distance:0; content:"highlightColor|3A|"; pcre:"/^\s*[^\x3e]{62}/Rsmi"; metadata:service smtp; reference:cve,2012-0663; classtype:attempted-user; sid:23584; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows malformed ASF voice codec memory corruption attempt"; flow:to_server,established; file_data; content:"@|9E|i|F8|M[|CF 11 A8 FD 00 80|_|5C|D+"; isdataat:46,relative; pcre:"/^.{38}\x0a\x00..(?!(\x40\x1f|\x11\x2b|\x80\x3e|\x22\x56)\x00\x00)/R"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2009-0555; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-051; classtype:attempted-user; sid:23578; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER VLC mms hostname buffer overflow attempt"; flow:to_server,established; file_data; content:"mms|3A 2F 2F|"; nocase; isdataat:4018,relative; pcre:"/^[^\x22\x27]{4018}/R"; metadata:policy security-ips drop, service smtp; reference:cve,2012-1775; reference:url,osvdb.org/show/osvdb/80188; reference:url,www.videolan.org/security/sa1201.html; classtype:attempted-user; sid:23577; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Task Scheduler buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.job; file_data; content:"|00 14 73 0F|"; depth:4; offset:36; content:"|00 3A 00 5C|"; within:4; distance:33; byte_test:2,>,260,-7,relative,little; metadata:service http, service imap, service pop3; reference:bugtraq,10708; reference:cve,2004-0212; classtype:attempted-user; sid:23489; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft MHTML XSS attempt"; flow:to_server,established; flowbits:isset,file.mht; file_data; content:"MIME-Version"; fast_pattern:only; pcre:"/(\x3C\s*script|onload|onclick|onmouseover)/ims"; metadata:service smtp; reference:cve,2011-0096; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-026; classtype:attempted-user; sid:23562; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple Quicktime TeXML Style attribute overflow attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"style"; distance:0; content:"color|3A|"; pcre:"/^\s*[^\x7d]{62}/Rsmi"; metadata:policy security-ips drop, service smtp; reference:cve,2012-0663; classtype:attempted-user; sid:23583; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows MHTML XSS attempt"; flow:to_server,established; file_data; content:"mhtml|3A|"; fast_pattern:only; pcre:"/(location\x2ereplace\x28|window\x2elocation\x2ehref\s*?=|iframe\s*?src\s*?=|a\s*?href\s*?=)\s*?[\x22\x27]mhtml\x3a(http|file)\x3a\x2f\x2f/Rsmi"; metadata:service smtp; reference:cve,2011-0096; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-026; classtype:attempted-user; sid:23563; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple Quicktime TeXML Transform attribute overflow attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"transform"; distance:0; pcre:"/^\s*\x3d\s*[\x27\x22](translate|matrix)[^\x27\x22]{62}/Rsmi"; metadata:policy security-ips drop, service smtp; reference:cve,2012-0663; classtype:attempted-user; sid:23582; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Illustrator DSC comment overflow attempt"; flow:to_server,established; file_data; content:"%!PS-Adobe-"; nocase; content:"EPSF-"; within:10; pcre:"/%[^\x0d\x0a]{1000}/smiR"; metadata:policy security-ips drop, service smtp; reference:bugtraq,37192; reference:cve,2009-4195; classtype:attempted-user; sid:23564; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple Quicktime TeXML description attribute overflow attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"description"; distance:0; content:"backgroundColor|3A|"; pcre:"/^\s*[^\x3e]{62}/Rsmi"; metadata:service smtp; reference:cve,2012-0663; classtype:attempted-user; sid:23585; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows Embedded Open Type Font malformed name table overflow attempt"; flow:to_server,established; flowbits:isset,file.eot; file_data; content:"|00 01 00 01 00 00 00 01 FF FF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2009-0231; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-029; classtype:attempted-user; sid:23566; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Oracle Java Zip file directory record overflow attempt"; flow:to_server,established; flowbits:isset,file.zip; file_data; content:"PK|05 06|"; byte_test:2,=,0,6,relative,little; byte_test:4,=,46,8,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,52013; reference:cve,2012-0501; reference:url,osvdb.org/79228; classtype:attempted-user; sid:23560; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Novell Groupwise Addressbook buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.nab; file_data; content:"TAGMAP"; fast_pattern:only; pcre:"/\x2c[^\x2c]{3500}/"; metadata:service smtp; reference:cve,2011-4189; reference:url,novell.com/support/kb/doc.php?id=7010205; classtype:attempted-user; sid:23580; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Apple Quicktime TeXML Style attribute overflow attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"text3GTrack"; nocase; content:"karaoke"; distance:0; content:"color|3A|"; pcre:"/^\s*[^\x7d]{62}/Rsmi"; metadata:policy security-ips drop, service smtp; reference:cve,2012-0663; classtype:attempted-user; sid:23586; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Outside-In JPEG2000 QCD segment processing heap buffer overflow attempt"; flow:established,to_client; flowbits:isset,file.jp2; file_data; content:"|00 00 00 0C 6A 50 20 20|"; depth:8; content:"|6A 70 32 63|"; distance:0; content:"|FF 5C|"; distance:0; byte_test:2,>,840,0,relative; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,54500; reference:cve,2012-1769; classtype:attempted-admin; sid:23806; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java runtime RMIConnectionImpl deserialization execution attempt"; flow:established,to_client; flowbits:isset,file.jar; file_data; content:"|18 00 00 00|PayloadClassLoader.class"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-0094; reference:url,osvdb.org/63484; classtype:attempted-user; sid:21387; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Sophos Anti-Virus zip file handling DoS attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"PK|03 04|"; content:"|0C 00|"; within:2; distance:4; content:"-|00 00 00 F9 00 00 00 05 00 FF FF|"; within:12; distance:8; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,14270; reference:cve,2005-1530; classtype:attempted-dos; sid:15957; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java HsbParser.getSoundBank stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.class; file_data; content:"|01 00 2C 28|Ljava|2F|net|2F|URL|3B 29|Ljavax|2F|sound|2F|midi|2F|Soundbank"; content:"|01 00 0C|getSoundbank"; content:"file|3A 2F 2F|"; byte_test:2,>,312,-9,relative,big; content:"|01|"; within:1; distance:-10; pcre:"/^.{2}file|3A 2F 2F|[\x21-\x7E]{305}/R"; metadata:service http, service imap, service pop3; reference:bugtraq,36881; reference:cve,2009-3867; classtype:attempted-user; sid:17776; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER PeaZip command injection attempt"; flow:established,to_client; flowbits:isset,file.zip; content:"README.TXT"; nocase; pcre:"/^\s*\x22?\s+\x22\s*\x7C[^\x7C]+\x7C\s*\.txt/R"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-2261; reference:url,osvdb.org/54966; classtype:attempted-user; sid:21413; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RealNetworks RealPlayer compressed skin overflow attempt"; flow:established,to_client; flowbits:isset,file.zip; file_data; content:"PK|01 02|"; depth:4; byte_test:4,>,33412,24,relative,little; metadata:service http, service imap, service pop3; reference:bugtraq,11555; reference:cve,2004-1094; classtype:attempted-user; sid:21420; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple OSX ZIP archive shell script execution attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"__MACOSX/._"; pcre:"/^[A-Za-z0-9_-]+?\.(mov|jpg)\x55/Ri"; metadata:service http, service imap, service pop3; reference:bugtraq,16736; reference:cve,2006-0848; reference:url,docs.info.apple.com/article.html?artnum=303382 ; reference:url,osvdb.org/23510; classtype:attempted-user; sid:21557; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java JRE sandbox Atomic breach attempt"; flow:to_client,established; flowbits:isset,file.jar; file_data; content:"AtomicReferenceArray"; nocase; content:"getClassLoader"; distance:0; nocase; metadata:policy balanced-ips alert, policy security-ips alert, service http, service imap, service pop3; reference:bugtraq,52161; reference:cve,2012-0507; classtype:attempted-user; sid:21667; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ZIP file name overflow attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"PK|03 04|"; depth:4; byte_test:2,>,128,22,relative,little; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,41333; reference:cve,2004-1094; reference:cve,2010-3227; classtype:attempted-user; sid:21484; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java Zip file directory record overflow attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"PK|05 06|"; byte_test:2,=,0,6,relative,little; byte_test:4,=,46,8,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,52013; reference:cve,2012-0501; reference:url,osvdb.org/79228; classtype:attempted-user; sid:23243; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java field bytecode verifier cache code execution attempt"; flow:to_client,established; flowbits:isset,file.class; file_data; content:"|B1 00 02 00 06 00 20 00 23 00 48 00 04 00 3E 00 45 00 48 00 00 00 09 00 16 00 4A 00 01 00 0B 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1723; reference:url,schierlm.users.sourceforge.net/CVE-2012-1723.html; classtype:attempted-user; sid:23277; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cisco WebEx recording integer overflow attempt"; flow:to_client,established; flowbits:isset,file.wrf; file_data; content:"|14 00 00 00 00 00 00 00 00 02|"; fast_pattern; content:"|01|"; within:1; distance:36; byte_test:4,>=,0x15555555,0,relative,little; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1336; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20120404-webex; classtype:attempted-user; sid:23269; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java field bytecode verifier cache code execution attempt"; flow:to_client,established; flowbits:isset,file.class; file_data; content:"|00 25 B6 00 12 B8 00 2B A7 00 08 4C 2B B6 00 31 B1 00 01 00 00 00 30 00 33 00 36 00 02 00 0A 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1723; reference:url,schierlm.users.sourceforge.net/CVE-2012-1723.html; classtype:attempted-user; sid:23274; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java field bytecode verifier cache code execution attempt"; flow:to_client,established; flowbits:isset,file.class; file_data; content:"|07 02 36 0B 43 07 02 39 0B 43 07 02 3C 0B 43 07 02 3F 0B 43 07 02 42 0B 43 07 02 45 0B 43 07 02|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1723; reference:url,schierlm.users.sourceforge.net/CVE-2012-1723.html; classtype:attempted-user; sid:23276; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java field bytecode verifier cache code execution attempt"; flow:to_client,established; flowbits:isset,file.jar; flowbits:isset,file.zip; file_data; content:".classPK"; nocase; pcre:"/(sIda\/sId|urua\/uru)[abcd]\.classPK/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1723; reference:url,schierlm.users.sourceforge.net/CVE-2012-1723.html; classtype:attempted-user; sid:23273; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java field bytecode verifier cache code execution attempt"; flow:to_client,established; flowbits:isset,file.class; file_data; content:"|00 01 00 0B 00 00 00 3D 00 06 00 02 00 00 00 1C 04 3C 2A B2 00 12 B2 00 18 1B 04 64 B2 00 18 BE|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1723; reference:url,schierlm.users.sourceforge.net/CVE-2012-1723.html; classtype:attempted-user; sid:23275; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Agent Helper Malicious JAR download attempt"; flow:to_client,established; flowbits:isset,file.jar.agent_helper; file_data; content:"META-INF/MANIFEST.MF"; nocase; isdataat:128,relative; flowbits:unset,file.jar.agent_helper; content:!"META-INF/MICCORJA.SF"; nocase; content:!"META-INF/MICCORJA.RSA"; nocase; metadata:service http, service imap, service pop3; reference:cve,2011-1969; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-079; classtype:attempted-user; sid:20259; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Media MIDI file memory corruption attempt"; flow:to_client,established; file_data; content:"|4D 54 68 64|"; depth:4; content:"|4D 54 72 6B 00 00 01 74 00 C9 01 00 9F FF 7F 00 99 23 7F 78 89|"; distance:0; metadata:service http, service imap, service pop3; reference:bugtraq,51292; reference:cve,2012-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-004; classtype:attempted-user; sid:20900; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple QuickTime for Java toQTPointer function memory corruption attempt"; flow:to_client,established; flowbits:isset,file.class; file_data; content:"toQTPointer"; content:"quicktime/util/QTPointerRef"; distance:0; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,23608; reference:cve,2007-2175; classtype:attempted-user; sid:15238; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RealNetworks RealPlayer zipped skin file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"|50 4B 03 04 14 00 00 00 08 00 91 98 6E 33 EB 71 F9 B3 1D 00 00 00 00 01 00 00 0B 00 00 00 53 68 75 66 66 6C 65 2E 62 6D 70 73 F2 DD C1 E5 08 04|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,15382; reference:cve,2005-2630; classtype:attempted-user; sid:17461; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java Runtime Environment Type1 Font parsing integer overflow attempt"; flow:to_client,established; flowbits:isset,file.class; file_data; content:"|1F 8B 08 08 D4 73 61 49 00 03 65 2E 70 61 63 6B 00 ED CE 3B 4B 03 41 10 00 E0 D9 7B C7 3B 15 63 63 2D 16 8A 8F D3 68 17 11 22 E4 34 21 31 82 31|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,34240; reference:cve,2009-1099; classtype:attempted-user; sid:17624; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle JDK image parsing library ICC buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.class; file_data; content:"|BC 08 59 03 02 54 59 04 10 D8 54 59 05 02 54 59|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,24004; reference:cve,2007-2788; reference:url,scary.beasts.org/security/CESA-2006-004.html; classtype:attempted-user; sid:17727; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java runtime JPEGImageReader overflow attempt"; flow:to_client,established; flowbits:isset,file.class; file_data; content:"|73 65 74 53 6F 75 72 63 65 53 75 62 73 61 6D 70 6C 69 6E 67 01 00 07|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:bugtraq,36881; classtype:attempted-user; sid:20055; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java Applet Rhino script engine remote code execution attempt"; flow:to_client,established; flowbits:isset,file.jar; file_data; content:"metasploit/Payload.class"; fast_pattern:only; content:"Exploit.class"; content:"metasploit.dat"; metadata:service http, service imap, service pop3; reference:cve,2011-3544; reference:url,osvdb.org/76500; classtype:attempted-user; sid:20622; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java Applet Rhino script engine remote code execution attempt"; flow:to_client,established; file_data; flowbits:isset,file.jar; content:"AgentLauncher.class"; fast_pattern:only; content:"RhinoExploit.class"; nocase; content:"agent.exe"; nocase; metadata:service http, service imap, service pop3; reference:cve,2011-3544; reference:url,osvdb.org/76500; classtype:attempted-user; sid:20831; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Media MIDI file memory corruption attempt"; flow:to_client,established; flowbits:isset,file.mid; file_data; content:"|00 B9 07 64 00 B9 0A 40 00 B9 7B 00 00 B9 5B 28 00 B9 5D 00 85 50 99 23|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:bugtraq,51292; reference:cve,2012-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-004; classtype:attempted-user; sid:21167; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Media MIDI file memory corruption attempt"; flow:to_client,established; flowbits:isset,file.mid; file_data; content:"|7F 00 43 7F 82 68 43 00 04 3C 00 14 3C 7F 00 43 7C 82 6C 3C 00 00 43 00 14 43 7F 00 3C 7E 82 68|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:bugtraq,51292; reference:cve,2012-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-004; classtype:attempted-user; sid:21159; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java Rhino script engine remote code execution attempt"; flow:to_client,established; flowbits:isset,file.jar; file_data; content:"Exploit.class"; fast_pattern; content:"StreamConnector.class"; distance:0; metadata:service http, service imap, service pop3; reference:cve,2011-3544; reference:url,osvdb.org/76500; classtype:attempted-user; sid:23008; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java privileged protection domain exploitation attempt"; flow:to_client,established; flowbits:isset,file.class; file_data; content:"cve2012xxxx/Gondzz"; fast_pattern:only; content:"xiaomaol"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-4681; classtype:attempted-admin; sid:24022; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OTHER Oracle outside in Lotus 1-2-3 heap overflow attempt"; flow:to_server,established; flowbits:isset,file.wk4; file_data; content:"|1B 00|"; byte_test:2,>,1024,0,relative,little; metadata:service smtp; reference:cve,2012-0110; reference:url,osvdb.org/76571; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20111026-webex; classtype:attempted-user; sid:24029; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OTHER Microsoft Windows Media MIDI file memory corruption attempt"; flow:to_server,established; flowbits:isset,file.mid; file_data; content:"|00 B9 07 64 00 B9 0A 40 00 B9 7B 00 00 B9 5B 28 00 B9 5D 00 85 50 99 23|"; fast_pattern:only; metadata:service smtp; reference:cve,2012-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-004; classtype:attempted-user; sid:24003; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java privileged protection domain exploitation attempt"; flow:to_client,established; flowbits:isset,file.class; file_data; content:"cve2012xxxx/Gondvv"; content:"java/security/ProtectionDomain"; content:"java/security/ProtectionDomain"; content:"java/security/AccessControlContext"; content:"xiaomaol"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-4681; classtype:attempted-admin; sid:24024; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Media MIDI file memory corruption attempt"; flow:to_client,established; flowbits:isset,file.mid; file_data; content:"|9F 92 7F 00 9F B2 00 00 99 23 7F 78 89 23 7F 00 23 7F 78 23 7F 78 23 7F 78 23 7F 00 99 23 7F 78|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:bugtraq,51292; reference:cve,2012-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-004; classtype:attempted-user; sid:23999; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OTHER Oracle Java privileged protection domain exploitation attempt"; flow:to_server,established; flowbits:isset,file.class; file_data; content:"cve2012xxxx/Gondvv"; content:"java/security/AccessControlContext"; content:"xiaomaol"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4681; classtype:attempted-admin; sid:24025; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OTHER Microsoft Windows Media MIDI file memory corruption attempt"; flow:to_server,established; file_data; content:"|4D 54 68 64|"; depth:4; content:"|4D 54 72 6B 00 00 01 74 00 C9 01 00 9F FF 7F 00 99 23 7F 78 89|"; distance:0; metadata:service smtp; reference:bugtraq,51292; reference:cve,2012-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-004; classtype:attempted-user; sid:24002; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OTHER Oracle Java privileged protection domain exploitation attempt"; flow:to_server,established; file_data; content:"Expression"; pcre:"/Expression\x28\s*?GetClass\x28\x22sun.awt.SunToolkit\x22\x29\s*?,\s*?\x22getField\x22/smi"; metadata:policy security-ips drop, service smtp; reference:cve,2012-4681; classtype:attempted-admin; sid:24038; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OTHER Microsoft Windows Media MIDI file memory corruption attempt"; flow:to_server,established; flowbits:isset,file.mid; file_data; content:"|7F 00 43 7F 82 68 43 00 04 3C 00 14 3C 7F 00 43 7C 82 6C 3C 00 00 43 00 14 43 7F 00 3C 7E 82 68|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,51292; reference:cve,2012-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-004; classtype:attempted-user; sid:24001; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OTHER Oracle Java privileged protection domain exploitation attempt"; flow:to_server,established; flowbits:isset,file.class; file_data; content:"cve2012xxxx/Gondzz"; fast_pattern:only; content:"xiaomaol"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4681; classtype:attempted-admin; sid:24023; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OTHER Microsoft Windows Media MIDI file memory corruption attempt"; flow:to_server,established; flowbits:isset,file.mid; file_data; content:"|9F 92 7F 00 9F B2 00 00 99 23 7F 78 89 23 7F 00 23 7F 78 23 7F 78 23 7F 78 23 7F 00 99 23 7F 78|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,51292; reference:cve,2012-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-004; classtype:attempted-user; sid:24000; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OTHER Winamp skin file arbitrary code execution attempt"; flow:established,to_client; flowbits:isset,file.zip; flowbits:isset,file.winampskin; file_data; content:"PK|03 04|"; depth:4; content:".exe"; metadata:service smtp; reference:bugtraq,11053; reference:cve,2004-0820; classtype:attempted-user; sid:24052; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OTHER Oracle Java privileged protection domain exploitation attempt"; flow:to_server,established; file_data; content:"|D3 2D 69 D2 25 D3 76 9A A6 4D 9B A6 49 DA A4 CD D2 C9 D2 E9 B4 4D 9C 73 05 78 C3 6F DE E4 AF 9A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4681; classtype:attempted-admin; sid:24056; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Winamp skin file arbitrary code execution attempt"; flow:established,to_client; flowbits:isset,file.zip; flowbits:isset,file.winampskin; file_data; content:"PK|03 04|"; depth:4; content:".exe"; metadata:service http, service imap, service pop3; reference:bugtraq,11053; reference:cve,2004-0820; classtype:attempted-user; sid:24051; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java privileged protection domain exploitation attempt"; flow:to_client,established; file_data; content:"|D3 2D 69 D2 25 D3 76 9A A6 4D 9B A6 49 DA A4 CD D2 C9 D2 E9 B4 4D 9C 73 05 78 C3 6F DE E4 AF 9A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-4681; classtype:attempted-admin; sid:24055; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java privileged protection domain exploitation attempt"; flow:to_client,established; file_data; content:"|6B 78 9E B5 D6 F6 FF F1 FF FC 6F FF FB 97 2F 5F EC 5F FE EF 83 2F 42 C1 97 E3 6E 8B FF 67 FD F3|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-4681; classtype:attempted-admin; sid:24057; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OTHER Oracle Java privileged protection domain exploitation attempt"; flow:to_server,established; file_data; content:"|6B 78 9E B5 D6 F6 FF F1 FF FC 6F FF FB 97 2F 5F EC 5F FE EF 83 2F 42 C1 97 E3 6E 8B FF 67 FD F3|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4681; classtype:attempted-admin; sid:24058; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $FILE_DATA_PORTS (msg:"FILE-OTHER technote main.cgi file directory traversal attempt"; flow:to_server,established; content:"/technote/main.cgi"; fast_pattern; nocase; http_uri; content:"filename="; nocase; content:"../../"; metadata:service http; reference:bugtraq,2156; reference:cve,2001-0075; reference:nessus,10584; classtype:web-application-attack; sid:1051; rev:21;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER F-Secure AntiVirus library heap overflow attempt"; flow:to_client,established; flowbits:isset,file.arj; file_data; content:"|0A|`|EA|"; pcre:"/\x0a\x0d?\x0a\x60\xea(.{36}[^\x00]{256}|.+\x60\xea.{32}[^\x00]{256})/s"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,12515; reference:cve,2005-0350; classtype:attempted-user; sid:15583; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Flash memory corruption attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|FF FF FF FF 01 1F 02|H|00 00 00|6|00 00 FF FF 01 1F 1F EE|"; content:!"|FF FF FF FF|"; within:4; distance:-24; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-3463; classtype:attempted-user; sid:16293; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave DIR file PAMI chunk code execution attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"XFIR"; depth:4; content:"pami"; distance:0; byte_test:4,>,0x7FFFFFFF,4,relative,little; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-1292; reference:url,secunia.com/advisories/38751/; reference:url,www.adobe.com/support/security/bulletins/apsb10-12.html; classtype:attempted-user; sid:16673; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple OSX Finder DMG volume name memory corruption"; flow:to_client,established; flowbits:isset,file.dmg; file_data; content:"|00 00 00 00 4C 41 42 4C|"; byte_test:2,>,254,12,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2007-0197; classtype:attempted-user; sid:17363; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Director rcsL chunk memory corruption attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"rcsL"; isdataat:203,relative; content:"|FF F0 02 67|"; within:4; distance:203; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,42682; reference:cve,2010-2873; reference:url,www.adobe.com/support/security/bulletins/apsb10-20.html; classtype:attempted-user; sid:17803; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Director pamm chunk memory corruption attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"XFIR"; depth:4; content:"pamm"; distance:4; byte_test:2,>,0x14,6,relative,little; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-4084; reference:url,www.adobe.com/support/security/bulletins/apsb10-25.html; classtype:attempted-user; sid:18776; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Player Lnam chunk processing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"Lnam|00 00|"; content:!"|00 00|"; within:2; distance:20; content:"|FF|"; within:1; distance:22; isdataat:256; content:!"|00|"; within:256; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,44516; reference:cve,2010-3655; reference:url,www.adobe.com/support/security/bulletins/apsb10-25.html; classtype:attempted-user; sid:19011; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Player Lnam chunk processing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"manL"; content:"|00 00|"; within:2; distance:2; content:!"|00 00|"; within:2; distance:18; content:"|FF|"; within:1; distance:20; isdataat:256,relative; content:!"|00|"; within:256; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,44516; reference:cve,2010-3655; reference:url,www.adobe.com/support/security/bulletins/apsb10-25.html; classtype:attempted-user; sid:19012; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file tSAC record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"tSAC|B7 00 00 00 00 00 00 01 00 00 00 8F|"; content:"|00 16 00 00 00 00 00 00 00 00 00 00 00 45 00 00|"; within:16; distance:24; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17183; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file rcsL record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"rcsL|0E 05 00 00 00 00 00 00 00 00 00 00|"; content:"|01 17 00 C0 FF FF 00 00 00 C1 00 00 01 84 00 00|"; within:16; distance:84; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17186; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file tSAC record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"tSAC|B7 00 00 00 00 00 00 01 00 00 00 8F|"; content:"|00 00 00 00 00 16 00 00 00 00 00 00 00 3F 00 00|"; within:16; distance:20; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17182; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file rcsL record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|8F 41 01 45 C2 AE 00 FF 45 B0 41 24 43 46 1F 42|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17187; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file LsCM overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"LsCM"; byte_test:4,>,4211081214,0,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2864; classtype:attempted-user; sid:17200; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file rcsL record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"rcsL|0E 05 00 00 00 00 00 00 00 00 00 00 00 00 05 0E 00 00 05 0E 00 5C 00 40|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17185; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file file Shockwave 3D overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"tSAC"; byte_test:2,>,32767,36,relative; content:"Shockwave 3D"; fast_pattern; content:"shockwave3d"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2866; reference:url,www.adobe.com/support/security/bulletins/apsb10-20.html; classtype:attempted-user; sid:17202; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file rcsL record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"rcsL|0E 05 00 00 00 00 00 00 00 00 00 00 00 00 05 0E|"; content:"|0A 08 19 1E 1C 1E 1F 1E 44 00 43 01 57 6E A1 9C|"; within:16; distance:512; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17188; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file LsCM record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"LsCM|3A 00 00 00 00 00 00 0C 00 00 00 01 00 04 00 00 40 05 00 00|"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2864; classtype:attempted-user; sid:17181; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file tSAC record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"tSAC|B7 00 00 00 00 00 00 01 00 00 00 8F|"; content:"|00 00 00 00 00 00 00 00 00 06 00 00 00 45 00 00|"; within:16; distance:28; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17184; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file file rcsL overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"rcsL"; byte_test:1,>,127,76,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2867; classtype:attempted-user; sid:17203; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file pamm record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"pamm"; byte_test:4,>,4294967118,20,relative; content:!"|FF FF FF FF|"; within:4; distance:20; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17179; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file file mmap overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"mmap"; byte_test:4,>,32768,0,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2870; classtype:attempted-user; sid:17204; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file LsCM record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"LsCM|3A 00 00 00 00 00 00 0C 00 00 40 01|"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2864; classtype:attempted-user; sid:17180; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file rcsL record exploit attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"|52 02 4C 00 61 46 43 01 57 C9 41 01 06 52 43 4C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2868; reference:cve,2010-2869; classtype:attempted-user; sid:17189; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave director file malformed lcsr block memory corruption attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"p|00 00 00 01 00 00 00 A8 FF FB|m|10|http|3A|//www."; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-3466; reference:url,www.adobe.com/support/security/bulletins/apsb09-16.html; classtype:attempted-user; sid:16220; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave tSAC pointer overwrite attempt"; flow:to_client,established; flowbits:isset, file.dir; file_data; content:"tSAC<|04 00 00 00 04 00 00 04|2|0B 00 00 01 00 00 00 14 0C 0C 0C 0C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-3464; reference:url,www.adobe.com/support/security/bulletins/apsb09-16.html; classtype:attempted-user; sid:16223; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER BACnet OPC client csv file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.csv; file_data; content:"OPC_TAG_NAME,OBJECT_TYPE,INSTANCE,OBJECT_NAME"; fast_pattern:only; pcre:"/^\x5c[^\x5c\x2c]{600,}\x5Cscada,0,0,$/m"; metadata:service http, service imap, service pop3; reference:bugtraq,43289; reference:cve,2010-4740; classtype:attempted-user; sid:21317; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Director KEY chunk buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"RIFX"; depth:4; fast_pattern; nocase; content:"KEY|2A|"; distance:0; byte_test:4,<,5,0,relative,little; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,48300; reference:cve,2011-2111; classtype:attempted-user; sid:21371; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ELF file parsing in different antivirus evasion attempt"; flow:to_client,established; flowbits:isset,file.elf; file_data; content:"|19 04 00 10|"; depth:4; offset:8; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1430; reference:url,securityfocus.com/archive/1/522005; classtype:bad-unknown; sid:21630; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ELF file parsing in different antivirus evasion attempt"; flow:to_client,established; flowbits:isset,file.elf; file_data; content:"|4A 46 49 46|"; depth:4; offset:6; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-1431; reference:url,securityfocus.com/archive/1/522005; classtype:bad-unknown; sid:21629; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Director file file Shockwave 3D overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"tSAC"; byte_test:2,>,32767,40,relative; content:"Shockwave 3D"; fast_pattern; content:"shockwave3d"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2866; reference:url,www.adobe.com/support/security/bulletins/apsb10-20.html; classtype:attempted-user; sid:23371; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Apple QuickTime FLIC animation file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.fli; file_data; content:"|FA F1 02 00 00 00 00 00 00 00 00 00 0A 03 00 00 0B 00 01 00 FF|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,19976; reference:cve,2006-4384; classtype:attempted-user; sid:16041; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows HLP File Handling heap overflow attempt"; flow:to_client,established; file_data; content:"|3F 5F 03 00|"; depth:4; content:"TTLBTREE|00 2E 06 00 00 7C 62|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,23382; reference:cve,2007-1912; classtype:attempted-user; sid:17374; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Project Invalid Memory Pointer Code Execution attempt"; flow:to_client,established; file_data; content:"|00 0B 00 00 00 CC E5 1A 00 41 41 41 41 00 00 00 00 03 02 01 22|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,28607; reference:cve,2008-1088; classtype:attempted-user; sid:17382; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Avast! Antivirus Engine Remote LHA buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.lzh; file_data; content:"|19 4C 2D 6C 68 30 2D 53 0C 00 00 2C 00 00 00 28 94 28 35 20|"; depth:20; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,19903; reference:cve,2006-4626; classtype:attempted-admin; sid:17541; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows itss.dll CHM File Handling Heap Corruption attempt"; flow:to_client,established; file_data; content:"|74 03 9E 02 4A 02 9C 01 12 01 8B 00 3E 00 25 00 00 00 02 00|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,17926; reference:cve,2006-2297; classtype:attempted-admin; sid:17490; rev:8;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"FILE-OTHER Oracle Java Runtime Environment Pack200 Decompression Integer Overflow"; flow:to_client,established; content:"Content-Encoding: pack200-gz"; nocase; content:"|9A 10 3A C7 39 E2 E6 DE BE F7 71 BA 7C 22 5E D7|"; content:"|49 F4 EF C7 73 9F 9B 9C 8B 32 A7 88 58 FF 13 31|"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,34240; reference:cve,2009-1095; classtype:attempted-user; sid:17522; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Help File Heap Buffer Overflow attempt"; flow:to_client,established; file_data; content:"|80 80 00 00 C0 C0 C0 00 80 80 80 00 00 00 FF 00 00 FF 00 00 00 FF FF 00 FF 00 00 00 FF 00 FF 00 FF FF 00 00 FF FF FF 00 00 41 41 41 41 41 41 41|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,17325; reference:cve,2006-1591; classtype:attempted-user; sid:17489; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER ClamAV UPX FileHandling Heap overflow attempt"; flow:to_server,established; content:"|34 66 75 67 34 41 74 41 6E 4E 49 62 67 42 54 4D 30 68 56 47|"; content:"|67 68 44 41 6B 43 43 50 51 6F 47 53 35 51 76 6A 52 6F 4B 33|"; metadata:policy security-ips drop, service smtp; reference:bugtraq,19381; reference:cve,2006-4018; classtype:attempted-user; sid:17493; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Pagemaker Font Name Buffer Overflow attempt"; flow:to_client,established; flowbits:isset,file.pmd; file_data; content:"Courier|20|New|61 61 61 61 61 61 61 61 61|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,25989; reference:cve,2007-5169; classtype:attempted-user; sid:17553; rev:11;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java Runtime Environment JAR File Processing Stack Buffer Overflow"; flow:to_client,established; file_data; content:"|1D 79 05 13 28 88 55 51 C2 A4 84 29 05 12 0C 19|"; content:"|F1 2B C6 40 A1 3D C6 60 81 A8 5D 28 34 30 44 06|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,32608; reference:cve,2008-5354; classtype:attempted-user; sid:17563; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER IBM Lotus Notes Applix Graphics Parsing Buffer Overflow"; flow:to_server,established; content:"Content-Transfer-Encoding|3A 20|quoted-printable|0D 0A|"; nocase; content:"Content-Disposition|3A 20|attachment"; distance:0; nocase; content:"|2A|BEGIN GRAPHICS VERSION"; within:23; distance:25; nocase; pcre:"/VERSION\x3d3D\d{3}[^\r\n]*\r\n/i"; content:"ENCODING"; within:8; nocase; pcre:"/^\x3d3D7BIT[^\r\n]{20}/Ri"; metadata:policy security-ips drop, service smtp; reference:bugtraq,28454; reference:cve,2007-5405; classtype:attempted-admin; sid:17559; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Pagemaker Key Strings Stack Buffer Overflow attempt"; flow:to_client,established; flowbits:isset,file.pmd; file_data; content:"Magenta"; nocase; content:"|41 41 41 41 41|"; within:5; distance:241; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,31999; reference:cve,2007-6432; classtype:attempted-admin; sid:17650; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java Runtime Environment Type1 Font parsing integer overflow attempt"; flow:to_client,established; flowbits:isset,file.psfont; file_data; content:"|63 3B 84 6A B2 84 BC F8 B0 41 1B 77 2D E5 CE 32 34 0D C6 F2 8A F4 08 57 E4 45 19 76 E7 51 82 43 3C F9 F3 33 A3 8B D8 41 C0 D4 E6 8B F9 E0 12 EB|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,34240; reference:cve,2009-1099; classtype:attempted-user; sid:17623; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Pagemaker Font Name Buffer Overflow attempt"; flow:to_client,established; flowbits:isset,file.pmd; file_data; content:"|61 61 61 61 61 61 61 61 61 61 61 61 0F 42 01 05 41 41 41 41 41 41 41 41|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,25989; reference:cve,2007-5169; classtype:attempted-user; sid:17735; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Director rcsL chunk remote code execution attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"rcsL"; isdataat:484,relative; content:"|00 00 00 80 00 00 F0 41 41 41 41 41 41 AB 41 05 43 01 57 17|"; within:20; distance:484; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,44291; reference:cve,2010-3653; classtype:attempted-user; sid:17807; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave Director rcsL chunk remote code execution attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"rcsL"; isdataat:192,relative; content:"|01 02 4C 00 00 00 00 80 00 00 F0 FF F0 02 67 25 A2 01 33 41|"; within:20; distance:192; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,44291; reference:cve,2010-3653; classtype:attempted-user; sid:17806; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER rich text format unexpected field type memory corruption attempt"; flow:to_client,established; file_data; content:"|4B 47 2D D7 6B CF 87 5D CF DB F3 1E FE 9F 9F 5F F4 A3 30 49 BC A4 DB 9E B3 C3 7B ED B9 C5 28 6E|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-1901; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-056; classtype:attempted-user; sid:18953; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows uniscribe fonts parsing memory corruption attempt"; flow:to_client,established; flowbits:isset,file.ttf; file_data; content:"|AA FF FF FF FF 00 00 00 20 00 00 00 03 00 00 00 21 00 00 00 7E 00 00 00 04 00 00 00 A0 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-2738; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-063; classtype:attempted-user; sid:18952; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER rich text format unexpected field type memory corruption attempt"; flow:to_client,established; file_data; content:"|CB 5D 91 76 A2 A3 23 D7 EF 15 F9 A8 E3 7A DD A5 78 21 08 0E FE 17 FF 2F 2D AD 84 49 9C 65 41 B6|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-1901; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-056; classtype:attempted-user; sid:18954; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft OpenType font index remote code execution attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"|FB 01 FF FF 00 00 FF 2F|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:bugtraq,45311; reference:cve,2010-3956; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-091; classtype:attempted-user; sid:19064; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave 3D stucture heap overflow"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"initmainVWTL"; content:"XMED"; within:4; distance:4; content:"|80 FF FF FF 00|"; within:5; distance:36; content:"|0C 0C 0C 0C FF 00 00 00|"; within:8; distance:25; metadata:service http, service imap, service pop3; reference:cve,2009-4002; reference:url,www.adobe.com/support/security/bulletins/apsb10-03.html; classtype:attempted-user; sid:19112; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave 3D structure opcode 45 overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"initmainVWTL"; content:"XMED"; within:4; distance:4; content:"|45 FF FF FF 00 FF 00|"; within:7; distance:36; metadata:service http, service imap, service pop3; reference:cve,2009-4003; reference:url,www.adobe.com/support/security/bulletins/apsb10-03.html; classtype:attempted-user; sid:19114; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave 3D structure opcode 81 overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"initmainVWTL"; content:"XMED"; within:4; distance:4; content:"|81 FF FF FF 00 FF 00|"; within:7; distance:36; metadata:service http, service imap, service pop3; reference:cve,2009-4003; reference:url,www.adobe.com/support/security/bulletins/apsb10-03.html; classtype:attempted-user; sid:19113; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Shockwave 3D structure opcode 89 overflow attempt"; flow:to_client,established; flowbits:isset,file.dir; file_data; content:"initmainVWTL"; content:"XMED"; within:4; distance:4; content:"|89 FF FF FF 00 FF 00|"; within:7; distance:36; metadata:service http, service imap, service pop3; reference:cve,2009-4003; reference:url,www.adobe.com/support/security/bulletins/apsb10-03.html; classtype:attempted-user; sid:19115; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows MPEG Layer-3 audio heap corruption attempt"; flow:to_client,established; flowbits:isset,file.asx; file_data; content:"|FF FA 92 60 41 41 41 41|"; depth:8; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,42298; reference:cve,2010-1882; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-052; classtype:attempted-user; sid:19144; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows .NET Framework XAML browser applications stack corruption"; flow:to_client,established; flowbits:isset,file.manifest; file_data; content:"|2F 00 59 00 41 01 6B 00 61 00 41 01 6B 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,47223; reference:cve,2010-3958; classtype:attempted-user; sid:19170; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Fax Services Cover Page Editor Double Free Memory Corruption"; flow:to_client,established; flowbits:isset,file.cov; file_data; content:"|00 73 00 04 00 AD FE FF FF FE 01 00 00 2F FF FF|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:bugtraq,45942; reference:cve,2010-2701; classtype:attempted-admin; sid:19219; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cisco Webex Player .wrf stack buffer overflow"; flow:to_client,established; flowbits:isset,file.wrf; file_data; content:"|02 01 78 02 69 C1 F0 FC|"; offset:690; metadata:service http, service imap, service pop3; reference:bugtraq,46075; reference:cve,2010-3269; classtype:attempted-user; sid:19226; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Fax Services Cover Page Editor Double Free Memory Corruption"; flow:to_client,established; flowbits:isset,file.cov; file_data; content:"|00 00 42 00 55 00 47 00 0A 00 A7 FE FF FF DA 01|"; metadata:service http, service imap, service pop3; reference:bugtraq,45942; reference:cve,2010-2701; classtype:attempted-admin; sid:19220; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows embedded OpenType EOT font integer overflow attempt"; flow:to_client,established; flowbits:isset,file.eot; file_data; content:"|52 E7 0D 2C 32 3E 1D FC BE E2 B2 A1 E9 94 6A 46 57 35 B4 FD|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,43775; reference:cve,2010-1883; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-076; classtype:attempted-user; sid:19308; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Server 2003 update service principal name spn dos executable attempt"; flow:to_client,established; file_data; content:"|62 00 61 00 64 00 2E 00 44 00 4E 00 53 00 65 00 6E 00 74 00 72 00 79 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-0040; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-005; classtype:attempted-admin; sid:18406; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Data Access Components library attempt"; flow:to_client,established; file_data; content:"|33 C0 66 89 45 F4 6A FD 8D 85 BC FF FE FF 50 6A FD 8D 8D D8 FF FE FF 51 6A FD 8D 95 F4 FF FE FF 52 8B 85 A4 FF FE FF 50 E8 9B FB FF FF 33 C0 52 8B CD 50 8D 15 14 15 41 00 E8 9E FB FF FF 58 5A 5F 5E 5B 8B 4D FC 33 CD E8 12 FB|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-0026; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-002; classtype:attempted-user; sid:18276; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Media Player dvr-ms file parsing remote code execution attempt"; flow:to_client,established; file_data; content:"|00 00 00 00 A2 00 56 61 6C 69 02 00 00 00 90 00 42 42 42 42|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2011-0042; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-015; classtype:attempted-user; sid:18498; rev:9;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows OpenType Fonts CompactFontFormat FontMatrix tranform memory corruption attempt"; flow:to_client,established; file_data; content:"|04 FB 61 0C 03 F1 0C 04 8C 8B 8B 8C 8B 8B 0C 07 1C F7 E9 FD|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-0034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-032; classtype:attempted-admin; sid:18644; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows ATMFD Adobe font driver remote code execution attempt"; flow:to_client,established; file_data; content:"|64 A2 F7 60 A2 01 F7 A7 C8 03 14 E0 F7 E6 43 15 BE C9 A3 B0|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-0033; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-007; classtype:attempted-user; sid:18402; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"FILE-OTHER Microsoft Windows Server 2003 update service principal name spn dos attempt"; flow:to_server,established; content:"|62 00 61 00 64 00 2E 00 44 00 4E 00 53 00 65 00 6E 00 74 00 72 00 79 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ns; reference:cve,2011-0040; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-005; classtype:attempted-admin; sid:18407; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe malicious IFF memory corruption attempt"; flow:to_client,established; file_data; content:"|2F 33 44 41 37 3C 39 3B 34 2F 42 41 3A 2B 33 3A 2E 2C 30|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2011-0587; reference:url,www.adobe.com/support/security/bulletins/apsb11-03.html; classtype:attempted-admin; sid:18452; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows TrueType font parsing engine sfac_GetSbitBitmap elevation of privileges attempt"; flow:to_client,established; flowbits:isset,file.ttf; file_data; content:"|00 00 00 00 00 01 00 03 48 0A 01 01 00 00 00 80 01 FF 00 00 00 00 00 01 00 03 40 52 00 02 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-3402; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-087; classtype:attempted-user; sid:20735; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_client,established; file_data; content:"VFRPAAsAgAADADBDRkYgDBtVwQAADFQAAKzyR1BPU1UZ4R4AAMFQAAAsHEdT"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2011-1873; reference:url,www.microsoft.com/technet/security/bulletin/MS11-041.mspx; classtype:attempted-admin; sid:20771; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_server,established; file_data; content:"|4F 54 54 4F 00 0B 00 80 00 03 00 30 43 46 46 20 0C 1B 55 C1 00 00 0C 54 00 00 AC F2 47 50 4F 53 55 19 E1 1E 00 00 C1 50 00 00 2C 1C 47 53 55 42|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2011-1873; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-041; classtype:attempted-admin; sid:20776; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_client,established; file_data; content:"VE8ACwCAAAMAMENGRiAMG1XBAAAMVAAArPJHUE9TVRnhHgAAwVAAACwcR1NV"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2011-1873; reference:url,www.microsoft.com/technet/security/bulletin/MS11-041.mspx; classtype:attempted-admin; sid:20772; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_server,established; content:"VFRPAAsAgAADADBDRkYgDBtVwQAADFQAAKzyR1BPU1UZ4R4AAMFQAAAsHEdT"; fast_pattern:only; metadata:service smtp; reference:cve,2011-1873; reference:url,www.microsoft.com/technet/security/bulletin/MS11-041.mspx; classtype:attempted-admin; sid:20774; rev:4;)
# alert tcp $EXTERNAL_NET [139,445] -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_client,established; file_data; content:"|4F 54 54 4F 00 0B 00 80 00 03 00 30 43 46 46 20 0C 1B 55 C1 00 00 0C 54 00 00 AC F2 47 50 4F 53 55 19 E1 1E 00 00 C1 50 00 00 2C 1C 47 53 55 42|"; fast_pattern:only; metadata:service netbios-ssn; reference:cve,2011-1873; reference:url,www.microsoft.com/technet/security/bulletin/MS11-041.mspx; classtype:attempted-admin; sid:20768; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_client,established; file_data; content:"T1RUTwALAIAAAwAwQ0ZGIAwbVcEAAAxUAACs8kdQT1NVGeEeAADBUAAALBxHU1VC"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2011-1873; reference:url,www.microsoft.com/technet/security/bulletin/MS11-041.mspx; classtype:attempted-admin; sid:20770; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_server,established; content:"T1RUTwALAIAAAwAwQ0ZGIAwbVcEAAAxUAACs8kdQT1NVGeEeAADBUAAALBxHU1VC"; fast_pattern:only; metadata:service smtp; reference:cve,2011-1873; reference:url,www.microsoft.com/technet/security/bulletin/MS11-041.mspx; classtype:attempted-admin; sid:20773; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_server,established; file_data; content:"|00 01 00 00 0E B7 AD 87 5F 0F 3C F5 00 03 03 E8 00 00 00 00 C9 D2 5F 76 00 00 00 00 C9 D2 5F 76 00 00 00 00 00 00 00 00|"; fast_pattern:only; metadata:service smtp; reference:cve,2011-1873; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-041; classtype:attempted-user; sid:20769; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malicious font file remote code execution attempt"; flow:to_server,established; content:"VE8ACwCAAAMAMENGRiAMG1XBAAAMVAAArPJHUE9TVRnhHgAAwVAAACwcR1NV"; fast_pattern:only; metadata:service smtp; reference:cve,2011-1873; reference:url,www.microsoft.com/technet/security/bulletin/MS11-041.mspx; classtype:attempted-admin; sid:20775; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows OpenType font parsing stack overflow attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"|04 FB 61 0C 03 F1 0C 04 8C 8B 8B 8C 8B 8B 0C 07 1C F7 E9 FD|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-0034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-032; classtype:attempted-admin; sid:20902; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java getSoundBank overflow Attempt malicious jar file"; flow:to_client,established; file_data; content:"|50 4B 03 04 14 00 08 00 08 00 48 5A 8E 3B 00 00 00 00 00 00 00 00 00 00 00 00 09 00 04 00 4D 45 54 41 2D 49 4E 46 2F FE CA 00 00 03 00 50 4B 07 08 00 00 00 00 02 00 00 00 00 00 00 00 50 4B 03 04 14 00 08 00 08 00 48 5A 8E 3B 00 00 00 00 00 00 00 00 00 00 00 00 14 00 00 00 4D 45 54 41 2D 49 4E 46 2F|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,36881; reference:cve,2009-3867; classtype:attempted-user; sid:20858; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows OpenType font parsing stack overflow attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"|03 00 01 04 09 00 0E 00 36 05 0E 00 03 00 01 04 09 00 11 00 18 05 44 43 6F 70|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-0034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-032; classtype:attempted-admin; sid:20904; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows OpenType font parsing stack overflow attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"|1E 1A 00 04 88 28 1F 8B 8B 1E 1A 00 04 88 28 1F|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-0034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-032; classtype:attempted-admin; sid:20903; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Java Applet Rhino script engine remote code execution attempt"; flow:to_client,established; flowbits:isset,file.universalbinary; file_data; content:"this.toString = function|28|"; nocase; content:"java.lang.System.setSecurityManager|28|null|29|"; distance:0; nocase; content:"return String.fromCharCode|28|97"; distance:0; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-3544; reference:url,osvdb.org/76500; classtype:attempted-user; sid:21057; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cisco Webex selector and size2 subrecords corruption attempt"; flow:to_client,established; flowbits:isset,file.wrf; file_data; content:"|02 3C 00 3C 00 18 77 04 00 00 00 10 77 04 00 00 01 00 00 00 88 03 5B 00 18 00 00 40|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-3319; reference:url,osvdb.org/show/osvdb/76570; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-093; reference:url,www.securityfocus.com/bid/50373; classtype:attempted-user; sid:21116; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe shockwave director tSAC string termination memory corruption attempt"; flow:to_client,established; file_data; flowbits:isset,file.dir; content:"|00 00 00 01 00 00 12 47 00 00 00 00 F0 00 00 00|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2011-2118; classtype:attempted-user; sid:21316; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows chm file malware related exploit"; flow:to_client,established; flowbits:isset,file.chm; file_data; content:"|78 07 2F 6D 79 2E 68 74 6D 01 84 A0 00 81 5C 0C 2F 73 65 72 76 69 63 65 2E 65 78 65 01 00 84 A0|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:url,www.virustotal.com/file/508508b8105d7d9b5289813b385f9be233d76e09a2ad3c647e8dc5078db8eff1/analysis/; classtype:trojan-activity; sid:21489; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java JRE sandbox Atomic breach attempt"; flow:to_client,established; flowbits:isset,file.universalbinary; file_data; content:"|33 36 35 37 30 37 34 36 39 36 46 01 00 2C 36 45 30 31 30 30 30 36 36 31|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,52161; reference:cve,2012-0507; classtype:attempted-user; sid:21664; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java JRE sandbox Atomic breach attempt"; flow:to_client,established; flowbits:isset,file.universalbinary; file_data; content:"|35 37 32 37 32 36 35 36 45 37 34 32 45 36 31 37 34 36 46 36 44 36 39 36|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,52161; reference:cve,2012-0507; classtype:attempted-user; sid:21665; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java JRE sandbox Atomic breach attempt"; flow:to_client,established; flowbits:isset,file.universalbinary; file_data; content:"atomic"; content:"AtomicReferenceArray"; within:20; distance:1; metadata:policy balanced-ips alert, policy security-ips alert, service http, service imap, service pop3; reference:bugtraq,52161; reference:cve,2012-0507; classtype:attempted-user; sid:21666; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Java JRE sandbox breach attempt"; flow:to_client,established; flowbits:isset,file.universalbinary; file_data; content:"AtomicReferenceArray"; content:"localAtomicReferenceArray = (AtomicReferenceArray)arrayofObject"; distance:0; nocase; metadata:policy balanced-ips alert, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,52161; reference:cve,2012-0507; classtype:attempted-user; sid:21869; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java privileged protection domain exploitation attempt"; flow:to_client,established; flowbits:isset,file.class; file_data; content:"com/sun/beans/finder/MethodFinder"; fast_pattern:only; content:"sun.awt.SunToolkit|07 00 73 0C 00 74 00 75 01 00 08|getField"; content:"java/security/AccessControlContext"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-4681; classtype:attempted-admin; sid:24063; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OTHER Oracle Java privileged protection domain exploitation attempt"; flow:to_server,established; file_data; content:"|76 E3 66 C2 8B 9E E3 1F E1 1C 7B FC D4 AF F6 1C 4D 38 E2 F1 07 F8 53 FC 11 E2 9D 6D 08 04 A3 F5|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4681; classtype:attempted-admin; sid:24066; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Expat xml UTF-8 buffer over-read attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"<?xml version|C2 85|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:bugtraq,36097; reference:cve,2009-3720; classtype:denial-of-service; sid:24069; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java privileged protection domain exploitation attempt"; flow:to_client,established; file_data; content:"|76 E3 66 C2 8B 9E E3 1F E1 1C 7B FC D4 AF F6 1C 4D 38 E2 F1 07 F8 53 FC 11 E2 9D 6D 08 04 A3 F5|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-4681; classtype:attempted-admin; sid:24065; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OTHER Expat xml UTF-8 buffer over-read attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"<?xml version|C2 85|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,36097; reference:cve,2009-3720; classtype:denial-of-service; sid:24070; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OTHER Expat xml UTF-8 bufer over-read attempt"; flow:to_server,established; flowbits:isset,file.xml; file_data; content:"<?xml |D8 B6|"; fast_pattern:only; metadata:service smtp; reference:bugtraq,36097; reference:cve,2009-3720; classtype:denial-of-service; sid:24068; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OTHER Oracle Java privileged protection domain exploitation attempt"; flow:to_server,established; flowbits:isset,file.class; file_data; content:"com/sun/beans/finder/MethodFinder"; fast_pattern:only; content:"sun.awt.SunToolkit|07 00 73 0C 00 74 00 75 01 00 08|getField"; content:"java/security/AccessControlContext"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4681; classtype:attempted-admin; sid:24064; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Expat xml UTF-8 buffer over-read attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"<?xml |D8 B6|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:bugtraq,36097; reference:cve,2009-3720; classtype:denial-of-service; sid:24067; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OTHER ESTsoft ALZip MIM file buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.mime; file_data; content:"Content-Type"; fast_pattern:only; content:"name"; nocase; content:"="; within:5; isdataat:300,relative; content:!"|3B|"; within:300; content:!"|0A|"; within:302; metadata:service smtp; reference:cve,2011-1336; reference:url,osvdb.org/show/osvdb/73684; classtype:attempted-user; sid:24083; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ACD Systems ACDSee Products XPM values section buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xpm; file_data; content:"static"; content:"char"; within:50; pcre:"/^static\s+(\w+\s+)?char\s*\x2A\s*\w+\s*\x5B\x5D\s*\x3D\s*\x7B.*\x22[^\x22]{200}/smiH"; metadata:service http, service imap, service pop3; reference:bugtraq,26554; reference:cve,2007-6009; classtype:attempted-user; sid:16062; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft SQL Server Backup Database File integer overflow attempt"; flow:to_client,established; flowbits:isset,file.bak; file_data; content:"MQCI"; content:"SFIN"; within:4; distance:18; fast_pattern; byte_test:4,<,8,0,relative; metadata:service http, service imap, service pop3; reference:cve,2008-0107; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-040; classtype:attempted-admin; sid:13888; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft SQL Server Backup Database File integer overflow attempt"; flow:to_client,established; flowbits:isset,file.bak; file_data; content:"MQCI"; content:"SCIN"; within:4; distance:18; fast_pattern; byte_test:4,<,8,0,relative; metadata:service http, service imap, service pop3; reference:cve,2008-0107; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-040; classtype:attempted-admin; sid:13889; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft SQL Server Backup Database File integer overflow attempt"; flow:to_client,established; flowbits:isset,file.bak; file_data; content:"MQCI"; content:"SFGI"; within:4; distance:18; fast_pattern; byte_test:4,<,8,0,relative; metadata:service http, service imap, service pop3; reference:cve,2008-0107; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-040; classtype:attempted-admin; sid:13890; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows malformed shortcut file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.lnk; content:"L|00 00 00 01 14 02 00 00 00 00 00 C0 00 00 00 00 00 00|F"; byte_test:1,!&,4,0,relative,little; byte_jump:2,56,relative,little; byte_jump:2,0,relative,little; byte_jump:2,-2,relative,multiplier 2,little; byte_jump:2,0,relative,multiplier 2,little; byte_jump:2,0,relative,little; content:"|CC 00 00 00|"; within:4; distance:-2; isdataat:72,relative; content:!"|00 00|"; within:32; distance:40; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,15069; reference:bugtraq,15070; reference:cve,2005-2118; reference:cve,2005-2122; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-049; classtype:attempted-user; sid:4643; rev:13;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft HTML help workshop buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.hlp; file_data; content:"["; depth:1; content:"]"; within:12; content:"file"; distance:0; nocase; content:"="; distance:0; pcre:"/\x5B(OPTIONS|WINDOWS|MERGE FILES|MAP|ALIAS|TEXT\x20POPUPS|INFOTYPES|SUBSETS)\x5D.*?(Contents|Index|Compiled|Sample List|Full text search stop list)\x20file\s*\x3D[^\r\n]{200}/smi"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2006-0564; reference:cve,2009-0133; reference:url,users.pandora.be/bratax/advisories/b008.html; reference:url,www.frsirt.com/english/advisories/2006/0446; classtype:attempted-user; sid:5741; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Download Manger dm.ini stack overflow attempt"; flow:to_client,established; flowbits:isset,file.aom; file_data; content:"<?aom"; nocase; content:"<url>"; isdataat:271; content:!"</url>"; within:271; nocase; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,21453; reference:cve,2006-5856; classtype:attempted-user; sid:9637; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER libxml2 file processing long entity overflow attempt"; flow:to_client,established; flowbits:isset,file.xml; file_data; content:"<!ENTITY"; isdataat:200,relative; pcre:"/^\s+([^\x22\x20\x3E]{200}|[^\s]*\s+\x22[^\x22\x20\x3E]{200})/smR"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,31126; reference:cve,2008-3529; classtype:attempted-user; sid:15866; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Vista Feed Headlines Gagdet code execution attempt"; flow:to_client,established; flowbits:isset,file.rss; file_data; content:"&lt|3B|"; fast_pattern; nocase; content:"<title>"; nocase; pcre:"/\x3ctitle\x3e[^\x3c]*\x26lt\x3b[^\x3c]*(>|\x26gt\x3b)/i"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,25287; reference:cve,2007-3033; classtype:attempted-user; sid:15946; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Free Download Manager .torrent parsing path overflow attempt"; flow:to_client,established; flowbits:isset,file.torrent; file_data; content:"4|3A|pathl"; nocase; byte_test:6,>,10000,0,relative,dec,string; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,33555; reference:cve,2009-0184; classtype:attempted-user; sid:16520; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Free Download Manager .torrent parsing name overflow attempt"; flow:to_client,established; flowbits:isset,file.torrent; file_data; content:"4|3A|name"; nocase; byte_test:6,>,10000,0,relative,dec,string; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,33555; reference:cve,2009-0184; classtype:attempted-user; sid:16519; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Free Download Manager .torrent parsing comment overflow attempt"; flow:to_client,established; flowbits:isset,file.torrent; file_data; content:"7|3A|comment"; nocase; byte_test:6,>,100000,0,relative,dec,string; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,33555; reference:cve,2009-0184; classtype:attempted-user; sid:16517; rev:8;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Free Download Manager .torrent parsing announce overflow attempt"; flow:to_client,established; flowbits:isset,file.torrent; file_data; content:"8|3A|announce"; nocase; byte_test:6,>,100000,0,relative,dec,string; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,33555; reference:cve,2009-0184; classtype:attempted-user; sid:16518; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER UltraISO CUE file handling stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.cue; file_data; content:"FILE |22|"; depth:6; isdataat:512,relative; content:!"|22|"; within:512; metadata:policy security-ips drop, service http, service imap; reference:bugtraq,24140; reference:cve,2007-2888; classtype:attempted-user; sid:16734; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cain & Abel Remote Desktop Protocol file handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.rdp; file_data; pcre:"/^[a-z0-9]{500}/iR"; metadata:service http, service imap, service pop3; reference:bugtraq,32543; reference:cve,2008-5405; classtype:attempted-user; sid:16743; rev:7;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ACD Systems ACDSee Products XBM file handling buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xbm; file_data; content:"|23|define"; content:"|5F|width"; distance:0; pcre:"/\x23define\s*(?=[\S]{57})\S*\x5Fwidth/"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,37685; reference:url,osvdb.org/show/osvdb/63643; classtype:attempted-user; sid:17238; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Help Workshop HPJ OPTIONS section buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.hpj; file_data; content:"[OPTIONS]"; content:"HLP"; distance:0; nocase; pcre:"/^\s*HLP\s*\x3d\s*[^\n]{257}/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,22135; reference:cve,2007-0427; classtype:attempted-user; sid:17366; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER OpenOffice.org XPM file processing integer overflow attempt"; flow:to_client,established; flowbits:isset,file.xpm; file_data; content:"/* XPM */"; fast_pattern; content:"static char *"; distance:0; pcre:"/^[^\x22]+\x22(\d+\x20+){2}/R"; byte_test:10,>,419062,0,relative,string; byte_test:10,>,10244,1,relative,string; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,38218; reference:cve,2009-2949; classtype:attempted-user; sid:18537; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft SYmbolic LinK stack overflow attempt"; flow:to_client,established; flowbits:isset,file.slk; file_data; content:"P|3B|"; fast_pattern:only; pcre:"/(^P\x3B[^\x3B]*\x0D\x0A){200}/mi"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,48161; reference:cve,2011-1276; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-045; classtype:attempted-user; sid:19911; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft MHTML XSS attempt"; flow:to_client,established; flowbits:isset,file.mht; file_data; content:"MIME-Version"; fast_pattern:only; pcre:"/(\x3C\s*script|onload|onclick|onmouseover)/ims"; metadata:service http, service imap, service pop3; reference:cve,2011-0096; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-026; classtype:attempted-user; sid:20133; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows ATMFD font driver remote code execution attempt"; flow:to_client,established; flowbits:isset,file.otf; file_data; content:"|01 00 04 04 00 01 01 01 03 49 57 00 01 02 80 01 00 40 F8 0F|"; fast_pattern:only; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2010-3957; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-091; classtype:attempted-user; sid:18219; rev:10;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Embedded Open Type Font malformed name table integer overflow attempt"; flow:to_client,established; flowbits:isset,file.eot; file_data; content:"|00 01 00 00|"; content:"|00 04|"; within:2; distance:2; byte_test:2,>,35752,0,relative; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-0232; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-029; classtype:attempted-user; sid:15694; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Embedded Open Type Font malformed name table platform type 3 integer overflow attempt"; flow:to_client,established; flowbits:isset,file.eot; file_data; content:"|00 03 00|"; content:"|00 04|"; within:2; distance:3; byte_test:2,>,35752,0,relative; byte_test:1,<,2,-5,relative; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-0232; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-029; classtype:attempted-user; sid:15695; rev:12;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Embedded Open Type Font malformed name table overflow attempt"; flow:to_client,established; flowbits:isset,file.eot; file_data; content:"|00 01 00 01 00 00 00 01 FF FF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2009-0231; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-029; classtype:attempted-user; sid:15693; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft malformed saved search heap corruption attempt"; flow:to_client,established; flowbits:isset,file.search-ms; file_data; content:"type=|22|notCondition|22|"; fast_pattern:only; metadata:service http, service imap, service pop3; reference:cve,2008-1435; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-038; classtype:attempted-admin; sid:13893; rev:12;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Nullsoft Winamp AMF file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.amf; file_data; content:"AMF"; depth:3; byte_test:1,>,12,3; byte_test:1,>,32,40; metadata:service http, service imap, service pop3; reference:url,forums.winamp.com/showthread.php?t=332010; reference:url,www.osvdb.org/show/osvdb/76635; classtype:attempted-user; sid:20566; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Nullsoft Winamp AMF file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.amf; file_data; content:"AMF"; depth:3; byte_test:1,<,12,3; byte_test:1,>,16,40; metadata:service http, service imap, service pop3; reference:url,forums.winamp.com/showthread.php?t=332010; reference:url,www.osvdb.org/show/osvdb/76635; classtype:attempted-user; sid:20565; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cytel Studio USE command overflow attempt"; flow:to_client,established; flowbits:isset,file.cyb; file_data; content:"USE"; isdataat:512,relative; content:!")|3B|"; within:512; metadata:service http, service imap, service pop3; reference:bugtraq,49924; reference:url,aluigi.altervista.org/adv/cytel_1-adv.txt; reference:url,osvdb.org/75991; reference:url,www.exploit-db.com/exploits/18027/; classtype:attempted-user; sid:21021; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cytel Studio row overflow attempt"; flow:to_client,established; flowbits:isset,file.cy3; file_data; content:"90"; depth:2; content:"|0A|"; within:2; pcre:"/90\x0D?\x0A\w{8}/s"; metadata:service http, service imap, service pop3; reference:bugtraq,49924; reference:url,aluigi.altervista.org/adv/cytel_1-adv.txt; reference:url,osvdb.org/75991; reference:url,www.exploit-db.com/exploits/18027/; classtype:attempted-user; sid:21020; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cytel Studio string stack overflow attempt"; flow:to_client,established; flowbits:isset,file.cy3; file_data; content:"90"; depth:2; content:"|0A|"; within:2; isdataat:512,relative; pcre:"/\w{512}/Rs"; metadata:service http, service imap, service pop3; reference:bugtraq,49924; reference:url,aluigi.altervista.org/adv/cytel_1-adv.txt; reference:url,osvdb.org/75991; reference:url,www.exploit-db.com/exploits/18027/; classtype:attempted-user; sid:21019; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER VisiWave VWR file parsing code execution attempt"; flow:to_client,established; flowbits:isset,file.vwr; file_data; content:"Type|3A|"; nocase; isdataat:500,relative; pcre:"/^[^\r\n]{500}/R"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,47948; reference:cve,2011-2386; classtype:attempted-user; sid:21587; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows CUR file parsing overflow attempt"; flow:to_client,established; flowbits:isset,file.cur; file_data; content:"|00 00 02 00|"; depth:4; byte_test:4,>,0xfffffffc,10,relative,little; metadata:service http, service imap, service pop3; reference:bugtraq,12095; reference:cve,2004-1049; classtype:attempted-user; sid:23499; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Multiple vendor Antivirus magic byte detection evasion attempt"; flow:to_client,established; flowbits:isset,file.htm; content:"Content|2D|Type|3A 20|text|2F|html"; nocase; http_header; file_data; pcre:"/^(MZ|PK|BZh|BZ|GIF8|BM|IC|PI|CI|CP)/"; metadata:service http; reference:cve,2005-3370; reference:cve,2005-3371; reference:cve,2005-3372; reference:cve,2005-3373; reference:cve,2005-3374; reference:cve,2005-3375; reference:cve,2005-3376; reference:cve,2005-3377; reference:cve,2005-3378; reference:cve,2005-3379; reference:cve,2005-3380; reference:cve,2005-3381; reference:cve,2005-3382; classtype:attempted-user; sid:17276; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Multiple vendor Antivirus magic byte detection evasion attempt"; flow:to_client,established; flowbits:isset,file.eml; content:"Content|2D|Type|3A 20|message|2F|rfc822"; nocase; http_header; file_data; pcre:"/(MZ|PK|BZh|BZ|GIF8|BM|IC|PI|CI|CP)/R"; metadata:policy security-ips drop, service http; reference:cve,2005-3370; reference:cve,2005-3371; reference:cve,2005-3372; reference:cve,2005-3373; reference:cve,2005-3374; reference:cve,2005-3375; reference:cve,2005-3376; reference:cve,2005-3377; reference:cve,2005-3378; reference:cve,2005-3379; reference:cve,2005-3380; reference:cve,2005-3381; reference:cve,2005-3382; classtype:attempted-user; sid:17277; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Multiple vendor Antivirus magic byte detection evasion attempt"; flow:to_client,established; flowbits:isset,file.bat; content:"Content|2D|Type|3A 20|application|2F|bat"; nocase; http_header; file_data; pcre:"/(MZ|PK|BZh|BZ|GIF8|BM|IC|PI|CI|CP)/R"; metadata:policy security-ips drop, service http; reference:cve,2005-3370; reference:cve,2005-3371; reference:cve,2005-3372; reference:cve,2005-3373; reference:cve,2005-3374; reference:cve,2005-3375; reference:cve,2005-3376; reference:cve,2005-3377; reference:cve,2005-3378; reference:cve,2005-3379; reference:cve,2005-3380; reference:cve,2005-3381; reference:cve,2005-3382; classtype:attempted-user; sid:17278; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Font Library file buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.fon; file_data; content:"MZ"; depth:2; nocase; byte_test:4,>,50,120,little; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-2003; reference:url,secunia.com/advisories/46405/; reference:url,www.exploit-db.com/exploits/17978/; reference:url,www.kb.cert.org/vuls/id/619281; classtype:attempted-user; sid:20572; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Interactive Data eSignal stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.esignal; file_data; content:"|00 00 00|"; depth:3; offset:1; byte_test:1,<,12,0; byte_test:1,>,20,13; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-3494; reference:url,osvdb.org/show/osvdb/75456; classtype:attempted-user; sid:20842; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Interactive Data eSignal stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.esignal; file_data; content:"<StyleTemplate>"; fast_pattern; nocase; isdataat:1024,relative; content:!"</StyleTemplate>"; within:1024; nocase; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2011-3494; reference:url,osvdb.org/show/osvdb/75456; classtype:attempted-user; sid:20843; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cisco WebEx recording integer overflow attempt"; flow:to_client,established; flowbits:isset,file.wrf; file_data; content:"|14 00 00 00 02|"; fast_pattern; byte_test:2,>=,32768,21,relative,little; metadata:policy security-ips drop, service http, service imap, service pop3; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20111026-webex; classtype:attempted-user; sid:23101; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Cisco WebEx recording integer overflow attempt"; flow:to_client,established; flowbits:isset,file.wrf; file_data; content:"|14 00 00 00 02|"; fast_pattern; byte_test:2,>=,32768,19,relative,little; metadata:policy security-ips drop, service http, service imap, service pop3; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20111026-webex; classtype:attempted-user; sid:23100; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java privileged protection domain exploitation attempt"; flow:to_client,established; file_data; content:"|71 CE 4E 75 4D BD 4B 75 9C 44 B4 63 27 77 A7 84 92 2D DF 59 4E 73 E2 F4 DE AB D3 BB D3 BB F2 17|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-4681; classtype:attempted-admin; sid:24084; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OTHER Oracle Java privileged protection domain exploitation attempt"; flow:to_server,established; file_data; content:"|71 CE 4E 75 4D BD 4B 75 9C 44 B4 63 27 77 A7 84 92 2D DF 59 4E 73 E2 F4 DE AB D3 BB D3 BB F2 17|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2012-4681; classtype:attempted-admin; sid:24085; rev:1;)
