# alert tcp $HOME_NET any -> $EXTERNAL_NET 25 (msg:"WEB-PHP truncated crypt function attempt"; flow:to_server,established; file_data; content:"crypt("; fast_pattern:only; content:"<?"; pcre:"/((?P<m1>\$\w+)\s*=\s*(?P<q1>[\x22\x27])\s*[^(?P=q1)]+(\\x80|\x80).*?crypt\(\s*(?P=m1)|crypt\(\s*(?P<q2>[\x22\x27])\s*[^(?P=q1)]+(\\x80|\x80))/smi"; metadata:policy security-ips drop, service smtp; reference:cve,2012-2143; classtype:attempted-admin; sid:23894; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 25 (msg:"WEB-PHP 5.3.3 mt_rand integer overflow attempt"; flow:to_server,established; file_data; content:"mt_getrandmax("; fast_pattern:only; content:"<?"; pcre:"/(define\(\s*(?P<q1>[\x22\x27])\s*(?P<m1>\w+)(?P=q1)\s*,\s*mt_getrandmax\(\)\s*\+\d+\s*\)\x3b.*?mt_rand\(\s*0\s*,\s*(?P=m1)\s*\)|(?P<m2>\$\w+)\s*=\s*mt_getrandmax\(\)\s*\+\s*\d+\s*\x3b.*?mt_rand\(\s*0\s*,\s*(?P=m2)\s*\)|mt_rand\(\s*0\s*,\s*mt_getrandmax\(\)\s*\+\s*\d+\s*\)\x3b)/smi"; metadata:service smtp; reference:cve,2011-0755; classtype:misc-activity; sid:24059; rev:2;)
# Copyright 2001-2012 Sourcefire Inc. All Rights Reserved.
#
# This file may contain proprietary rules that were created, tested and
# certified by Sourcefire, Inc. (the "VRT Certified Rules") as well as
# rules that were created by Sourcefire and other third parties and
# distributed under the GNU General Public License (the "GPL Rules").  The
# VRT Certified Rules contained in this file are the property of
# Sourcefire, Inc. Copyright 2012 Sourcefire, Inc. All Rights Reserved.
# The GPL Rules created by Sourcefire, Inc. are the property of
# Sourcefire, Inc. Copyright 2002-2012 Sourcefire, Inc. All Rights
# Reserved.  All other GPL Rules are owned and copyrighted by their
# respective owners (please see www.snort.org/contributors for a list of
# owners and their respective copyrights).  In order to determine what
# rules are VRT Certified Rules or GPL Rules, please refer to the VRT
# Certified Rules License Agreement.
#
#---------------
# WEB-PHP RULES
#---------------

# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP content-disposition memchr overflow"; flow:to_server,established; content:"Content-Disposition|3A|"; nocase; http_header; content:"name=|22 CC CC CC CC CC|"; fast_pattern:only; metadata:service http; reference:bugtraq,4183; reference:cve,2002-0081; reference:nessus,10867; classtype:web-application-attack; sid:1423; rev:22;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP content-disposition file upload attempt"; flow:to_server,established; content:"Content-Disposition|3A|"; nocase; http_header; content:"form-data|3B|"; fast_pattern:only; metadata:service http; reference:bugtraq,4183; reference:cve,2002-0081; reference:nessus,10867; classtype:web-application-attack; sid:1425; rev:20;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP squirrel mail theme arbitrary command attempt"; flow:to_server,established; content:"/left_main.php"; nocase; http_uri; content:"cmdd="; fast_pattern:only; metadata:service http; reference:bugtraq,4385; reference:cve,2002-0516; classtype:web-application-attack; sid:1737; rev:12;)

# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP DNSTools administrator authentication bypass attempt"; flow:to_server,established; content:"/dnstools.php"; nocase; http_uri; content:"user_logged_in=true"; nocase; content:"user_dnstools_administrator=true"; fast_pattern:only; metadata:service http; reference:bugtraq,4617; reference:cve,2002-0613; classtype:web-application-attack; sid:1739; rev:12;)


# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP directory.php arbitrary command attempt"; flow:to_server,established; content:"/directory.php"; http_uri; content:"dir="; content:"|3B|"; metadata:service http; reference:bugtraq,4278; reference:cve,2002-0434; reference:nessus,11017; classtype:misc-attack; sid:1815; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP directory.php access"; flow:to_server,established; content:"/directory.php"; http_uri; metadata:service http; reference:bugtraq,4278; reference:cve,2002-0434; classtype:misc-attack; sid:1816; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP phpbb quick-reply.php access"; flow:to_server,established; content:"/quick-reply.php"; http_uri; metadata:service http; reference:bugtraq,6173; classtype:web-application-activity; sid:1968; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP read_body.php access attempt"; flow:to_server,established; content:"/read_body.php"; http_uri; metadata:service http; reference:bugtraq,6302; reference:cve,2002-1341; reference:nessus,11415; classtype:web-application-activity; sid:1997; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP calendar.php access"; flow:to_server,established; content:"/calendar.php"; http_uri; metadata:service http; reference:bugtraq,5820; reference:bugtraq,9353; reference:nessus,11179; classtype:web-application-activity; sid:1998; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP edit_image.php access"; flow:to_server,established; content:"/edit_image.php"; http_uri; metadata:service http; reference:bugtraq,3288; reference:cve,2001-1020; reference:nessus,11104; classtype:web-application-activity; sid:1999; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP readmsg.php access"; flow:to_server,established; content:"/readmsg.php"; http_uri; metadata:service http; reference:cve,2001-1408; reference:nessus,11073; classtype:web-application-activity; sid:2000; rev:9;)

# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP remote include path"; flow:to_server,established; content:".php"; nocase; http_uri; content:"path="; fast_pattern:only; pcre:"/path=(https?|ftps?|php)/i"; metadata:service http; classtype:web-application-attack; sid:2002; rev:14;)

# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP piranha passwd.php3 access"; flow:to_server,established; content:"/passwd.php3"; http_uri; metadata:service http; reference:bugtraq,1149; reference:cve,2000-0322; classtype:attempted-recon; sid:1161; rev:15;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP smssend.php access"; flow:to_server,established; content:"/smssend.php"; http_uri; metadata:service http; reference:bugtraq,3982; reference:cve,2002-0220; classtype:web-application-activity; sid:1407; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Phorum /support/common.php attempt"; flow:to_server,established; content:"/support/common.php"; http_uri; content:"ForumLang=../"; metadata:service http; reference:bugtraq,1997; classtype:web-application-attack; sid:1490; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Phorum /support/common.php access"; flow:to_server,established; content:"/support/common.php"; http_uri; metadata:service http; reference:bugtraq,1997; reference:bugtraq,9361; classtype:web-application-attack; sid:1491; rev:14;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Phorum authentication access"; flow:to_server,established; content:"PHP_AUTH_USER=boogieman"; fast_pattern:only; metadata:service http; reference:bugtraq,2274; classtype:attempted-recon; sid:1137; rev:15;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP strings overflow"; flow:to_server,established; content:"|BA|I|FE FF FF F7 D2 B9 BF FF FF FF F7 D1|"; metadata:service http; reference:bugtraq,802; classtype:web-application-attack; sid:1085; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP PHPLIB remote command attempt"; flow:to_server,established; content:"_PHPLIB[libdir]"; fast_pattern:only; metadata:service http; reference:bugtraq,3079; reference:cve,2001-1370; reference:nessus,14910; classtype:attempted-user; sid:1254; rev:14;)
# alert tcp $HTTP_SERVERS any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-PHP PHPLIB remote command attempt"; flow:to_server,established; content:"/db_mysql.inc"; http_uri; metadata:service http; reference:bugtraq,3079; reference:cve,2001-1370; classtype:attempted-user; sid:1255; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Mambo uploadimage.php upload php file attempt"; flow:to_server,established; content:"/uploadimage.php"; http_uri; content:"userfile_name="; content:".php"; distance:1; metadata:service http; reference:bugtraq,6572; reference:cve,2003-1204; reference:nessus,16315; classtype:web-application-attack; sid:2074; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Mambo upload.php upload php file attempt"; flow:to_server,established; content:"/upload.php"; http_uri; content:"userfile_name="; content:".php"; distance:1; metadata:service http; reference:bugtraq,6572; reference:cve,2003-1204; reference:nessus,16315; classtype:web-application-attack; sid:2075; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Mambo uploadimage.php access"; flow:to_server,established; content:"/uploadimage.php"; http_uri; metadata:service http; reference:bugtraq,6572; reference:cve,2003-1204; reference:nessus,16315; classtype:web-application-activity; sid:2076; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Mambo upload.php access"; flow:to_server,established; content:"/upload.php"; http_uri; metadata:service http; reference:bugtraq,6572; reference:cve,2003-1204; reference:nessus,16315; classtype:web-application-activity; sid:2077; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP phpBB privmsg.php access"; flow:to_server,established; content:"/privmsg.php"; http_uri; metadata:service http; reference:bugtraq,6634; classtype:web-application-activity; sid:2078; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP p-news.php access"; flow:to_server,established; content:"/p-news.php"; http_uri; metadata:service http; reference:nessus,11669; classtype:web-application-activity; sid:2140; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP shoutbox.php directory traversal attempt"; flow:to_server,established; content:"/shoutbox.php"; http_uri; content:"conf="; content:"../"; distance:0; metadata:service http; reference:nessus,11668; classtype:web-application-attack; sid:2141; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP TextPortal admin.php default password admin attempt"; flow:to_server,established; content:"/admin.php"; http_uri; content:"op=admin_enter"; content:"password=admin"; fast_pattern:only; metadata:service http; reference:bugtraq,7673; reference:nessus,11660; classtype:web-application-activity; sid:2145; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP TextPortal admin.php default password 12345 attempt"; flow:to_server,established; content:"/admin.php"; http_uri; content:"op=admin_enter"; content:"password=12345"; fast_pattern:only; metadata:service http; reference:bugtraq,7673; reference:nessus,11660; classtype:web-application-activity; sid:2146; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP BLNews objects.inc.php4 remote file include attempt"; flow:to_server,established; content:"/objects.inc.php4"; http_uri; content:"Server[path]="; pcre:"/Server\x5bpath\x5d=(https?|ftps?|php)/"; metadata:service http; reference:bugtraq,7677; reference:cve,2003-0394; reference:nessus,11647; classtype:web-application-attack; sid:2147; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP BLNews objects.inc.php4 access"; flow:to_server,established; content:"/objects.inc.php4"; http_uri; metadata:service http; reference:bugtraq,7677; reference:cve,2003-0394; reference:nessus,11647; classtype:web-application-activity; sid:2148; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP ttCMS header.php access"; flow:to_server,established; content:"/admin/templates/header.php"; http_uri; metadata:service http; reference:bugtraq,7542; reference:bugtraq,7543; reference:bugtraq,7625; reference:nessus,11636; classtype:web-application-activity; sid:2151; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP autohtml.php access"; flow:to_server,established; content:"/autohtml.php"; http_uri; metadata:service http; reference:nessus,11630; classtype:web-application-activity; sid:2154; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP ttforum remote file include attempt"; flow:to_server,established; content:"forum/index.php"; http_uri; content:"template="; pcre:"/template=(https?|ftps?|php)/i"; metadata:service http; reference:bugtraq,7542; reference:bugtraq,7543; reference:nessus,11615; classtype:web-application-attack; sid:2155; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP forum_details.php access"; flow:to_server,established; content:"forum_details.php"; http_uri; metadata:service http; reference:bugtraq,7933; reference:nessus,11760; classtype:web-application-attack; sid:2227; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP gallery remote file include attempt"; flow:to_server,established; content:"/setup/"; http_uri; content:"GALLERY_BASEDIR="; http_uri; pcre:"/GALLERY_BASEDIR=(https?|ftps?|php)/Ui"; metadata:service http; reference:bugtraq,8814; reference:nessus,11876; classtype:web-application-attack; sid:2306; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP PayPal Storefront remote file include attempt"; flow:to_server,established; content:"do=ext"; http_uri; content:"page="; http_uri; pcre:"/page=(https?|ftps?|php)/Ui"; metadata:service http; reference:bugtraq,8791; reference:nessus,11873; classtype:web-application-attack; sid:2307; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP IdeaBox cord.php file include"; flow:to_server,established; content:"/index.php"; nocase; http_uri; content:"ideaDir="; fast_pattern:only; content:"cord.php"; nocase; metadata:service http; reference:bugtraq,7488; classtype:web-application-activity; sid:2353; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP IdeaBox notification.php file include"; flow:to_server,established; content:"/index.php"; nocase; http_uri; content:"gorumDir="; fast_pattern:only; content:"notification.php"; nocase; metadata:service http; reference:bugtraq,7488; classtype:web-application-activity; sid:2354; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP WebChat db_mysql.php file include"; flow:to_server,established; content:"/defines.php"; nocase; http_uri; content:"WEBCHATPATH="; nocase; content:"db_mysql.php"; fast_pattern:only; metadata:service http; reference:bugtraq,7000; classtype:web-application-attack; sid:2356; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP WebChat english.php file include"; flow:to_server,established; content:"/defines.php"; nocase; http_uri; content:"WEBCHATPATH="; nocase; content:"english.php"; fast_pattern:only; metadata:service http; reference:bugtraq,7000; classtype:web-application-attack; sid:2357; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Invision Board ipchat.php file include"; flow:to_server,established; content:"/ipchat.php"; nocase; http_uri; content:"root_path="; content:"conf_global.php"; fast_pattern:only; metadata:service http; reference:bugtraq,6976; classtype:web-application-attack; sid:2359; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP myphpPagetool pt_config.inc file include"; flow:to_server,established; content:"/doc/admin"; nocase; http_uri; content:"ptinclude="; nocase; content:"pt_config.inc"; fast_pattern:only; metadata:service http; reference:bugtraq,6744; classtype:web-application-attack; sid:2360; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP PhpGedView PGV authentication_index.php base directory manipulation attempt"; flow:to_server,established; content:"/authentication_index.php"; nocase; http_uri; content:"PGV_BASE_DIRECTORY"; fast_pattern:only; metadata:service http; reference:bugtraq,9368; reference:cve,2004-0030; classtype:web-application-attack; sid:2366; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP PhpGedView PGV functions.php base directory manipulation attempt"; flow:to_server,established; content:"/functions.php"; nocase; http_uri; content:"PGV_BASE_DIRECTORY"; fast_pattern:only; metadata:service http; reference:bugtraq,9368; reference:cve,2004-0030; classtype:web-application-attack; sid:2367; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP PhpGedView PGV config_gedcom.php base directory manipulation attempt"; flow:to_server,established; content:"/config_gedcom.php"; nocase; http_uri; content:"PGV_BASE_DIRECTORY"; fast_pattern:only; metadata:service http; reference:bugtraq,9368; reference:cve,2004-0030; classtype:web-application-attack; sid:2368; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP PhpGedView PGV base directory manipulation"; flow:to_server,established; content:"_conf.php"; nocase; http_uri; content:"PGV_BASE_DIRECTORY"; fast_pattern:only; metadata:service http; reference:bugtraq,9368; classtype:web-application-attack; sid:2926; rev:7;)


# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP WAnewsletter newsletter.php file include attempt"; flow:to_server,established; content:"newsletter.php"; nocase; http_uri; content:"waroot"; fast_pattern:only; content:"start.php"; nocase; metadata:service http; reference:bugtraq,6965; classtype:web-application-attack; sid:2398; rev:7;)





# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP PHPBB viewforum.php access"; flow:to_server,established; content:"/viewforum.php"; nocase; http_uri; content:"topic_id="; nocase; http_uri; metadata:service http; reference:bugtraq,9865; reference:bugtraq,9866; reference:nessus,12093; classtype:web-application-activity; sid:2566; rev:10;)

# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Opt-X header.php remote file include attempt"; flow:to_server,established; content:"/header.php"; nocase; http_uri; content:"systempath="; fast_pattern:only; pcre:"/systempath=(https?|ftps?|php)/i"; metadata:service http; reference:bugtraq,9732; classtype:web-application-attack; sid:2575; rev:8;)

# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP TUTOS path disclosure attempt"; flow:to_server,established; content:"/note_overview.php"; http_uri; content:"id="; metadata:service http; reference:bugtraq,10129; reference:url,www.securiteam.com/unixfocus/5FP0J15CKE.html; classtype:web-application-activity; sid:2588; rev:8;)

# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP PHPNuke Forum viewtopic SQL insertion attempt"; flow:to_server,established; content:"/modules.php"; nocase; http_uri; content:"name=Forums"; content:"file=viewtopic"; fast_pattern:only; pcre:"/forum=.*'/"; metadata:service http; reference:bugtraq,7193; classtype:web-application-attack; sid:2654; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP horde help module arbitrary command execution attempt"; flow:to_server,established; content:"/services/help/"; http_uri; pcre:"/[\?\x20\x3b\x26]module=[a-zA-Z0-9]*[\x3b\x26]/Ui"; metadata:policy security-ips drop, service http; reference:bugtraq,17292; reference:cve,2006-1491; classtype:web-application-attack; sid:6403; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Wordpress cache_lastpostdate code injection attempt"; flow:to_server,established; content:"wp_filter"; pcre:"/cache_lastpostdate\[[^\]]+\]=[^\x00\x3B\x3D]{30}/smi"; metadata:service http; reference:bugtraq,14533; reference:cve,2005-2612; classtype:attempted-admin; sid:8708; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP cacti graph_image SQL injection attempt"; flow:to_server,established; content:"graph_image.php"; nocase; http_uri; pcre:"/rra_id=(?!(\d+|all|)([\x26\s]|$))/smi"; metadata:service http; reference:bugtraq,14128; reference:bugtraq,14129; reference:cve,2005-2148; classtype:web-application-attack; sid:8713; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP cacti graph_image SQL injection attempt"; flow:to_server,established; content:"graph.php"; nocase; http_uri; pcre:"/local_graph_id=(?!(\d+|)([\x26\s]|$))/smi"; metadata:service http; reference:bugtraq,14128; reference:bugtraq,14129; reference:cve,2005-2148; classtype:web-application-attack; sid:8716; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP cacti graph_image arbitrary command execution attempt"; flow:to_server,established; content:"graph_image.php"; nocase; http_uri; pcre:"/graph_(start|end|height|width)=(?!(\d+|)[\x26\s])/smi"; metadata:service http; reference:bugtraq,14042; reference:bugtraq,14129; reference:cve,2005-1524; classtype:web-application-attack; sid:8712; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP cacti graph_image SQL injection attempt"; flow:to_server,established; content:"graph.php"; nocase; http_uri; pcre:"/rra_id=(?!(\d+|all|)([\x26\s]|$))/smi"; metadata:service http; reference:bugtraq,14128; reference:bugtraq,14129; reference:cve,2005-2148; classtype:web-application-attack; sid:8715; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP cacti graph_image SQL injection attempt"; flow:to_server,established; content:"graph_image.php"; nocase; http_uri; pcre:"/local_graph_id=(?!(\d+|)([\x26\s]|$))/smi"; metadata:service http; reference:bugtraq,14128; reference:bugtraq,14129; reference:cve,2005-2148; classtype:web-application-attack; sid:8714; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Pajax arbitrary command execution attempt"; flow:to_server,established; content:"method"; nocase; pcre:"/\x22method\x22\s*\x3a\s*\x22[A-Z]\w*[^\x22]/smi"; metadata:service http; reference:bugtraq,17519; reference:cve,2006-1551; reference:cve,2006-1789; classtype:web-application-attack; sid:8734; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP phpbb quick-reply.php arbitrary command attempt"; flow:to_server,established; content:"/quick-reply.php"; http_uri; content:"phpbb_root_path="; metadata:service http; reference:bugtraq,6173; classtype:web-application-attack; sid:1967; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 80 (msg:"WEB-PHP vbulletin php code injection"; flow:to_server,established; content:"misc.php"; http_uri; pcre:"/template\s*=\s*\x7b\x24/sUmi"; metadata:service http; reference:cve,2005-0511; reference:url,marc.info/?l=bugtraq&m=110910899415763&w=2; classtype:attempted-user; sid:11668; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP file upload GLOBAL variable overwrite attempt"; flow:to_server,established; content:"Content-Type|3A| multipart/form-data"; nocase; http_header; content:"name="; nocase; content:"GLOBALS"; within:7; distance:1; metadata:service http; reference:bugtraq,15250; reference:cve,2005-3390; classtype:web-application-attack; sid:12221; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP PHP function CRLF injection attempt"; flow:to_server,established; content:".php"; http_uri; content:"|0A|"; http_uri; metadata:service http; reference:bugtraq,52630; reference:bugtraq,5681; reference:cve,2002-1783; classtype:web-application-attack; sid:12360; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP phpBB viewtopic double URL encoding attempt"; flow:to_server,established; content:"viewtopic.php"; http_uri; content:"highlight="; http_uri; content:"%25"; metadata:service http; reference:cve,2004-1315; classtype:web-application-attack; sid:12610; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Joomla invalid token administrative password reset attempt"; flow:to_server,established; content:"task=confirmreset"; nocase; http_uri; content:"option=com_user"; http_uri; content:"token=%27&"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,30667; reference:cve,2008-3681; reference:url,developer.joomla.org/security/news/241-20080801-core-password-remind-functionality.html; classtype:attempted-admin; sid:14610; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Advanced Poll poll_ssi.php access"; flow:to_server,established; content:"/poll_ssi.php"; nocase; http_uri; metadata:service http; reference:bugtraq,8890; reference:nessus,11487; classtype:web-application-activity; sid:2302; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP ttCMS header.php remote file include attempt"; flow:to_server,established; content:"/admin/templates/header.php"; fast_pattern; nocase; http_uri; content:"admin_root="; pcre:"/admin_root=(https?|ftps?|php)/"; metadata:service http; reference:bugtraq,7542; reference:bugtraq,7543; reference:bugtraq,7625; reference:nessus,11636; classtype:web-application-attack; sid:2150; rev:16;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Phorum violation access"; flow:to_server,established; content:"/violation.php3"; nocase; http_uri; metadata:service http; reference:bugtraq,2272; classtype:attempted-recon; sid:1179; rev:17;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP admin.php access"; flow:to_server,established; content:"/admin.php"; nocase; http_uri; metadata:service http; reference:bugtraq,3361; reference:bugtraq,7532; reference:bugtraq,9270; reference:cve,2001-1032; classtype:attempted-recon; sid:1301; rev:20;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Advanced Poll admin_embed.php access"; flow:to_server,established; content:"/admin_embed.php"; nocase; http_uri; metadata:service http; reference:bugtraq,8890; reference:nessus,11487; classtype:web-application-activity; sid:2289; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 80 (msg:"WEB-PHP sphpblog upload_img_cgi access attempt"; flow:to_server,established; content:"sphpblog"; http_uri; content:"upload_img_cgi.php"; fast_pattern; nocase; http_uri; metadata:service http; reference:bugtraq,14667; reference:cve,2005-2733; classtype:attempted-user; sid:11666; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP MatrikzGB privilege escalation attempt"; flow:to_server,established; content:"new_rights=admin"; nocase; http_uri; metadata:service http; reference:bugtraq,8430; classtype:web-application-activity; sid:2331; rev:14;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP /_admin access"; flow:to_server,established; content:"/_admin/"; nocase; http_uri; metadata:service http; reference:bugtraq,9537; reference:nessus,12032; classtype:web-application-activity; sid:2393; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP DNSTools authentication bypass attempt"; flow:to_server,established; content:"/dnstools.php"; fast_pattern; nocase; http_uri; content:"user_logged_in=true"; metadata:service http; reference:bugtraq,4617; reference:cve,2002-0613; classtype:web-application-attack; sid:1740; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Title.php access"; flow:to_server,established; content:"/Title.php"; nocase; http_uri; metadata:service http; reference:bugtraq,9057; classtype:web-application-activity; sid:2280; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Advanced Poll admin_logout.php access"; flow:to_server,established; content:"/admin_logout.php"; nocase; http_uri; metadata:service http; reference:bugtraq,8890; reference:nessus,11487; classtype:web-application-activity; sid:2292; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Advanced Poll admin_help.php access"; flow:to_server,established; content:"/admin_help.php"; nocase; http_uri; metadata:service http; reference:bugtraq,8890; reference:nessus,11487; classtype:web-application-activity; sid:2290; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP authentication_index.php access"; flow:to_server,established; content:"/authentication_index.php"; nocase; http_uri; metadata:service http; reference:cve,2004-0032; reference:nessus,11982; classtype:web-application-activity; sid:2328; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP files.inc.php access"; flow:to_server,established; content:"/files.inc.php"; nocase; http_uri; metadata:service http; reference:bugtraq,8910; classtype:web-application-activity; sid:2304; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP DCP-Portal remote file include editor script attempt"; flow:to_server,established; content:"/library/editor/editor.php"; fast_pattern; nocase; http_uri; content:"root="; http_uri; metadata:service http; reference:bugtraq,6525; classtype:web-application-attack; sid:2341; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP xmlrpc.php post attempt"; flow:to_server,established; content:"/xmlrpc.php"; nocase; http_uri; pcre:"/^POST\s/smi"; metadata:service http; reference:bugtraq,14088; reference:cve,2005-1921; classtype:web-application-attack; sid:3827; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP wordpress cat parameter arbitrary file execution attempt"; flow:to_server,established; content:"/wordpress/"; fast_pattern; nocase; http_uri; content:"cat="; nocase; content:"../"; distance:0; pcre:"/\x2Fwordpress\x2F\x3F[^\r\n]*cat\s*=\s*[^\r\n\x26]*\x2F\x2E\x2E/smi"; metadata:policy security-ips drop, service http; reference:bugtraq,28845; reference:cve,2008-4769; classtype:web-application-attack; sid:15432; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP myPHPNuke chatheader.php access"; flow:to_server,established; content:"/chatheader.php"; nocase; http_uri; metadata:service http; reference:bugtraq,6544; classtype:web-application-activity; sid:2346; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP news.php file include"; flow:to_server,established; content:"/news.php"; fast_pattern; nocase; http_uri; content:"template="; nocase; metadata:service http; reference:bugtraq,6674; classtype:web-application-attack; sid:2361; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP PHP-Nuke remote file include attempt"; flow:to_server,established; content:"/index.php"; fast_pattern; nocase; http_uri; content:"file="; pcre:"/file=(https?|ftps?|php)/i"; metadata:service http; reference:bugtraq,3889; reference:cve,2002-0206; classtype:web-application-attack; sid:1399; rev:20;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP WAnewsletter db_type.php access"; flow:to_server,established; content:"/sql/db_type.php"; nocase; http_uri; metadata:service http; reference:bugtraq,6964; classtype:web-application-activity; sid:2399; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP rolis guestbook access"; flow:to_server,established; content:"/insert.inc.php"; nocase; http_uri; metadata:service http; reference:bugtraq,9057; classtype:web-application-activity; sid:2285; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Blahz-DNS dostuff.php access"; flow:to_server,established; content:"/dostuff.php"; nocase; http_uri; metadata:service http; reference:bugtraq,4618; reference:cve,2002-0599; classtype:web-application-activity; sid:1743; rev:14;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Advanced Poll admin_comment.php access"; flow:to_server,established; content:"/admin_comment.php"; nocase; http_uri; metadata:service http; reference:bugtraq,8890; reference:nessus,11487; classtype:web-application-activity; sid:2287; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Advanced Poll admin_stats.php access"; flow:to_server,established; content:"/admin_stats.php"; nocase; http_uri; metadata:service http; reference:bugtraq,8890; reference:nessus,11487; classtype:web-application-activity; sid:2296; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Cyboards default_header.php access"; flow:to_server,established; content:"/default_header.php"; nocase; http_uri; metadata:service http; reference:bugtraq,6597; classtype:web-application-activity; sid:2363; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP PhpGedView search.php access"; flow:to_server,established; content:"/search.php"; nocase; http_uri; content:"action=soundex"; fast_pattern; nocase; http_uri; content:"firstname="; nocase; http_uri; metadata:service http; reference:bugtraq,9369; reference:cve,2004-0032; classtype:web-application-activity; sid:2345; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP DNSTools access"; flow:to_server,established; content:"/dnstools.php"; nocase; http_uri; metadata:service http; reference:bugtraq,4617; reference:cve,2002-0613; classtype:web-application-activity; sid:1741; rev:14;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP DatabaseFunctions.php access"; flow:to_server,established; content:"/DatabaseFunctions.php"; nocase; http_uri; metadata:service http; reference:bugtraq,9057; classtype:web-application-activity; sid:2283; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 80 (msg:"WEB-PHP sphpblog install03_cgi access attempt"; flow:to_server,established; content:"sphpblog"; http_uri; content:"install03_cgi.php"; fast_pattern; nocase; http_uri; metadata:service http; reference:bugtraq,14667; reference:cve,2005-2733; classtype:attempted-user; sid:11665; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP squirrel mail spell-check arbitrary command attempt"; flow:to_server,established; content:"/squirrelspell/modules/check_me.mod.php"; fast_pattern; nocase; http_uri; content:"SQSPELL_APP["; nocase; metadata:service http; reference:bugtraq,3952; classtype:web-application-attack; sid:1736; rev:14;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Advanced Poll admin_tpl_new.php access"; flow:to_server,established; content:"/admin_tpl_new.php"; nocase; http_uri; metadata:service http; reference:bugtraq,8890; reference:nessus,11487; classtype:web-application-activity; sid:2300; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP phpMyAdmin db_details_importdocsql.php access"; flow:to_server,established; content:"db_details_importdocsql.php"; nocase; http_uri; metadata:service http; reference:bugtraq,7962; reference:bugtraq,7965; reference:nessus,11761; classtype:web-application-attack; sid:2228; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP phpBB mod shoutbox sql injection attempt"; flow:to_server,established; content:"shoutbox_view.php"; fast_pattern; nocase; http_uri; content:"mode="; nocase; http_uri; content:"id="; nocase; http_uri; pcre:"/shoutbox_view\.php\x3F[^\r\n]*mode\s*=\s*(delete|edit)[^\r\n]*id\s*=\s*[^\r\n\x26]*[^\d]+/Usmi"; metadata:policy security-ips alert, service http; reference:bugtraq,32123; reference:cve,2008-6301; classtype:web-application-attack; sid:15424; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP newsPHP Language file include attempt"; flow:to_server,established; content:"/nphpd.php"; fast_pattern; nocase; http_uri; content:"LangFile"; nocase; metadata:service http; reference:bugtraq,8488; classtype:web-application-activity; sid:2365; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP b2 cafelog gm-2-b2.php remote file include attempt"; flow:to_server,established; content:"/gm-2-b2.php"; fast_pattern; nocase; http_uri; content:"b2inc="; pcre:"/b2inc=(https?|ftps?|php)/i"; metadata:service http; reference:nessus,11667; classtype:web-application-attack; sid:2143; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Advanced Poll admin_preview.php access"; flow:to_server,established; content:"/admin_preview.php"; nocase; http_uri; metadata:service http; reference:bugtraq,8890; reference:nessus,11487; classtype:web-application-activity; sid:2294; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Phorum read access"; flow:to_server,established; content:"/read.php3"; nocase; http_uri; metadata:service http; classtype:attempted-recon; sid:1178; rev:16;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 80 (msg:"WEB-PHP sphpblog arbitrary file delete attempt"; flow:to_server,established; content:"sphpblog"; http_uri; content:"comment_delete_cgi.php"; fast_pattern; nocase; http_uri; pcre:"/comment=[^\x26\s]*[\x2f\x5c]/sUmi"; metadata:service http; reference:bugtraq,14667; reference:cve,2005-2733; classtype:attempted-user; sid:11667; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Setup.php access"; flow:to_server,established; content:"/Setup.php"; nocase; http_uri; metadata:service http; reference:bugtraq,9057; reference:cve,2009-1151; classtype:web-application-activity; sid:2281; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Advanced Poll admin_settings.php access"; flow:to_server,established; content:"/admin_settings.php"; nocase; http_uri; metadata:service http; reference:bugtraq,8890; reference:nessus,11487; classtype:web-application-activity; sid:2295; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP UpdateClasses.php access"; flow:to_server,established; content:"/UpdateClasses.php"; nocase; http_uri; metadata:service http; reference:bugtraq,9057; classtype:web-application-activity; sid:2279; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP php.exe access"; flow:to_server,established; content:"/php.exe"; nocase; http_uri; metadata:service http; reference:url,www.securitytracker.com/alerts/2002/Jan/1003104.html; classtype:web-application-activity; sid:1773; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Advanced Poll popup.php access"; flow:to_server,established; content:"/popup.php"; fast_pattern; nocase; http_uri; content:"include_path="; nocase; http_uri; metadata:service http; reference:bugtraq,8890; reference:nessus,11487; classtype:web-application-activity; sid:2303; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP file upload directory traversal"; flow:to_server,established; content:"POST"; http_method; content:"upload.php"; fast_pattern; nocase; http_uri; pcre:"/^Content-Type\x3A\s+multipart\/form-data/smiH"; content:"Content-Disposition|3A|"; nocase; http_header; pcre:"/filename=\S*\x2e\x2e\x2f/smiH"; content:"|0A|"; distance:0; metadata:service http; reference:url,bugs.php.net/bug.php?id=28456; classtype:misc-attack; sid:5709; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Advanced Poll admin_password.php access"; flow:to_server,established; content:"/admin_password.php"; nocase; http_uri; metadata:service http; reference:bugtraq,8890; reference:nessus,11487; classtype:web-application-activity; sid:2293; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Advanced Poll admin_edit.php access"; flow:to_server,established; content:"/admin_edit.php"; nocase; http_uri; metadata:service http; reference:bugtraq,8890; reference:nessus,11487; classtype:web-application-activity; sid:2288; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP IGeneric Free Shopping Cart page.php access"; flow:to_server,established; content:"/page.php"; nocase; http_uri; metadata:service http; reference:bugtraq,9773; classtype:web-application-activity; sid:2410; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP myPHPNuke partner.php access"; flow:to_server,established; content:"/partner.php"; nocase; http_uri; metadata:service http; reference:bugtraq,6544; classtype:web-application-activity; sid:2347; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP admin.php file upload attempt"; flow:to_server,established; content:"/admin.php"; fast_pattern; nocase; http_uri; content:"file_name="; metadata:service http; reference:bugtraq,3361; reference:cve,2001-1032; classtype:attempted-admin; sid:1300; rev:15;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Turba status.php access"; flow:to_server,established; content:"/turba/status.php"; nocase; http_uri; metadata:service http; reference:nessus,11646; classtype:web-application-activity; sid:2149; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP bb_smilies.php access"; flow:to_server,established; content:"/bb_smilies.php"; nocase; http_uri; metadata:service http; reference:url,www.securiteam.com/securitynews/Serious_security_hole_in_PHP-Nuke__bb_smilies_.html; classtype:web-application-activity; sid:1774; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP pmachine remote file include attempt"; flow:to_server,established; content:"lib.inc.php"; fast_pattern; nocase; http_uri; content:"pm_path="; pcre:"/pm_path=(https?|ftps?|php)/"; metadata:service http; reference:bugtraq,7919; reference:nessus,11739; classtype:web-application-attack; sid:2226; rev:16;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP test.php access"; flow:to_server,established; content:"/test.php"; nocase; http_uri; metadata:service http; reference:nessus,11617; classtype:web-application-activity; sid:2152; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP phptest.php access"; flow:to_server,established; content:"/phptest.php"; nocase; http_uri; metadata:service http; reference:bugtraq,9737; classtype:web-application-activity; sid:2405; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Advanced Poll admin_license.php access"; flow:to_server,established; content:"/admin_license.php"; nocase; http_uri; metadata:service http; reference:bugtraq,8890; reference:nessus,11487; classtype:web-application-activity; sid:2291; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP chatbox.php access"; flow:to_server,established; content:"/chatbox.php"; nocase; http_uri; metadata:service http; reference:bugtraq,8930; classtype:web-application-activity; sid:2305; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Advanced Poll admin_templates.php access"; flow:to_server,established; content:"/admin_templates.php"; nocase; http_uri; metadata:service http; reference:bugtraq,8890; reference:nessus,11487; classtype:web-application-activity; sid:2298; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP friends.php access"; flow:to_server,established; content:"/friends.php"; nocase; http_uri; metadata:service http; reference:bugtraq,9088; classtype:web-application-activity; sid:2286; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Messagerie supp_membre.php access"; flow:to_server,established; content:"/supp_membre.php"; nocase; http_uri; metadata:service http; reference:bugtraq,4635; classtype:web-application-activity; sid:1745; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Photopost PHP Pro showphoto.php access"; flow:to_server,established; content:"/showphoto.php"; nocase; http_uri; metadata:service http; reference:bugtraq,9557; classtype:web-application-activity; sid:2372; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Phorum admin access"; flow:to_server,established; content:"/admin.php3"; nocase; http_uri; metadata:service http; reference:bugtraq,2271; classtype:attempted-recon; sid:1134; rev:17;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Phorum code access"; flow:to_server,established; content:"/code.php3"; nocase; http_uri; metadata:service http; classtype:attempted-recon; sid:1197; rev:16;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP modules.php access"; flow:to_server,established; content:"/modules.php"; nocase; http_uri; metadata:service http; reference:bugtraq,9879; classtype:web-application-activity; sid:2565; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP YaBB SE packages.php file include"; flow:to_server,established; content:"/packages.php"; fast_pattern; nocase; http_uri; content:"packer.php"; nocase; metadata:service http; reference:bugtraq,6663; classtype:web-application-attack; sid:2362; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP PHP-Wiki cross site scripting attempt"; flow:to_server,established; content:"/modules.php?"; http_uri; content:"name=Wiki"; fast_pattern; nocase; http_uri; content:"<script"; nocase; http_uri; metadata:service http; reference:bugtraq,5254; reference:cve,2002-1070; classtype:web-application-attack; sid:1834; rev:14;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP shoutbox.php access"; flow:to_server,established; content:"/shoutbox.php"; fast_pattern; nocase; http_uri; content:"conf="; nocase; http_uri; metadata:service http; reference:nessus,11668; classtype:web-application-activity; sid:2142; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Advanced Poll admin_tpl_misc_new.php access"; flow:to_server,established; content:"/admin_tpl_misc_new.php"; nocase; http_uri; metadata:service http; reference:bugtraq,8890; reference:nessus,11487; classtype:web-application-activity; sid:2299; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP rolis guestbook remote file include attempt"; flow:to_server,established; content:"/insert.inc.php"; fast_pattern; nocase; http_uri; content:"path="; metadata:service http; reference:bugtraq,9057; classtype:web-application-attack; sid:2284; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP autohtml.php directory traversal attempt"; flow:to_server,established; content:"/autohtml.php"; fast_pattern; nocase; http_uri; content:"name="; content:"../../"; distance:0; metadata:service http; reference:nessus,11630; classtype:web-application-attack; sid:2153; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Invision Board emailer.php file include"; flow:to_server,established; content:"/ad_member.php"; fast_pattern; nocase; http_uri; content:"emailer.php"; nocase; http_uri; metadata:service http; reference:bugtraq,7204; classtype:web-application-activity; sid:2355; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP b2 cafelog gm-2-b2.php access"; flow:to_server,established; content:"/gm-2-b2.php"; nocase; http_uri; metadata:service http; reference:nessus,11667; classtype:web-application-activity; sid:2144; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP phpBB mod tag board sql injection attempt"; flow:to_server,established; content:"tag_board.php"; fast_pattern; nocase; http_uri; content:"action=delete"; nocase; http_uri; content:"id="; nocase; http_uri; pcre:"/tag_board\.php\x3F[^\r\n]*action=delete[^\r\n]*id=[^\r\n\x26]*(select|insert|delete)/Usmi"; metadata:policy security-ips alert, service http; reference:bugtraq,32701; reference:cve,2008-6314; classtype:web-application-attack; sid:15425; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP viewtopic.php access"; flow:to_server,established; content:"/viewtopic.php"; fast_pattern; nocase; http_uri; content:"days="; nocase; http_uri; metadata:service http; reference:bugtraq,7979; reference:cve,2003-0486; reference:nessus,11767; classtype:web-application-attack; sid:2229; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP DCP-Portal remote file include lib script attempt"; flow:to_server,established; content:"/library/lib.php"; fast_pattern; nocase; http_uri; content:"root="; http_uri; metadata:service http; reference:bugtraq,6525; classtype:web-application-attack; sid:2342; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS 80 (msg:"WEB-PHP sphpblog password.txt access attempt"; flow:to_server,established; content:"sphpblog"; http_uri; content:"password.txt"; fast_pattern; nocase; http_uri; metadata:service http; reference:bugtraq,14667; reference:cve,2005-2733; classtype:attempted-user; sid:11664; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP strings overflow"; flow:to_server,established; content:"?STRENGUR"; nocase; http_uri; metadata:service http; reference:bugtraq,1786; reference:cve,2000-0967; classtype:web-application-attack; sid:1086; rev:22;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Advanced Poll admin_templates_misc.php access"; flow:to_server,established; content:"/admin_templates_misc.php"; nocase; http_uri; metadata:service http; reference:bugtraq,8890; reference:nessus,11487; classtype:web-application-activity; sid:2297; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Cyboards options_form.php access"; flow:to_server,established; content:"/options_form.php"; nocase; http_uri; metadata:service http; reference:bugtraq,6597; classtype:web-application-activity; sid:2364; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Typo3 translations.php file include"; flow:to_server,established; content:"/translations.php"; fast_pattern; nocase; http_uri; content:"ONLY="; nocase; metadata:service http; reference:bugtraq,6984; classtype:web-application-attack; sid:2358; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP GlobalFunctions.php access"; flow:to_server,established; content:"/GlobalFunctions.php"; nocase; http_uri; metadata:service http; reference:bugtraq,9057; classtype:web-application-activity; sid:2282; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Blahz-DNS dostuff.php modify user attempt"; flow:to_server,established; content:"/dostuff.php?action=modify_user"; nocase; http_uri; metadata:service http; reference:bugtraq,4618; reference:cve,2002-0599; classtype:web-application-attack; sid:1742; rev:14;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Advanced Poll booth.php access"; flow:to_server,established; content:"/booth.php"; nocase; http_uri; metadata:service http; reference:bugtraq,8890; reference:nessus,11487; classtype:web-application-activity; sid:2301; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Tandberg VCS local file disclosure attempt"; flow:to_server,established; content:"helppage.php"; fast_pattern; nocase; http_uri; content:"page="; nocase; http_uri; content:".."; http_uri; metadata:policy security-ips drop, service http; reference:cve,2009-4511; reference:url,secunia.com/advisories/39275/; classtype:web-application-attack; sid:16678; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP TikiWiki jhot.php script file upload attempt"; flow:to_server,established; content:"/jhot.php"; nocase; http_uri; content:"Content-Disposition|3A|"; nocase; content:"filename="; nocase; pcre:"/^Content-Disposition\x3A[^\r\n]*filename=(?P<q1>\x22|\x27|)[^\r\n]*?\x2Ephp(?P=q1)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,19819; reference:url,tikiwiki.org/tiki-read_article.php?articleid=136; classtype:attempted-user; sid:17597; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP FreePBX recording interface file upload code execution attempt"; flow:to_server,established; content:"config.php"; nocase; http_uri; content:"Content-Disposition"; nocase; content:"name=|22|ivrfile|22 3B|"; distance:0; fast_pattern; nocase; content:"filename=|22|"; distance:0; nocase; pcre:!"/^\w+\.(wav|alaw|ulaw|sln|gsm)\x22/Ri"; metadata:service http; reference:bugtraq,43454; reference:cve,2010-3490; classtype:attempted-admin; sid:18465; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP miniBB rss.php premodDir remote file include attempt"; flow:to_server,established; content:"rss.php"; nocase; http_uri; content:"premodDir="; nocase; http_uri; pcre:"/premodDir=(ftp|https?)/Ui"; metadata:policy security-ips drop, service http; reference:url,osvdb.org/show/osvdb/51460; classtype:web-application-attack; sid:18478; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP miniBB rss.php pathToFiles remote file include attempt"; flow:to_server,established; content:"rss.php"; nocase; http_uri; content:"pathToFiles="; nocase; http_uri; pcre:"/pathToFiles=(ftp|https?)/Ui"; metadata:policy security-ips drop, service http; reference:url,osvdb.org/show/osvdb/51460; classtype:web-application-attack; sid:18479; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Visuplay CMS news_article.php unspecified SQL injection attempt "; flow:to_server,established; content:"news_article|2E|php"; fast_pattern; nocase; http_uri; content:"press_id|3D|"; nocase; pcre:"/press_id\x3D\d+[^\&\r\n]/i"; metadata:service http; reference:bugtraq,33209; classtype:web-application-activity; sid:18586; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP phpMyAdmin session_to_unset session variable injection attempt"; flow:to_server,established; content:"session_to_unset="; fast_pattern:only; http_uri; content:"_SESSION["; nocase; http_uri; pcre:"/session_to_unset=($|[\x26\x3B])/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-2505; reference:cve,2011-2506; reference:url,www.phpmyadmin.net/home_page/security/PMASA-2011-5.php; reference:url,www.phpmyadmin.net/home_page/security/PMASA-2011-6.php; classtype:attempted-user; sid:19553; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Wordpress timthumb.php theme remote file include attack attempt"; flow:to_server,established; content:"timthumb.php|3F|"; nocase; http_uri; content:"src=http"; distance:0; nocase; http_uri; pcre:"/timthumb\x2ephp\x3f[^\r\n]*src=http\x3a\x2f[^\x2e\x2f]+\x2e[^\x2e\x2f]+\x2e[^\x2e\x2f]+\x2e/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,47374; reference:url,code.google.com/p/timthumb/issues/detail?id=212; classtype:web-application-attack; sid:19653; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP php tiny shell upload attempt"; flow:to_server,established; content:"<?=($_=@$_GET[2]).@$_($_GET[1])?>"; fast_pattern:only; http_client_body; metadata:service http; reference:url,h.ackack.net/tiny-php-shell.html; classtype:misc-activity; sid:20533; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Wordcircle SQL injection attempt"; flow:to_server,established; content:"/index.php"; nocase; http_uri; content:"password="; nocase; http_uri; pcre:"/\x2Findex\.php?[^\r\n]*?password=[^\r\n\x26]*?[\x22\x27][^\r\n\x26]*[\x22\x27]/Ui"; metadata:service http; reference:bugtraq,16227; reference:cve,2006-0205; classtype:web-application-activity; sid:20615; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Venom Board SQL injection attempt"; flow:to_server,established; content:"venomboard|2F|forum"; fast_pattern; nocase; http_uri; content:"post.php3"; nocase; http_uri; content:"parent="; nocase; http_uri; pcre:"/\x2Fpost\.php3?[^\r\n]*?parent=[^\r\n\x26]*?union[^\r\n\x26]*select/Ui"; metadata:service http; reference:bugtraq,16176; reference:cve,2006-0160; classtype:web-application-activity; sid:20624; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Venom Board SQL injection attempt "; flow:to_server,established; content:"venomboard|2F|forum"; fast_pattern; nocase; http_uri; content:"post.php3"; nocase; http_uri; content:"topic_id="; nocase; http_uri; pcre:"/\x2Fpost\.php3?[^\r\n]*?topic_id=[^\r\n\x26]*?union[^\r\n\x26]*select/Ui"; metadata:service http; reference:bugtraq,16176; reference:cve,2006-0160; classtype:web-application-activity; sid:20623; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Venom Board SQL injection attempt"; flow:to_server,established; content:"venomboard|2F|forum"; fast_pattern; nocase; http_uri; content:"post.php3"; nocase; http_uri; content:"root="; nocase; http_uri; pcre:"/\x2Fpost\.php3?[^\r\n]*?root=[^\r\n\x26]*?union[^\r\n\x26]*select/Ui"; metadata:service http; reference:bugtraq,16176; reference:cve,2006-0160; classtype:web-application-activity; sid:20625; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Lizard Cart CMS SQL injection in detail.php id attempt"; flow:to_server,established; content:"detail.php"; fast_pattern:only; http_uri; content:"id"; nocase; http_uri; pcre:"/id=[^\r\n\x26]*?([\x22\x27]|%2[27])/i"; metadata:service http; reference:bugtraq,16140; reference:cve,2006-0087; classtype:web-application-attack; sid:20644; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP VEGO Web Forum SQL injection in login.php username attempt"; flow:to_server,established; content:"login.php"; fast_pattern:only; http_uri; content:"username"; nocase; pcre:"/username=[^\r\n\x26]*?([\x22\x27]|%2[27])/i"; metadata:service http; reference:bugtraq,16108; reference:cve,2006-0067; classtype:web-application-attack; sid:20640; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP TheWebForum SQL injection in login.php username attempt"; flow:to_server,established; content:"login.php"; fast_pattern:only; http_uri; content:"username"; nocase; pcre:"/username=[^\r\n\x26]*?([\x22\x27]|%2[27])/i"; metadata:service http; reference:bugtraq,16161; reference:cve,2006-0135; classtype:web-application-attack; sid:20641; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP inTouch SQL injection in index.php user attempt"; flow:to_server,established; content:"index.php"; fast_pattern:only; http_uri; content:"user"; nocase; pcre:"/user=[^\r\n\x26]*?([\x22\x27]|%2[27])/i"; metadata:service http; reference:bugtraq,16110; reference:cve,2006-0088; classtype:web-application-attack; sid:20647; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Benders Calendar SQL injection in index.php this_day attempt"; flow:to_server,established; content:"index.php"; fast_pattern:only; http_uri; content:"this_day"; nocase; pcre:"/this_day=[^\r\n\x26]*?([\x22\x27]|%2[27])/i"; metadata:service http; reference:bugtraq,16242; reference:cve,2006-0252; classtype:web-application-attack; sid:20646; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP ME Download System remote file include in header.php Vb8878b936c2bd8ae0cab"; flow:to_server,established; content:"header.php"; fast_pattern:only; http_uri; content:"Vb8878b936c2bd8ae0cab="; nocase; pcre:"/Vb8878b936c2bd8ae0cab=(https?|ftps?)/i"; metadata:service http; reference:bugtraq,19336; reference:cve,2006-4053; classtype:web-application-attack; sid:20652; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP ScozBook SQL injection in auth.php adminname attempt"; flow:to_server,established; content:"auth.php"; fast_pattern:only; http_uri; content:"adminname"; nocase; pcre:"/adminname=[^\r\n\x26]*?([\x22\x27]|%2[27])/i"; metadata:service http; reference:bugtraq,16115; reference:cve,2006-0079; classtype:web-application-attack; sid:20643; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Akarru remote file include in main_content.php bm_content"; flow:to_server,established; content:"main_content.php"; fast_pattern:only; http_uri; pcre:"/\x2Fmain_content\.php?[^\r\n]*?bm_content=(https?|ftps?)/Ui"; metadata:service http; reference:bugtraq,19870; reference:cve,2006-4645; classtype:web-application-activity; sid:20631; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Lizard Cart CMS SQL injection in pages.php id attempt"; flow:to_server,established; content:"pages.php"; fast_pattern:only; http_uri; content:"id"; nocase; pcre:"/id=[^\r\n\x26]*?([\x22\x27]|%2[27])/i"; metadata:service http; reference:bugtraq,16140; reference:cve,2006-0087; classtype:web-application-attack; sid:20645; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Modernbill remote file include in config.php DIR"; flow:to_server,established; content:"config.php"; fast_pattern:only; http_uri; content:"DIR"; nocase; pcre:"/DIR=(https?|ftps?)/i"; metadata:service http; reference:bugtraq,19335; reference:cve,2006-4034; classtype:web-application-attack; sid:20651; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP geoBlog SQL injection in viewcat.php cat parameter attempt"; flow:to_server,established; content:"viewcat.php"; fast_pattern:only; http_uri; pcre:"/cat=[^\r\n\x26]*([\x22\x27]|%2[27])/i"; metadata:service http; reference:bugtraq,16249; reference:cve,2006-0249; classtype:web-application-activity; sid:20629; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Free File Hosting remote file include in forgot_pass.php ad_body_temp"; flow:to_server,established; content:"forgot_pass.php"; fast_pattern:only; http_uri; content:"ad_body_temp"; nocase; pcre:"/ad_body_temp=(https?|ftps?)/i"; metadata:service http; reference:bugtraq,20781; reference:cve,2006-5762; classtype:web-application-attack; sid:20657; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP AnnoncesV remote file include in annonce.php page"; flow:to_server,established; content:"annonce.php"; fast_pattern:only; http_uri; pcre:"/\x2Fannonce\.php?[^\r\n]*?page=(https?|ftps?)/Ui"; metadata:service http; reference:bugtraq,19854; reference:cve,2006-4622; classtype:web-application-activity; sid:20632; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP GrapAgenda remote file include in index.php page"; flow:to_server,established; content:"index.php"; fast_pattern:only; http_uri; content:"page"; nocase; pcre:"/page=(https?|ftps?)/i"; metadata:service http; reference:bugtraq,19857; reference:cve,2006-4610; classtype:web-application-attack; sid:20654; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Boite de News remote file include in inc.php url_index"; flow:to_server,established; content:"url_index="; fast_pattern:only; http_uri; pcre:"/\x2F(inc2?|index)\.php?[^\r\n]*?url_index=(https?|ftps?)/Ui"; metadata:service http; reference:bugtraq,19440; reference:cve,2006-4123; classtype:web-application-activity; sid:20633; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP GestArtremote file include in aide.php3 aide"; flow:to_server,established; content:"aide.php3"; fast_pattern:only; http_uri; content:"aide"; nocase; pcre:"/aide=(https?|ftps?)/i"; metadata:service http; reference:bugtraq,22825; reference:cve,2006-5612; classtype:web-application-attack; sid:20656; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP TankLogger SQL injection in showInfo.php livestock_id attempt"; flow:to_server,established; content:"showInfo.php"; fast_pattern:only; http_uri; content:"livestock_id"; nocase; pcre:"/livestock_id=[^\r\n\x26]*?([\x22\x27]|%2[27])/i"; metadata:service http; reference:bugtraq,16228; reference:cve,2006-0209; classtype:web-application-attack; sid:20642; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP MyNewsGroups remote file include in layersmenu.inc.php myng_root"; flow:to_server,established; content:"layersmenu.inc.php"; fast_pattern:only; http_uri; content:"myng_root"; nocase; pcre:"/myng_root=(https?|ftps?)/i"; metadata:service http; reference:bugtraq,19258; reference:cve,2006-3966; classtype:web-application-attack; sid:20650; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Bit 5 Blog SQL injection in processlogin.php username via"; flow:to_server,established; content:"processlogin.php"; fast_pattern:only; http_uri; content:"username"; nocase; pcre:"/username=[^\r\n\x26]*?([\x22\x27]|%2[27])/i"; metadata:service http; reference:bugtraq,16244; reference:cve,2006-0320; classtype:web-application-attack; sid:20648; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP ADNForum SQL injection in index.php fid attempt"; flow:to_server,established; content:"index.php"; nocase; http_uri; content:"fid="; fast_pattern:only; pcre:"/fid=[^\r\n\x26]*?([\x22\x27]|%2[27])/i"; metadata:service http; reference:bugtraq,16157; reference:cve,2006-0123; classtype:web-application-attack; sid:20649; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Flashchat remote file include in aedating4CMS.php"; flow:to_server,established; content:"/aedating4CMS.php"; nocase; http_uri; content:"dir[inc]="; nocase; http_uri; pcre:"/\x2Faedating4CMS\.php?[^\r\n]*?dir\[inc\]=(https?|ftps?)/Ui"; metadata:service http; reference:bugtraq,19826; reference:cve,2006-4583; classtype:web-application-activity; sid:20680; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Sourceforge Gallery search engine cross-site scripting attempt"; flow:to_server,established; content:"search.php?"; nocase; http_uri; content:"<script>"; within:25; nocase; http_uri; metadata:service http; reference:cve,2003-0614; reference:url,secunia.com/advisories/9376/; reference:url,www.securityfocus.com/bid/8288; classtype:attempted-admin; sid:20674; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP TSEP remote file include in colorswitch.php tsep_config[absPath]"; flow:to_server,established; content:"tsep_config[absPath]="; fast_pattern:only; http_uri; pcre:"/\x2F(colorswitch|copyright)\.php\?[^\r\n]*?tsep_config\x5BabsPath\x5D\x3D(https?|ftps?)\x3A\x2F/Ui"; metadata:service http; reference:bugtraq,19326; reference:cve,2006-3993; classtype:web-application-attack; sid:20731; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Comet WebFileManager remote file include in CheckUpload.php Language"; flow:to_server,established; content:"CheckUpload.php"; fast_pattern:only; http_uri; pcre:"/Language=(https?|ftps?)/i"; metadata:service http; reference:bugtraq,19433; reference:cve,2006-4077; classtype:web-application-attack; sid:20663; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Sabdrimer remote file include in advanced1.php pluginpath[0]"; flow:to_server,established; content:"pluginpath[0]="; fast_pattern:only; http_uri; pcre:"/\x2Fadvanced1\.php\?[^\r\n]*?pluginpath\x5B0\x5D=(https?|ftps?)/Ui"; metadata:policy security-ips drop, service http; reference:bugtraq,18907; reference:cve,2006-3520; classtype:web-application-attack; sid:20732; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP WoW Roster remote file include with hslist.php and conf.php"; flow:to_server,established; content:"subdir="; fast_pattern:only; http_uri; pcre:"/\x2F(conf|hslist)\.php\?[^\r\n]*?subdir=(https?|ftps?)/Ui"; metadata:service http; reference:cve,2006-3997; reference:cve,2006-3998; classtype:web-application-attack; sid:20728; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Vmist Downstat remote file include in stats.php art"; flow:to_server,established; content:"downstat"; nocase; http_uri; content:"stats.php"; nocase; http_uri; content:"art="; nocase; http_uri; pcre:"/\x2Fstats\.php\x3F[^\r\n]*?art\x3Dhttp\x3A\x2F/Ui"; metadata:service http; reference:bugtraq,20007; reference:cve,2006-4827; classtype:web-application-activity; sid:20818; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP ACal Calendar Project cookie based authentication bypass attempt"; flow:to_server,established; content:"login.php"; nocase; http_uri; content:"ACalAuthenticate|3D|inside"; nocase; http_cookie; metadata:policy security-ips drop, service http; reference:cve,2006-0182; classtype:attempted-user; sid:20819; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Vmist Downstat remote file include in chart.php art"; flow:to_server,established; content:"downstat"; nocase; http_uri; content:"chart.php"; nocase; http_uri; content:"art="; nocase; http_uri; pcre:"/\x2Fchart\.php\x3F[^\r\n]*?art\x3Dhttp\x3A\x2F/Ui"; metadata:service http; reference:bugtraq,20007; reference:cve,2006-4827; classtype:web-application-activity; sid:20815; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Vmist Downstat remote file include in admin.php art"; flow:to_server,established; content:"downstat"; nocase; http_uri; content:"admin.php"; nocase; http_uri; content:"art="; nocase; http_uri; pcre:"/\x2Fadmin\.php\x3F[^\r\n]*?art\x3Dhttp\x3A\x2F/Ui"; metadata:service http; reference:bugtraq,20007; reference:cve,2006-4827; classtype:web-application-activity; sid:20816; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Vmist Downstat remote file include in modes.php art"; flow:to_server,established; content:"downstat"; nocase; http_uri; content:"modes.php"; nocase; http_uri; content:"art="; nocase; http_uri; pcre:"/\x2Fmodes\.php\x3F[^\r\n]*?art\x3Dhttp\x3A\x2F/Ui"; metadata:service http; reference:bugtraq,20007; reference:cve,2006-4827; classtype:web-application-activity; sid:20817; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP OABoard forum script remote file injection attempt"; flow:to_server,established; content:"oaboard"; nocase; http_uri; content:"forum|2E|php|3F|"; nocase; http_uri; content:"inc|3D|http:/"; distance:0; nocase; http_uri; pcre:"/\/oaboard[^\r\n]*?\/forum\.php[^\r\n]*[\x26\x3F]inc\x3Dhttp\x3A\x2F/iU"; metadata:service http; reference:bugtraq,16105; reference:cve,2006-0076; classtype:attempted-user; sid:20826; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP phpThumb fltr[] parameter remote command execution attempt"; flow:to_server,established; content:"/phpThumb.php?"; nocase; http_uri; content:"fltr[]="; nocase; http_uri; content:"|3B|"; within:200; nocase; http_uri; pcre:"/\x2FphpThumb\.php\x3F[^\r\n]*fltr\[\]=[^\r\n\x26]+\x3B/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,39605; reference:cve,2010-1598; reference:url,blog.spiderlabs.com/2011/12/honeypot-alert-phpthumb-fltr-parameter-command-injection-detected.html; classtype:attempted-user; sid:20827; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Remote Execution Backdoor Attempt Against Horde"; flow:to_server,established; content:"/services/javascript.php"; fast_pattern:only; http_uri; content:"href="; http_cookie; content:"file=open_calendar.js"; http_client_body; metadata:policy security-ips drop, service http; reference:cve,2012-0209; reference:url,dev.horde.org/h/jonah/stories/view.php?channel_id=1&id=155; reference:url,eromang.zataz.com/2012/02/15/cve-2012-0209-horde-backdoor-analysis/; reference:url,pastebin.com/U3ADiWrP; classtype:web-application-attack; sid:21375; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"WEB-PHP PECL zip URL wrapper buffer overflow attempt"; flow:to_client,established; file_data; content:"|3C 3F|"; content:"php"; distance:0; nocase; content:"zip|3A 2F 2F|"; distance:0; pcre:"/zip\x3a\x2f\x2f[^\x0A\x20\x09\x0B\x0C\x85\x3E\x3C]{400}/i"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,22883; reference:cve,2007-1399; reference:url,php-security.org/MOPB/MOPB-16-2007.html; classtype:attempted-user; sid:21671; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP JCE Joomla module vulnerable directory traversal or malicious file upload attempt"; flow:to_server,established; content:"option=com_jce"; fast_pattern:only; http_uri; content:"json"; nocase; http_client_body; pcre:"/json\s*=\s*\x7b.*?\x22fn\x22\s*\x3a\s*\x22(getItems|folderRename|file(Delete|Copy))\x22\s*\x2c\s*\x22args\x22\s*\x3a\x5b?[^\x7d]*?\x22[^\x22]*?(\.\.|0day)[^\x22]*?\x22.*?\x7d/imsP"; metadata:policy balanced-ips drop, policy security-ips drop, service http; classtype:attempted-user; sid:21926; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP PHP-CGI remote file include attempt"; flow:to_server,established; content:"auto_prepend_file"; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2012-1823; reference:cve,2012-2311; classtype:attempted-admin; sid:22063; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP PHP-CGI command injection attempt"; flow:to_server,established; content:".php?"; http_uri; content:"-s"; nocase; http_uri; content:!"="; http_raw_uri; pcre:"/\x2ephp\x3f\s*-s/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2012-1823; reference:cve,2012-2311; classtype:attempted-admin; sid:22064; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP PHP-CGI command injection attempt"; flow:to_server,established; content:"-s"; http_uri; content:!"="; http_raw_uri; pcre:"/\x3F\s*?-s/Ui"; metadata:service http; reference:cve,2012-1823; reference:cve,2012-2311; classtype:attempted-admin; sid:22097; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP EXIF header parsing integer overflow attempt big endian"; flow:to_server,established; content:"Exif|00 00 4D 4D 00 2A 00 00 00 08|"; http_client_body; content:"|90 03 00 02|"; distance:0; http_client_body; byte_test:4,>,2048,0,relative; metadata:policy security-ips drop, service http; reference:cve,2011-4566; reference:url,osvdb.org/77446; classtype:web-application-attack; sid:22950; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP EXIF header parsing integer overflow attempt little endian"; flow:to_server,established; content:"Exif|00 00 49 49 2A 00 08 00 00 00|"; http_client_body; content:"|03 90 02 00|"; distance:0; http_client_body; byte_test:4,>,2048,0,relative,little; metadata:policy security-ips drop, service http; reference:cve,2011-4566; reference:url,osvdb.org/77446; classtype:web-application-attack; sid:22951; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Symantec Web Gateway timer.php cross site scripting attempt"; flow:to_server,established; content:"/spywall/timer.php"; fast_pattern:only; http_uri; pcre:"/[?&](l|d|profile)=[^&]+?([\x22\x27\x3c\x3e\x28\x29]|script|onload|src)/U"; metadata:service http; reference:bugtraq,53396; reference:cve,2012-0296; reference:url,www.osvdb.org/show/osvdb/82022; classtype:web-application-attack; sid:23177; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP PHP-Nuke index.php SQL injection attempt"; flow:to_server,established; content:"insert"; fast_pattern; nocase; http_header; content:"index.php"; nocase; http_uri; pcre:"/Referer\x3a[^\r\n]*?[\x27\x22]\x29[^\r\n]*?INSERT/Hi"; metadata:service http; reference:bugtraq,22638; reference:cve,2007-1061; classtype:web-application-attack; sid:23406; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-PHP php-shell remote command shell upload attempt"; flow:to_client,established; file_data; content:"debug_msg('<h1>GOTCHA:"; fast_pattern:only; metadata:policy security-ips drop, service http; classtype:attempted-admin; sid:23441; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP PHP-Nuke index.php SQL injection attempt"; flow:to_server,established; content:"select"; fast_pattern; nocase; http_header; content:"index.php"; nocase; http_uri; pcre:"/Referer\x3a[^\r\n]*?[\x27\x22]\x29[^\r\n]*?SELECT/Hi"; metadata:service http; reference:bugtraq,22638; reference:cve,2007-1061; classtype:web-application-attack; sid:23405; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-PHP php-shell failed remote command injection attempt"; flow:to_client,established; file_data; content:".phpwas not found on this server.</p>"; fast_pattern:only; metadata:policy security-ips drop, service http; classtype:attempted-admin; sid:23443; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-PHP php-shell remote command shell upload attempt"; flow:to_client,established; file_data; content:"stripslashes($_REQUEST[|5C|'"; fast_pattern:only; content:"function"; nocase; content:"debug_msg"; distance:0; nocase; content:"my_exec"; distance:0; nocase; content:"spawn_shell"; distance:0; nocase; metadata:policy security-ips drop, service http; classtype:attempted-admin; sid:23440; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-PHP php-shell remote command shell upload attempt"; flow:to_client,established; file_data; content:"stripslashes($_REQUEST[|5C|'"; fast_pattern:only; pcre:"/global\s+(?P<global>\$\w+)\s*\x3b\s*(?P=global)\s*=.*?\{\s*eval\(\s*stripslashes\(\s*\$_REQUEST\[\x5c'.*?function_exists\(\s*(?P<q>.)(exec|passthru|system|shell_exec|exec_popen)(?P=q)\s*\)/smi"; metadata:policy security-ips drop, service http; classtype:attempted-admin; sid:23439; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-PHP php-shell remote command injection attempt"; flow:to_server,established; content:".php?"; fast_pattern:only; http_uri; pcre:"/\x2f(links|xml|configs|functions|virtual|pointer)\.php?.*?[a-f0-9]{32}=\w+\x28.*?\x29\x3b/iU"; metadata:service http; classtype:attempted-admin; sid:23442; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"WEB-PHP php-shell remote command shell initialization attempt"; flow:to_client,established; file_data; content:"|3B|s:4:|22|pass|22 3B|s:32:|22|"; fast_pattern:only; pcre:"/\x3bs\x3a4\x3a\x22pass\x22\x3bs\x3a32\x3a\x22[a-f0-9]{32}\x22/i"; metadata:policy security-ips drop, service http; classtype:attempted-admin; sid:23438; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Wordpress Invit0r plugin php upload attempt"; flow:to_server,established; content:"/wp-content/plugins/invit0r/lib/php-ofc-library/ofc_upload_image.php"; fast_pattern:only; http_uri; content:"name="; http_uri; content:"<?php "; nocase; http_client_body; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,53995; reference:url,osvdb.org/show/osvdb/82985; reference:url,www.opensyscom.fr/Actualites/wordpress-plugins-invit0r-arbitrary-file-upload-vulnerability.html; classtype:web-application-attack; sid:23485; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Arbitrary file location upload attempt"; flow:to_server,established; content:"POST"; http_method; content:".php"; http_uri; content:"Content-Type: multipart/form-data"; http_header; content:"filename="; fast_pattern:only; http_client_body; pcre:"/filename=(\x22|\x27)\.\.\x2f/smi"; metadata:service http; reference:bugtraq,11190; reference:cve,2004-0959; classtype:web-application-activity; sid:23613; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Symantec Web Gateway blocked.php id parameter sql injection attempt"; flow:to_server,established; content:"/spywall/blocked.php"; fast_pattern:only; http_uri; pcre:"/[?&]id=[^&]*?[\x28\x29]/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,54424; reference:cve,2012-2574; classtype:web-application-attack; sid:23784; rev:2;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP Symantec Web Gateway pbcontrol.php filename parameter command injection attempt"; flow:to_server,established; content:"/spywall/pbcontrol.php"; fast_pattern:only; http_uri; pcre:"/[?&]filename=[^&]*?[\x22\x27]\x3B/Ui"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,54426; reference:cve,2012-2953; classtype:attempted-admin; sid:23783; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP exif invalid tag data buffer overflow attempt"; flow:to_server,established; content:"Exif|00 00|II|2A 00|"; depth:16; offset:6; http_client_body; content:"|05 02 05 00|"; within:1024; http_client_body; byte_test:4,>,268435457,0,relative,little; metadata:service http; reference:bugtraq,46365; reference:cve,2011-0708; classtype:denial-of-service; sid:23796; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-PHP PHP use-after-free in substr_replace attempt"; flow:to_server,established; content:"substr_replace("; fast_pattern:only; http_client_body; content:"<?"; http_client_body; pcre:"/substr_replace\((\s*\$\w+\s*,\s*){3,}.*?\)\x3b/Psmi"; metadata:service http; reference:cve,2011-1148; classtype:misc-activity; sid:23792; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"WEB-PHP PHP use-after-free in substr_replace attempt"; flow:to_client,established; file_data; content:"substr_replace("; fast_pattern:only; content:"<?"; pcre:"/substr_replace\((\s*\$\w+\s*,\s*){3,}.*?\)\x3b/smi"; metadata:service http, service imap, service pop3; reference:cve,2011-1148; classtype:misc-activity; sid:23791; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Joomla Remote File Include upload attempt"; flow:to_server,established; content:"POST"; http_method; content:"/admin/addcontent.inc.php"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,stopmalvertising.com/security/95.211.20.103-local-file-inclusion-attack.html; reference:url,www.mmleoni.net/sql-iniection-lfi-protection-plugin-for-joomla; classtype:attempted-user; sid:23828; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP Joomla Remote File Include upload attempt"; flow:to_server,established; content:"POST"; http_method; content:"/images/psg.php"; http_uri; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,stopmalvertising.com/security/95.211.20.103-local-file-inclusion-attack.html; reference:url,www.mmleoni.net/sql-iniection-lfi-protection-plugin-for-joomla; classtype:attempted-user; sid:23827; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP PHP truncated crypt function attempt"; flow:to_server,established; content:"crypt("; fast_pattern:only; http_client_body; content:"<?"; http_client_body; pcre:"/((?P<m1>\$\w+)\s*=\s*(?P<q1>[\x22\x27])\s*[^(?P=q1)]+(\\x80|\x80).*?crypt\(\s*(?P=m1)|crypt\(\s*(?P<q2>[\x22\x27])\s*[^(?P=q1)]+(\\x80|\x80))/Psmi"; metadata:policy security-ips drop, service http; reference:cve,2012-2143; classtype:attempted-admin; sid:23896; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"WEB-PHP PHP truncated crypt function attempt"; flow:to_client,established; file_data; content:"crypt("; fast_pattern:only; content:"<?"; pcre:"/((?P<m1>\$\w+)\s*=\s*(?P<q1>[\x22\x27])\s*[^(?P=q1)]+(\\x80|\x80).*?crypt\(\s*(?P=m1)|crypt\(\s*(?P<q2>[\x22\x27])\s*[^(?P=q1)]+(\\x80|\x80))/smi"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:cve,2012-2143; classtype:attempted-admin; sid:23895; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"WEB-PHP empty zip file upload attempt"; flow:to_server,established; content:"|50 4B 05 06 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; fast_pattern:only; metadata:service http; reference:bugtraq,46354; reference:cve,2011-0421; classtype:denial-of-service; sid:23944; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"WEB-PHP Invalid global flag attachment attempt"; flow:to_client,established; file_data; content:"<?php"; content:"ZipArchive"; content:"addGlob"; distance:0; pcre:"/\x24(?P<var1>\w*)\s*\x3d\s*new\s*ZipArchive\x28\x29.*?\x24(?P=var1)\x2d\x3eaddGlob\x28[\x22\x27]?(?!GLOB_BRACE|GLOB_MARK|GLOB_NOSORT|GLOB_NOCHECK|GLOB_NOESCAPE|GLOB_ERR|GLOB_ONLYDIR)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,49252; reference:cve,2011-1471; classtype:denial-of-service; sid:23937; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"WEB-PHP calendar conversion remote integer overflow attempt"; flow:to_client,established; file_data; content:"cal_from_jd"; fast_pattern:only; pcre:"/cal_from_jd\x28\s*\d{9,}/mi"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,46967; reference:cve,2011-1466; classtype:attempted-user; sid:23975; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP zend_strndup null pointer dereference attempt"; flow:to_server,established; content:"define|28|"; nocase; content:"str_repeat|28|"; fast_pattern:only; pcre:"/<\?(php)?.{1,256}define\s*\x28\s*str_repeat\s*\x28\s*[\x22\x27][^\x22\x27]+[\x22\x27]\s*\x2c\s*\x24argv/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-4153; classtype:attempted-dos; sid:23994; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"WEB-PHP calendar conversion remote integer overflow attempt"; flow:to_client,established; file_data; content:"cal_from_jd"; fast_pattern:only; pcre:"/\x24(?P<var>\w*)\s*=\s*(rand\x28\d\x2c\s*\d{9,}|\d{9,}).*?cal_from_jd\x28\s*\x24(?P=var)/smi"; metadata:policy security-ips drop, service http, service imap, service pop3; reference:bugtraq,46967; reference:cve,2011-1466; classtype:attempted-user; sid:23974; rev:1;)
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP libtidy null pointer dereference attempt"; flow:to_server,established; content:"<?"; content:"Tidy"; distance:0; content:"diagnose"; fast_pattern:only; pcre:"/(?P<var>\x24\w+)\s*=\s*(new Tidy|Tidy->new)\x28\s*[\x22\x27]\x2a[\x22\x27]\s*\x29.{1,256}(?P=var)->diagnose/ims"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-4153; classtype:attempted-dos; sid:23995; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"WEB-PHP PHP 5.3.3 mt_rand integer overflow attempt"; flow:to_server,established; content:"mt_getrandmax("; fast_pattern:only; http_client_body; content:"<?"; pcre:"/(define\(\s*(?P<q1>[\x22\x27])\s*(?P<m1>\w+)(?P=q1)\s*,\s*mt_getrandmax\(\)\s*\+\d+\s*\)\x3b.*?mt_rand\(\s*0\s*,\s*(?P=m1)\s*\)|(?P<m2>\$\w+)\s*=\s*mt_getrandmax\(\)\s*\+\s*\d+\s*\x3b.*?mt_rand\(\s*0\s*,\s*(?P=m2)\s*\)|mt_rand\(\s*0\s*,\s*mt_getrandmax\(\)\s*\+\s*\d+\s*\)\x3b)/smi"; metadata:service http; reference:cve,2011-0755; classtype:misc-activity; sid:24061; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"WEB-PHP PHP 5.3.3 mt_rand integer overflow attempt"; flow:to_client,established; file_data; content:"mt_getrandmax("; fast_pattern:only; content:"<?"; pcre:"/(define\(\s*(?P<q1>[\x22\x27])\s*(?P<m1>\w+)(?P=q1)\s*,\s*mt_getrandmax\(\)\s*\+\d+\s*\)\x3b.*?mt_rand\(\s*0\s*,\s*(?P=m1)\s*\)|(?P<m2>\$\w+)\s*=\s*mt_getrandmax\(\)\s*\+\s*\d+\s*\x3b.*?mt_rand\(\s*0\s*,\s*(?P=m2)\s*\)|mt_rand\(\s*0\s*,\s*mt_getrandmax\(\)\s*\+\s*\d+\s*\)\x3b)/smi"; metadata:service http, service imap, service pop3; reference:cve,2011-0755; classtype:misc-activity; sid:24060; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP phpinfo GET POST and COOKIE Parameters cross site scripting attempt"; flow:to_server,established; content:"|3D|"; content:"script"; within:9; nocase; pcre:"/(\x5B|\x25\x35\x62)(\x5D|\x25\x35\x64)\x3D(\x3C|\x25\x33\x63)script/i"; metadata:service http; reference:cve,2007-1287; reference:url,php-security.org/MOPB/MOPB-08-2007.html; classtype:attempted-user; sid:21670; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"WEB-PHP RFC1867 file-upload implementation denial of service attempt"; flow:to_server,established; content:"POST"; http_method; content:"|0A|Content-Disposition|3A|"; fast_pattern:only; http_client_body; pcre:"/\nContent-Disposition\x3a[^\n]*?name\s*=\s*(?P<quote>[\x22\x27]).*?\[(?P=quote)\x3b/Pims"; metadata:policy security-ips drop, service http; reference:cve,2012-1172; classtype:attempted-dos; sid:24093; rev:1;)
