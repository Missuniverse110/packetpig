# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Mozilla Thunderbird WYSIWYG engine filtering IFRAME JavaScript execution attempt"; flow:to_server,established; content:"<iframe"; nocase; pcre:"/^\s*[^\x3e]*src\s*\x3d\s*[\x22\x27][^\x22\x27]*javascript\x3a/iR"; metadata:policy security-ips drop; reference:bugtraq,16770; reference:cve,2006-0884; classtype:attempted-user; sid:16038; rev:4;)
# Copyright 2001-2005 Sourcefire, Inc. All Rights Reserved
#
# This file may contain proprietary rules that were created, tested and
# certified by Sourcefire, Inc. (the "VRT Certified Rules") as well as
# rules that were created by Sourcefire and other third parties and
# distributed under the GNU General Public License (the "GPL Rules").  The
# VRT Certified Rules contained in this file are the property of
# Sourcefire, Inc. Copyright 2005 Sourcefire, Inc. All Rights Reserved.
# The GPL Rules created by Sourcefire, Inc. are the property of
# Sourcefire, Inc. Copyright 2002-2005 Sourcefire, Inc. All Rights
# Reserved.  All other GPL Rules are owned and copyrighted by their
# respective owners (please see www.snort.org/contributors for a list of
# owners and their respective copyrights).  In order to determine what
# rules are VRT Certified Rules or GPL Rules, please refer to the VRT
# Certified Rules License Agreement.
#
#
# $Id: smtp.rules,v 1.122.2.8 2011-08-18 20:19:19 vrtbuild Exp $
#-----------
# SMTP RULES
#-----------

# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP RCPT TO overflow"; flow:to_server,established; content:"rcpt to|3A|"; nocase; isdataat:256,relative; pcre:"/^RCPT TO\x3a\s*\x3c?[^\n\x3e]{256}/im"; metadata:policy security-ips drop; reference:bugtraq,2283; reference:bugtraq,9696; reference:cve,2001-0260; reference:cve,2003-0694; reference:cve,2008-0394; reference:cve,2009-0410; classtype:attempted-admin; sid:654; rev:19;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP chameleon overflow"; flow:to_server,established; content:"HELP"; nocase; isdataat:500,relative; pcre:"/^HELP\s[^\n]{500}/ism"; reference:arachnids,266; reference:bugtraq,2387; reference:cve,1999-0261; classtype:attempted-admin; sid:657; rev:14;)
alert tcp $EXTERNAL_NET 113 -> $SMTP_SERVERS 25 (msg:"SMTP sendmail 8.6.9 exploit"; flow:to_server,established; content:"|0A|D/"; reference:arachnids,140; reference:bugtraq,2311; reference:cve,1999-0204; classtype:attempted-admin; sid:655; rev:10;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP exchange mime DOS"; flow:to_server,established; content:"charset = |22 22|"; nocase; reference:bugtraq,1869; reference:cve,2000-1006; reference:nessus,10558; reference:url,www.microsoft.com/technet/security/bulletin/MS00-082.mspx; classtype:attempted-dos; sid:658; rev:13;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP expn decode"; flow:to_server,established; content:"expn"; nocase; content:"decode"; fast_pattern:only; pcre:"/^expn\s+decode/smi"; reference:arachnids,32; reference:cve,1999-0096; reference:nessus,10248; classtype:attempted-recon; sid:659; rev:12;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP expn root"; flow:to_server,established; content:"expn"; nocase; content:"root"; fast_pattern:only; pcre:"/^expn\s+root/smi"; reference:arachnids,31; reference:cve,1999-0531; reference:nessus,10249; classtype:attempted-recon; sid:660; rev:13;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP expn *@"; flow:to_server,established; content:"expn"; fast_pattern:only; content:"*@"; pcre:"/^expn\s+\*@/smi"; reference:cve,1999-1200; classtype:misc-attack; sid:1450; rev:8;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP majordomo ifs"; flow:to_server,established; content:"eply-to|3A| a~.`/bin/"; fast_pattern:only; reference:arachnids,143; reference:bugtraq,2310; reference:cve,1999-0207; classtype:attempted-admin; sid:661; rev:12;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP sendmail 5.5.5 exploit"; flow:to_server,established; content:"mail from|3A| |22 7C|"; fast_pattern:only; reference:arachnids,119; reference:cve,1999-0203; reference:nessus,10258; classtype:attempted-admin; sid:662; rev:11;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP rcpt to command attempt"; flow:to_server,established; content:"rcpt to|3A|"; fast_pattern:only; pcre:"/^rcpt\s+to\:\s*[|\x3b]/smi"; reference:arachnids,172; reference:bugtraq,1; reference:cve,1999-0095; classtype:attempted-admin; sid:663; rev:17;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP RCPT TO decode attempt"; flow:to_server,established; content:"rcpt to|3A|"; nocase; content:"decode"; distance:0; nocase; pcre:"/^rcpt to\:\s*decode/smi"; reference:arachnids,121; reference:bugtraq,2308; reference:cve,1999-0203; classtype:attempted-admin; sid:664; rev:17;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP sendmail 5.6.5 exploit"; flow:to_server,established; content:"MAIL FROM|3A| |7C|/usr/ucb/tail"; fast_pattern:only; reference:arachnids,122; reference:bugtraq,2308; reference:cve,1999-0203; classtype:attempted-user; sid:665; rev:11;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP sendmail 8.6.10 exploit"; flow:to_server,established; content:"Croot|0D 0A|Mprog, P=/bin/"; fast_pattern:only; reference:arachnids,123; reference:bugtraq,2311; reference:cve,1999-0204; classtype:attempted-user; sid:667; rev:11;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP sendmail 8.6.10 exploit"; flow:to_server,established; content:"Croot|09 09 09 09 09 09 09|Mprog,P=/bin"; fast_pattern:only; reference:arachnids,124; reference:bugtraq,2311; reference:cve,1999-0204; classtype:attempted-user; sid:668; rev:11;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP sendmail 8.6.9 exploit"; flow:to_server,established; content:"|0A|Croot|0A|Mprog"; fast_pattern:only; reference:arachnids,142; reference:bugtraq,2311; reference:cve,1999-0204; classtype:attempted-user; sid:669; rev:11;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP sendmail 8.6.9 exploit"; flow:to_server,established; content:"|0A|C|3A|daemon|0A|R"; fast_pattern:only; reference:arachnids,139; reference:bugtraq,2311; reference:cve,1999-0204; classtype:attempted-user; sid:670; rev:10;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP sendmail 8.6.9c exploit"; flow:to_server,established; content:"|0A|Croot|0D 0A|Mprog"; fast_pattern:only; reference:arachnids,141; reference:bugtraq,2311; reference:cve,1999-0204; classtype:attempted-user; sid:671; rev:11;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP vrfy decode"; flow:to_server,established; content:"vrfy"; nocase; content:"decode"; distance:1; nocase; pcre:"/^vrfy\s+decode/smi"; reference:arachnids,373; reference:cve,1999-0096; classtype:attempted-recon; sid:672; rev:12;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP vrfy root"; flow:to_server,established; content:"vrfy"; nocase; content:"root"; distance:1; nocase; pcre:"/^vrfy\s+root/smi"; reference:cve,1999-0531; classtype:attempted-recon; sid:1446; rev:9;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP ehlo cybercop attempt"; flow:to_server,established; content:"ehlo cybercop|0A|quit|0A|"; fast_pattern:only; reference:arachnids,372; reference:cve,1999-0531; classtype:protocol-command-decode; sid:631; rev:10;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP expn cybercop attempt"; flow:to_server,established; content:"expn cybercop"; fast_pattern:only; reference:arachnids,371; reference:cve,1999-0531; classtype:protocol-command-decode; sid:632; rev:9;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP HELO overflow attempt"; flow:to_server,established; content:"HELO"; nocase; isdataat:500,relative; pcre:"/^HELO\s[^\n]{500}/smi"; metadata:policy security-ips drop; reference:bugtraq,7726; reference:bugtraq,895; reference:cve,2000-0042; reference:nessus,10324; reference:nessus,11674; classtype:attempted-admin; sid:1549; rev:22;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP ETRN overflow attempt"; flow:to_server,established; content:"ETRN"; nocase; isdataat:500,relative; pcre:"/^ETRN\s[^\n]{500}/smi"; reference:bugtraq,1297; reference:bugtraq,7515; reference:cve,2000-0490; reference:nessus,10438; classtype:attempted-admin; sid:1550; rev:17;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP From comment overflow attempt"; flow:to_server,established; content:"From|3A|"; nocase; content:"<><><><><><><><><><><><><><><><><><><><><><>"; distance:0; content:"|28|"; distance:1; content:"|29|"; distance:1; reference:bugtraq,6991; reference:cve,2002-1337; reference:url,www.kb.cert.org/vuls/id/398025; classtype:attempted-admin; sid:2087; rev:10;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Content-Transfer-Encoding overflow attempt"; flow:to_server,established; content:"Content-Transfer-Encoding"; nocase; content:"|3A|"; distance:0; isdataat:100,relative; content:!"|0A|"; within:100; pcre:"/^\s*Content-Transfer-Encoding\s*\x3A\s*[^\n]{100}/mi"; metadata:policy security-ips drop; reference:cve,2003-0161; reference:url,www.cert.org/advisories/CA-2003-12.html; classtype:attempted-admin; sid:2183; rev:10;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP XEXCH50 overflow attempt"; flow:to_server,established; content:"XEXCH50"; fast_pattern:only; pcre:"/^XEXCH50\s+-\d/smi"; metadata:policy security-ips drop; reference:bugtraq,8838; reference:cve,2003-0714; reference:nessus,11889; reference:url,www.microsoft.com/technet/security/bulletin/MS03-046.mspx; classtype:attempted-admin; sid:2253; rev:13;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP EXPN overflow attempt"; flow:to_server,established; content:"EXPN"; nocase; isdataat:255,relative; pcre:"/^EXPN[^\n]{255}/smi"; metadata:policy security-ips drop; reference:bugtraq,6991; reference:bugtraq,7230; reference:cve,2002-1337; reference:cve,2003-0161; classtype:attempted-admin; sid:2259; rev:12;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP VRFY overflow attempt"; flow:to_server,established; content:"VRFY"; nocase; isdataat:255,relative; pcre:"/^VRFY[^\n]{255}/smi"; metadata:policy security-ips drop; reference:bugtraq,6991; reference:bugtraq,7230; reference:cve,2002-1337; reference:cve,2003-0161; classtype:attempted-admin; sid:2260; rev:12;)

# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP SEND FROM sendmail prescan too many addresses overflow"; flow:to_server,established; content:"SEND FROM|3A|"; fast_pattern:only; pcre:"/^SEND FROM\x3a\s*[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?</smi"; reference:bugtraq,6991; reference:cve,2002-1337; reference:nessus,11316; classtype:attempted-admin; sid:2261; rev:12;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP SEND FROM sendmail prescan too long addresses overflow"; flow:to_server,established; content:"SEND FROM|3A|"; fast_pattern:only; pcre:"/^SEND FROM\x3a\s+[\w\s@\.]{200,}\x3b[\w\s@\.]{200,}\x3b[\w\s@\.]{200}/smi"; reference:bugtraq,7230; reference:cve,2003-0161; reference:nessus,11499; classtype:misc-attack; sid:2262; rev:12;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP SAML FROM sendmail prescan too many addresses overflow"; flow:to_server,established; content:"SAML FROM|3A|"; fast_pattern:only; pcre:"/^SAML FROM\x3a\s*[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?</smi"; reference:bugtraq,6991; reference:cve,2002-1337; classtype:attempted-admin; sid:2263; rev:12;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP SAML FROM sendmail prescan too long addresses overflow"; flow:to_server,established; content:"SAML FROM|3A|"; fast_pattern:only; pcre:"/^SAML FROM\x3a\s+[\w\s@\.]{200,}\x3b[\w\s@\.]{200,}\x3b[\w\s@\.]{200}/smi"; reference:bugtraq,7230; reference:cve,2003-0161; reference:nessus,11499; classtype:misc-attack; sid:2264; rev:12;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP SOML FROM sendmail prescan too many addresses overflow"; flow:to_server,established; content:"SOML FROM|3A|"; fast_pattern:only; pcre:"/^SOML FROM\x3a\s*[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?</smi"; reference:bugtraq,6991; reference:cve,2002-1337; classtype:attempted-admin; sid:2265; rev:10;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP SOML FROM sendmail prescan too long addresses overflow"; flow:to_server,established; content:"SOML FROM|3A|"; fast_pattern:only; pcre:"/^SOML FROM\x3a\s+[\w\s@\.]{200,}\x3b[\w\s@\.]{200,}\x3b[\w\s@\.]{200}/smi"; reference:bugtraq,7230; reference:cve,2003-0161; reference:nessus,11499; classtype:misc-attack; sid:2266; rev:12;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP MAIL FROM sendmail prescan too many addresses overflow"; flow:to_server,established; content:"MAIL FROM|3A|"; fast_pattern:only; pcre:"/^MAIL FROM\x3a\s*[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?</smi"; reference:bugtraq,6991; reference:cve,2002-1337; classtype:attempted-admin; sid:2267; rev:11;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP MAIL FROM sendmail prescan too long addresses overflow"; flow:to_server,established; content:"MAIL FROM|3A|"; fast_pattern:only; pcre:"/^MAIL FROM\x3a\s+[\w\s@\.]{200,}\x3b[\w\s@\.]{200,}\x3b[\w\s@\.]{200}/smi"; reference:bugtraq,7230; reference:cve,2003-0161; reference:nessus,11499; classtype:attempted-admin; sid:2268; rev:12;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP RCPT TO sendmail prescan too many addresses overflow"; flow:to_server,established; content:"RCPT TO|3A|"; fast_pattern:only; pcre:"/^RCPT TO\x3a\s*[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?<[^\n]*?</smi"; reference:bugtraq,6991; reference:cve,2002-1337; classtype:attempted-admin; sid:2269; rev:11;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP RCPT TO sendmail prescan too long addresses overflow"; flow:to_server,established; content:"RCPT TO|3A|"; fast_pattern:only; pcre:"/^RCPT TO\x3a\s*[\w\s@\.]{200,}\x3b[\w\s@\.]{200,}\x3b[\w\s@\.]{200}/smi"; reference:bugtraq,7230; reference:cve,2003-0161; reference:cve,2003-0694; reference:nessus,11499; classtype:attempted-admin; sid:2270; rev:14;)
alert tcp $SMTP_SERVERS 25 -> $EXTERNAL_NET any (msg:"SMTP AUTH LOGON brute force attempt"; flow:from_server,established; content:"Authentication unsuccessful"; offset:54; nocase; detection_filter:track by_dst, count 5, seconds 60; classtype:suspicious-login; sid:2275; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP WinZip MIME content-type buffer overflow"; flow:to_server,established; content:"Content-Type|3A|"; fast_pattern:only; pcre:"/name=[^\r\n]*?\.(mim|uue|uu|b64|bhx|hqx|xxe)/smi"; pcre:"/(name|id|number|total|boundary)=\s*[^\r\n\x3b\s\x2c]{300}/smi"; reference:bugtraq,9758; reference:cve,2004-0333; reference:nessus,12621; classtype:attempted-user; sid:2487; rev:14;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP WinZip MIME content-disposition buffer overflow"; flow:to_server,established; content:"Content-Type|3A|"; fast_pattern:only; pcre:"/name=[^\r\n]*?\.(mim|uue|uu|b64|bhx|hqx|xxe)/smi"; content:"Content-Disposition|3A|"; nocase; pcre:"/name=\s*[^\r\n\x3b\s\x2c]{300}/smi"; reference:bugtraq,9758; reference:cve,2004-0333; reference:nessus,12621; classtype:attempted-user; sid:2488; rev:14;)


# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 465 (msg:"SMTP SSLv3 invalid data version attempt"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|16 03|"; depth:2; content:"|01|"; depth:1; offset:5; content:!"|03|"; depth:1; offset:9; reference:bugtraq,10115; reference:cve,2004-0120; reference:nessus,12204; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-dos; sid:2504; rev:14;)




# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP TLS SSLv3 invalid data version attempt"; flow:to_server,established; flowbits:isset,starttls.attempt; content:"|16 03|"; depth:2; content:"|01|"; depth:1; offset:5; content:!"|03|"; depth:1; offset:9; reference:bugtraq,10115; reference:cve,2004-0120; reference:nessus,12204; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-dos; sid:2541; rev:11;)

# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP PCT Client_Hello overflow attempt"; flow:to_server,established; flowbits:isset,starttls.attempt; flowbits:isnotset,sslv2.server_hello.request; flowbits:isnotset,sslv3.server_hello.request; flowbits:isnotset,tlsv1.server_hello.request; content:"|01|"; depth:1; offset:2; byte_test:2,>,0,5; byte_test:2,!,0,7; byte_test:2,!,16,7; byte_test:2,>,20,9; content:"|8F|"; depth:1; offset:11; byte_test:2,>,32768,0,relative; reference:bugtraq,10116; reference:cve,2003-0719; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:2528; rev:22;)

# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 465 (msg:"SMTP SSLv3 Client_Hello request"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|16 03 00|"; depth:3; content:"|01|"; depth:1; offset:5; flowbits:set,sslv3.client_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:2542; rev:11;)
# alert tcp $SMTP_SERVERS 25 -> $EXTERNAL_NET any (msg:"SMTP SSLv3 Server_Hello request"; flow:to_client,established; flowbits:isset,sslv3.client_hello.request; content:"|16 03|"; depth:2; content:"|02|"; depth:1; offset:5; flowbits:set,sslv3.server_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:2543; rev:13;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 465 (msg:"SMTP SSLv3 invalid Client_Hello attempt"; flow:to_server,established; flowbits:isset,sslv3.server_hello.request; content:"|16 03|"; depth:2; content:"|01|"; depth:1; offset:5; reference:cve,2004-0120; reference:nessus,12204; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-dos; sid:2544; rev:10;)


# alert tcp $SMTP_SERVERS 465 -> $EXTERNAL_NET any (msg:"SMTP SSLv2 Server_Hello request"; flow:from_server,established; flowbits:isset,sslv2.client_hello.request; content:"|04|"; depth:1; offset:2; content:"|00 02|"; depth:2; offset:5; flowbits:set,sslv2.server_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:3497; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 465 (msg:"SMTP SSLv2 Client_Hello with pad request"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; byte_test:1,<,128,0; content:"|01|"; depth:1; offset:3; content:"|00 02|"; depth:2; offset:6; flowbits:set,sslv2.client_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:3494; rev:6;)
# alert tcp $SMTP_SERVERS 465 -> $EXTERNAL_NET any (msg:"SMTP TLSv1 Server_Hello request"; flow:to_client,established; flowbits:isset,tlsv1.client_hello.request; content:"|16 03 01|"; depth:3; content:"|02|"; depth:1; offset:5; flowbits:set,tlsv1.server_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:3498; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 465 (msg:"SMTP TLSv1 Client_Hello request"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|16 03 01|"; depth:3; content:"|01|"; depth:1; offset:5; flowbits:set,tlsv1.client_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:3495; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Content-Encoding overflow attempt"; flow:to_server,established; content:"Content-Encoding"; nocase; content:"|3A|"; distance:0; pcre:"/^\s*Content-Encoding\s*\x3A\s*[^\r\n]{300}/mi"; metadata:policy security-ips drop; reference:bugtraq,7419; reference:cve,2003-0113; reference:url,www.microsoft.com/technet/security/bulletin/MS03-015.mspx; classtype:attempted-admin; sid:3462; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 465 (msg:"SMTP TLSv1 Client_Hello via SSLv2 handshake request"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; byte_test:1,>,127,0; content:"|01|"; depth:1; offset:2; content:"|03 01|"; depth:2; offset:3; flowbits:set,tlsv1.client_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:3496; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 465 (msg:"SMTP SSLv2 Client_Hello request"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; byte_test:1,>,127,0; content:"|01|"; depth:1; offset:2; content:"|00 02|"; depth:2; offset:5; flowbits:set,sslv2.client_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:3493; rev:7;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Content-Type overflow attempt"; flow:to_server,established; content:"Content-Type"; nocase; content:"|3A|"; distance:0; pcre:"/^\s*Content-Type\s*\x3A\s*[^\r\n]{300}/mi"; metadata:policy security-ips drop; reference:bugtraq,44732; reference:bugtraq,7419; reference:cve,2003-0113; reference:url,www.microsoft.com/technet/security/bulletin/MS03-015.mspx; classtype:attempted-admin; sid:3461; rev:8;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 465 (msg:"SMTP PCT Client_Hello overflow attempt"; flow:to_server,established; flowbits:isnotset,sslv2.server_hello.request; flowbits:isnotset,sslv3.server_hello.request; flowbits:isnotset,tlsv1.server_hello.request; content:"|01|"; depth:1; offset:2; byte_test:2,>,0,5; byte_test:2,!,0,7; byte_test:2,!,16,7; byte_test:2,>,20,9; content:"|8F|"; depth:1; offset:11; byte_test:2,>,32768,0,relative; reference:bugtraq,10116; reference:cve,2003-0719; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:3511; rev:21;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP SEND overflow attempt"; flow:established,to_server; content:"SEND"; nocase; isdataat:246,relative; pcre:"/^\s*SEND\s+[^\n]{246}/smi"; reference:bugtraq,11238; reference:cve,2004-1546; classtype:attempted-user; sid:3655; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP SAML overflow attempt"; flow:established,to_server; content:"SAML"; nocase; isdataat:246,relative; pcre:"/^\s*SAML\s+[^\n]{246}/smi"; reference:bugtraq,11238; reference:cve,2004-1546; classtype:attempted-user; sid:3653; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP MDaemon 6.5.1 and prior versions MAIL overflow attempt"; flow:established,to_server; content:"MAIL"; nocase; isdataat:246,relative; pcre:"/^\s*MAIL\s+[^\n]{246}/smi"; reference:bugtraq,11238; reference:cve,2004-1546; classtype:attempted-user; sid:3656; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP SOML overflow attempt"; flow:established,to_server; content:"SOML"; nocase; isdataat:246,relative; pcre:"/^\s*SOML\s+[^\n]{246}/smi"; reference:bugtraq,11238; reference:cve,2004-1546; classtype:attempted-user; sid:3654; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP spoofed MIME-Type auto-execution attempt"; flow:to_server,established; content:"Content-Type|3A|"; nocase; content:"audio/"; fast_pattern:only; pcre:"/Content-Type\x3A\s+audio\/(x-wav|mpeg|x-midi).*filename=[\x22\x27]?.{1,221}\.(vbs|exe|scr|pif|bat)/smi"; reference:bugtraq,2524; reference:cve,2001-0154; reference:url,www.microsoft.com/technet/security/bulletin/MS01-020.mspx; classtype:attempted-admin; sid:3682; rev:8;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP AUTH user overflow attempt"; flow:to_server,established; content:"AUTH"; nocase; isdataat:128,relative; pcre:"/^AUTH\s+\S+\s+[^\n]{128}/mi"; reference:bugtraq,13772; reference:cve,2005-0022; reference:cve,2005-1781; reference:cve,2005-2223; reference:cve,2007-4440; classtype:attempted-admin; sid:3824; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP eXchange POP3 mail server overflow attempt"; flow:to_server,established; content:"MAIL"; fast_pattern:only; pcre:"/^\s*MAIL\s+[^\s\n][^\n]{1006,}/smi"; reference:bugtraq,10180; reference:cve,2004-1945; classtype:misc-attack; sid:3815; rev:7;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP STARTTLS attempt"; flow:to_server,established; content:"STARTTLS"; pcre:"/^STARTTLS/smi"; flowbits:set,starttls.attempt; flowbits:noalert; classtype:protocol-command-decode; sid:2527; rev:10;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP SSLv3 Client_Hello request"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|16 03 00|"; depth:3; content:"|01|"; depth:1; offset:5; flowbits:set,sslv3.client_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:5690; rev:6;)
# alert tcp $SMTP_SERVERS 25 -> $EXTERNAL_NET any (msg:"SMTP SSLv2 Server_Hello request"; flow:from_server,established; flowbits:isset,sslv2.client_hello.request; content:"|04|"; depth:1; offset:2; content:"|00 02|"; depth:2; offset:5; flowbits:set,sslv2.server_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:5691; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP SSLv2 Client_Hello request"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; byte_test:1,>,127,0; content:"|01|"; depth:1; offset:2; content:"|00 02|"; depth:2; offset:5; flowbits:set,sslv2.client_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:5687; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP SSLv2 Client_Hello with pad request"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; byte_test:1,<,128,0; content:"|01|"; depth:1; offset:3; content:"|00 02|"; depth:2; offset:6; flowbits:set,sslv2.client_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:5688; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP TLSv1 Client_Hello request"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|16 03 01|"; depth:3; content:"|01|"; depth:1; offset:5; flowbits:set,tlsv1.client_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:5689; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP TLSv1 Client_Hello via SSLv2 handshake request"; flow:to_server,established; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; byte_test:1,>,127,0; content:"|01|"; depth:1; offset:2; content:"|03 01|"; depth:2; offset:3; flowbits:set,tlsv1.client_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:5685; rev:6;)
# alert tcp $SMTP_SERVERS 25 -> $EXTERNAL_NET any (msg:"SMTP TLSv1 Server_Hello request"; flow:to_client,established; flowbits:isset,tlsv1.client_hello.request; content:"|16 03 01|"; depth:3; content:"|02|"; depth:1; offset:5; flowbits:set,tlsv1.server_hello.request; flowbits:noalert; classtype:protocol-command-decode; sid:5686; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP x-unix-mode executable mail attachment"; flow:established,to_server; content:"x-unix-mode"; fast_pattern:only; pcre:"/x-unix-mode\s*\x3D\s*(?(?=\d{4})[0-7]([1357][0-7]{2}|[0-7][1357][0-7]|[0-7]{2}[1357])|([1357][0-7]{2}|[0-7][1357][0-7]|[0-7]{2}[1357]))/smi"; reference:bugtraq,16736; reference:cve,2006-0848; reference:url,www.heise.de/english/newsticker/news/69919; reference:url,www.kb.cert.org/vuls/id/999708; classtype:attempted-user; sid:5714; rev:5;)
alert tcp $HOME_NET 25 -> $EXTERNAL_NET any (msg:"SMTP headers too long server response"; flow:to_client,established; content:"552"; content:"Headers"; fast_pattern:only; pcre:"/^552[A-Z0-9\s\x5F\x2D\x2E\x28\x29\x22\x27]+Headers\s+too\s+large/smi"; reference:bugtraq,17192; reference:cve,2006-0058; classtype:bad-unknown; sid:5739; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP Windows Address Book attachment detected"; flow:to_server,established; content:"|9C CB CB 8D 13|u|D2 11 91|X|00 C0|OyV|A4|"; reference:bugtraq,17459; reference:cve,2006-0014; reference:cve,2006-2386; reference:url,www.microsoft.com/technet/security/Bulletin/MS06-016.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms06-076.mspx; classtype:misc-activity; sid:6412; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP Base64 encoded Windows Address Book attachment detected"; flow:to_server,established; content:"Content-Transfer-Encoding"; nocase; content:"base64"; distance:0; nocase; content:"nMvLjRN10hGRWADAT3lWpA"; distance:0; pcre:"/^Content-Transfer-Encoding\s*\x3A\s*base64/smi"; reference:bugtraq,17459; reference:cve,2006-0014; reference:cve,2006-2386; reference:url,www.microsoft.com/technet/security/Bulletin/MS06-016.mspx; reference:url,www.microsoft.com/technet/security/bulletin/ms06-076.mspx; classtype:misc-activity; sid:6413; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 465 (msg:"SMTP SSLv3 openssl get shared ciphers overflow attempt"; flow:to_server,established; flowbits:isnotset,sslv3.server_hello.request; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|16 03 00|"; depth:3; content:"|01|"; within:1; distance:2; content:"|03 00|"; within:2; distance:3; content:"|00|"; within:1; distance:32; byte_test:2, >, 256, 0, relative; reference:bugtraq,20249; reference:bugtraq,25831; reference:cve,2006-3738; reference:cve,2007-5135; reference:url,www.openssl.org/news/secadv_20060928.txt; classtype:attempted-admin; sid:8434; rev:15;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP SSLv3 openssl get shared ciphers overflow attempt"; flow:to_server,established; flowbits:isnotset,sslv3.server_hello.request; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|16 03 00|"; depth:3; content:"|01|"; within:1; distance:2; content:"|03 00|"; within:2; distance:3; content:"|00|"; within:1; distance:32; byte_test:2, >, 256, 0, relative; reference:bugtraq,20249; reference:bugtraq,25831; reference:cve,2006-3738; reference:cve,2007-5135; reference:url,www.openssl.org/news/secadv_20060928.txt; classtype:attempted-admin; sid:8435; rev:15;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 465 (msg:"SMTP SSLv2 openssl get shared ciphers overflow attempt"; flow:to_server,established; flowbits:isnotset,sslv2.server_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|01 00 02|"; depth:3; offset:2; byte_test:2, >, 256, 0, relative; reference:bugtraq,20249; reference:bugtraq,22083; reference:cve,2006-3738; reference:cve,2007-5135; reference:url,www.openssl.org/news/secadv_20060928.txt; classtype:attempted-admin; sid:8432; rev:14;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP SSLv2 openssl get shared ciphers overflow attempt"; flow:to_server,established; flowbits:isnotset,sslv2.server_hello.request; flowbits:isnotset,sslv3.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|01 00 02|"; depth:3; offset:2; byte_test:2, >, 256, 0, relative; reference:bugtraq,20249; reference:bugtraq,22083; reference:cve,2006-3738; reference:cve,2007-5135; reference:url,www.openssl.org/news/secadv_20060928.txt; classtype:attempted-admin; sid:8433; rev:14;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP SSLv2 openssl get shared ciphers overflow attempt"; flow:to_server,established; flowbits:isnotset,sslv3.server_hello.request; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|01 03|"; depth:2; offset:2; byte_test:2, >, 256, 1, relative; reference:bugtraq,20249; reference:bugtraq,22083; reference:cve,2006-3738; reference:cve,2007-5135; reference:url,www.openssl.org/news/secadv_20060928.txt; classtype:attempted-admin; sid:8437; rev:14;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 465 (msg:"SMTP SSLv2 openssl get shared ciphers overflow attempt"; flow:to_server,established; flowbits:isnotset,sslv3.server_hello.request; flowbits:isnotset,sslv2.client_hello.request; flowbits:isnotset,tlsv1.client_hello.request; content:"|01 03|"; depth:2; offset:2; byte_test:2, >, 256, 1, relative; reference:bugtraq,20249; reference:bugtraq,22083; reference:cve,2006-3738; reference:cve,2007-5135; reference:url,www.openssl.org/news/secadv_20060928.txt; classtype:attempted-admin; sid:8436; rev:13;)
# alert tcp $HOME_NET 25 -> $EXTERNAL_NET any (msg:"SMTP YPOPS Banner"; flow:established,to_client; content:"220 YahooPOPs!"; flowbits:set,ypops.banner; flowbits:noalert; classtype:not-suspicious; sid:8704; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP YPOPS buffer overflow attempt"; flow:established,to_server; flowbits:isset,ypops.banner; flowbits:unset,ypops.banner; pcre:"/[^\x0d\x00\x0a]{509}/"; reference:bugtraq,11256; reference:cve,2004-1558; classtype:attempted-admin; sid:8705; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Microsoft Outlook VEVENT overflow attempt"; flow:to_server,established; content:"VEVENT"; nocase; content:"DTSTART|3B|TZID"; fast_pattern:only; pcre:"/DTSTART\x3BTZID(?![=\x22])/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:bugtraq,21931; reference:cve,2007-0033; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-003.mspx; classtype:attempted-user; sid:9841; rev:7;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Microsoft Outlook VEVENT non-TZID overflow attempt"; flow:to_server,established; content:"DTSTART|3B|"; nocase; content:!"value"; within:5; nocase; content:!"TZID"; within:4; nocase; pcre:"/^DTSTART\x3B/smi"; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:bugtraq,21931; reference:cve,2007-0033; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-003.mspx; classtype:attempted-user; sid:10012; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP ClamAV mime parsing directory traversal"; flow:to_server,established; content:"Message/Partial"; fast_pattern:only; pcre:"/Content-Type\s*\x3a\s*Message\x2fPartial/smi"; pcre:"/id\s*=\s*[\x22\x27]?[^\x22\x27\n]*..[\x2f\x5c]/smi"; reference:bugtraq,22581; reference:cve,2007-0898; reference:url,labs.idefense.com/intelligence/vulnerabilities/display.php?id=476; classtype:attempted-user; sid:10186; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Exchange MODPROPS denial of service attempt"; flow:to_server,established; content:"content-classescalendarmessage"; fast_pattern:only; pcre:"/^X-MICROSOFT-CDO-MODPROPS\x3A[^\n]*(?P<prop>\w+),[^\n]*(?=prop)/Bmi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,23808; reference:cve,2007-0039; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-026.mspx; classtype:attempted-dos; sid:11222; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP MS Windows Mail UNC navigation remote command execution"; flow:established,to_server; content:"Content-Type|3A| text/html"; fast_pattern:only; pcre:"/.*<[^>]*href[^>]*(file\x3A|[cC]\x3A|\\\\).*>/"; reference:cve,2007-1658; reference:url,www.microsoft.com/technet/security/bulletin/MS07-034.mspx; classtype:attempted-user; sid:11837; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Microsoft CDO long header name"; flow:to_server,established; content:"|0D 0A|DATA|0D 0A|"; pcre:"/\r\n\w{200,}\x3a.*\r\n/"; reference:bugtraq,15067; reference:cve,2005-1987; reference:url,www.microsoft.com/technet/security/bulletin/ms05-048.mspx; classtype:attempted-admin; sid:12423; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP Recipient arbitrary command injection attempt"; flow:to_server,established; content:"RCPT TO|3A|"; nocase; content:!"ORCPT"; distance:0; nocase; pcre:"/^RCPT TO\x3a[^\n]+[\x26\x3B\x7C]+/mi"; metadata:policy security-ips drop; reference:bugtraq,25439; reference:bugtraq,38578; reference:cve,2007-4560; classtype:attempted-admin; sid:12592; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP Lotus Notes MIF viewer statement data overflow"; flow:to_server,established; content:"MIFFile"; fast_pattern:only; pcre:"/\x3C[^\s]+\s[^\x3c\x3E]{80}/si"; reference:bugtraq,26175; reference:cve,2007-5909; reference:cve,2007-5910; classtype:attempted-user; sid:12706; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP Lotus Notes MIF viewer MIFFILE comment overflow"; flow:to_server,established; content:"<MIFFile"; fast_pattern:only; content:"|23|"; isdataat:76,relative; content:!"|0A|"; within:76; reference:bugtraq,26175; reference:cve,2007-5909; reference:cve,2007-5910; classtype:attempted-user; sid:12704; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP Lotus Notes MIF viewer statement overflow"; flow:to_server,established; content:"MIFFile"; fast_pattern:only; pcre:"/\x3D[^\s\n]{88}/si"; reference:bugtraq,26175; reference:cve,2007-5909; reference:cve,2007-5910; classtype:attempted-user; sid:12705; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP Lotus 123 file attachment"; flow:to_server,established; content:"Content-Disposition|3A|"; content:".123"; pcre:"/filename\s*=[^\n]*\.123/si"; metadata:policy security-ips drop; reference:bugtraq,26200; reference:bugtraq,27835; reference:cve,2007-4222; reference:cve,2007-6593; reference:url,www-1.ibm.com/support/docview.wss?uid=swg21285600; reference:url,www.coresecurity.com/index.php5?action=item&id=2008; classtype:suspicious-filename-detect; sid:12807; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP Novell GroupWise client IMG SRC buffer overflow"; flow:to_server,established; content:"<IMG"; nocase; content:"SRC"; distance:0; nocase; isdataat:244,relative; pcre:"/src\s*\x3D(3D)?\s*['"][^'"]{244}/i"; metadata:policy security-ips drop; reference:bugtraq,26875; reference:cve,2007-6435; classtype:attempted-user; sid:13364; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP MailEnable SMTP HELO command denial of service attempt"; flow:to_server,established; content:"HELO "; depth:5; content:"|00|"; within:2; metadata:policy security-ips drop; reference:bugtraq,18630; reference:cve,2006-3277; classtype:attempted-dos; sid:13923; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP Adobe PDF JBIG2 remote code execution attempt"; flow:to_client,established; content:"JBIG2Decode"; nocase; content:"stream"; distance:0; pcre:"/JBIG2Decode.*?stream(\x0d\x0a|\x0a|\x0d)/smi"; byte_test:1, &, 64, 4, relative; byte_test:1, <, 160, 5, relative; byte_test:4, >, 35256, 6, relative,little; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy security-ips drop, service smtp; reference:bugtraq,33751; reference:cve,2009-0658; classtype:attempted-user; sid:15358; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP Suspicious JBIG2 pdf file sent via email"; flow:to_server,established; flowbits:isset,email.pdf; content:"KQklHMkRlY29kZ"; pcre:"/[A-Za-z0-9_\x2f][A-Za-z0-9_\x2f][BFJNRVZdhlptx159]KQklHMkRlY29kZ[QRSTUVWXYZabcdef][A-Za-z0-9_\x2f][A-Za-z0-9_\x2f]/"; flowbits:set,email.pdf.jbig2decode; flowbits:isset,email.pdf.javascript; flowbits:unset,email.pdf.jbig2decode; flowbits:unset,email.pdf.javascript; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,33751; reference:cve,2009-0658; classtype:attempted-user; sid:15359; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP Suspicious JBIG2 pdf file sent in email"; flow:to_server,established; flowbits:isset,email.pdf; content:"KYXZhU2NyaXB0"; pcre:"/[A-Za-z0-9_\x2f][A-Za-z0-9_\x2f][BFJNRVZdhlptx159]KYXZhU2NyaXB0/"; flowbits:set,email.pdf.javascript; flowbits:isset,email.pdf.jbig2decode; flowbits:unset,email.pdf.jbig2decode; flowbits:unset,email.pdf.javascript; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,33751; reference:cve,2009-0658; classtype:attempted-user; sid:15360; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP outlook web access script injection attempt"; flow:to_server,established; content:"Content-Type|3A|"; nocase; content:"text/html"; distance:0; nocase; pcre:"/\x3c[^\x3e]*\x00[^\x3e]*\x3e/Rsmi"; metadata:policy security-ips drop; reference:bugtraq,18381; reference:cve,2006-1193; classtype:attempted-user; sid:15367; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP Suspicious JBIG2 pdf file sent from email"; flow:to_server,established; flowbits:isset,email.pdf; content:"pCSUcyRGVjb2Rl"; pcre:"/[A-Za-z0-9_\x2f][EUk0]pCSUcyRGVjb2Rl/"; flowbits:set,email.pdf.jbig2decode; flowbits:isset,email.pdf.javascript; flowbits:unset,email.pdf.jbig2decode; flowbits:unset,email.pdf.javascript; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,33751; reference:cve,2009-0658; classtype:attempted-user; sid:15494; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP Suspicious JBIG2 pdf file sent with email"; flow:to_server,established; flowbits:isset,email.pdf; content:"SmF2YVNjcmlwd"; pcre:"/SmF2YVNjcmlwd[ABCDEFGHIJKLMNOP][A-Za-z0-9_\x2f][A-Za-z0-9_\x2f]/"; flowbits:set,email.pdf.javascript; flowbits:isset,email.pdf.jbig2decode; flowbits:unset,email.pdf.jbig2decode; flowbits:unset,email.pdf.javascript; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,33751; reference:cve,2009-0658; classtype:attempted-user; sid:15497; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP Suspicious JBIG2 pdf file sent through email"; flow:to_server,established; flowbits:isset,email.pdf; content:"phdmFTY3Jpcc"; pcre:"/[A-Za-z0-9_\x2f][EUk0]phdmFTY3Jpcc[QRST][A-Za-z0-9_\x2f]/"; flowbits:set,email.pdf.javascript; flowbits:isset,email.pdf.jbig2decode; flowbits:unset,email.pdf.jbig2decode; flowbits:unset,email.pdf.javascript; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,33751; reference:cve,2009-0658; classtype:attempted-user; sid:15496; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP Suspicious JBIG2 pdf file sent by email"; flow:to_server,established; flowbits:isset,email.pdf; content:"SkJJRzJEZWNvZZ"; pcre:"/SkJJRzJEZWNvZZ[UVWX][A-Za-z0-9_\x2f]/"; flowbits:set,email.pdf.jbig2decode; flowbits:isset,email.pdf.javascript; flowbits:unset,email.pdf.jbig2decode; flowbits:unset,email.pdf.javascript; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,33751; reference:cve,2009-0658; classtype:attempted-user; sid:15495; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP MAIL FROM command overflow attempt"; flow:to_server,established; content:"MAIL"; nocase; content:"FROM"; distance:1; nocase; content:"|3A|"; distance:0; nocase; isdataat:260; content:!"|0A|"; within:260; pcre:"/^\s*MAIL\s+FROM\s*\x3A\s*\x3C?\s*[^\x3E\s]{257}\s*/mi"; metadata:policy security-ips drop; reference:bugtraq,10290; reference:bugtraq,7506; reference:cve,2003-0263; reference:cve,2004-0399; reference:url,www.guninski.com/exim1.html; classtype:attempted-admin; sid:15574; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Novell GroupWise Internet Agent SMTP AUTH LOGIN command buffer overflow attempt"; flow:to_server,established; content:"AUTH"; nocase; content:"LOGIN"; distance:0; nocase; pcre:"/^\s*AUTH\s+LOGIN[^\x0a\x0d]{100,}(?<!\x0d)\x0a/mi"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,35065; reference:cve,2009-1636; classtype:attempted-admin; sid:16193; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP Novell Groupwise Internet Agent RCPT command overflow attempt"; flow:to_server,established; content:"RCPT TO|3A|"; nocase; isdataat:256,relative; pcre:"/^RCPT\x20TO\x3a\s*\x3c?[^\r\n\x3e]{256}(\x3e|\x0d|\x0a)/smi"; reference:bugtraq,33560; reference:cve,2009-0410; classtype:attempted-user; sid:16515; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Novell GroupWise Internet Agent Email address processing buffer overflow attempt"; flow:to_server,established; content:"MAIL"; nocase; content:"FROM"; distance:0; nocase; pcre:"/^\s*MAIL\s*FROM\s*\x3a\s*(\x3c[\x3e]*\x3e|\S+)\s+[^\x09\x0a\x0d\x20\x3d]{40}/mi"; metadata:policy security-ips drop; reference:bugtraq,35064; reference:cve,2009-1636; classtype:attempted-admin; sid:16597; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP McAfee WebShield SMTP bounce message format string attempt"; flow:to_server,established; content:"RCPT"; nocase; pcre:"/^RCPT\s+TO\x3a\s+[^\r\n]*\x25[npd]/smi"; reference:bugtraq,16742; reference:cve,2006-0559; classtype:attempted-admin; sid:17224; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 105 (msg:"SMTP Mercury Mail Transport System Buffer Overflow attempt"; flow:to_server,established,no_stream; isdataat:527; reference:bugtraq,16396; reference:cve,2005-4411; classtype:attempted-user; sid:17283; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Lotus Notes Attachment Viewer UUE file buffer overflow attempt"; flow:established,to_server; flowbits:isset,smtp.contenttype.attachment; content:"|0D 0A 0D 0A|begin|20|"; isdataat:278,relative; content:!"end|0D 0A|"; within:278; nocase; metadata:policy security-ips drop; reference:bugtraq,16576; reference:cve,2005-2618; classtype:attempted-user; sid:17333; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Content-Disposition attachment"; flow:established,to_server; content:"Content-Disposition|3A|"; nocase; content:"attachment"; distance:0; nocase; pcre:"/^Content-Disposition\x3A\s*attachment/smi"; flowbits:set,smtp.contenttype.attachment; flowbits:noalert; classtype:protocol-command-decode; sid:17332; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP IBM Lotus Notes HTML input tag buffer overflow attempt"; flow:to_server,established; content:"<input "; nocase; isdataat:128,relative; pcre:"/<input\s+[^>]*?name\s*=\s*(3D=)?[^\x20]{128}/smi"; metadata:policy security-ips drop; reference:bugtraq,26200; reference:cve,2007-4222; reference:url,www-1.ibm.com/support/docview.wss?rs=477&uid=swg21272930; classtype:attempted-user; sid:17717; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Microsoft Office RTF parsing remote code execution attempt"; flow:to_server,established; file_data:mime; content:"|5C|sp"; distance:0; content:"|5C|sn"; within:100; nocase; content:"pFragments"; within:100; nocase; content:"|5C|sv"; within:100; nocase; pcre:"/\x5Csv\s+[^\x7D]*?\x3B[^\x7D]*?\x3B[^\x7B]{12}/smi"; byte_test:4,>,4,8,relative,little; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:cve,2010-3333; reference:url,www.microsoft.com/technet/security/bulletin/MS10-087; classtype:attempted-user; sid:18310; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP RCPT TO IPSwitch proxy overflow attempt"; flow:to_server,established; content:"RCPT TO|3A|"; content:"|3A|"; within:500; nocase; pcre:"/^RCPT TO\x3A[^\r\n\x3C]*\x3C(?=[^\r\n\x3E]*\x3A)[^\r\n\x3E]{460}/mi"; reference:bugtraq,19885; reference:cve,2006-4379; reference:url,www.ipswitch.com/support/imail/releases/im20061.asp; classtype:attempted-admin; sid:18317; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS [25,465,587,691] (msg:"SMTP IBM Lotus Domino nrouter.exe iCalendar MAILTO stack buffer overflow attempt"; flow:to_server, established; content:"ORGANIZER|3A|mailto|3A|"; nocase; isdataat:300,relative; pcre:"/ORGANIZER\x3amailto\x3a[^\r\n]{300}/i"; metadata:policy security-ips drop; reference:bugtraq,43219; reference:cve,2010-3407; reference:url,www.exploit-db.com/exploits/15005/; classtype:attempted-admin; sid:18461; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Adobe Reader shell metacharacter code execution attempt"; flow:to_server,established; flowbits:isset,smtp.contenttype.attachment; content:"begin|20|"; pcre:"/^begin\s\d+\s[^\s\r\n\t]*\x60/sm"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,10931; reference:cve,2004-0630; classtype:attempted-user; sid:18526; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Microsoft Excel .xls attachment"; flow:established,to_server; content:"name="; nocase; content:".xls"; fast_pattern:only; pcre:"/name=\x22[^\x22]*\.xls/i"; flowbits:set,email.xls; flowbits:noalert; classtype:misc-activity; sid:18552; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Microsoft Excel .xlw attachment"; flow:established,to_server; content:"name="; nocase; content:".xlw"; fast_pattern:only; pcre:"/name=\x22[^\x22]*\.xlw/i"; flowbits:set,email.xls; flowbits:noalert; classtype:misc-activity; sid:18553; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Microsoft Powerpoint .ppt attachment"; flow:established,to_server; content:"name="; nocase; content:".ppt"; fast_pattern:only; pcre:"/name=\x22[^\x22]*\.ppt/i"; flowbits:set,email.ppt; flowbits:noalert; classtype:misc-activity; sid:18554; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Microsoft Word .doc attachment"; flow:established,to_server; content:"name="; nocase; content:".doc"; fast_pattern:only; pcre:"/name=\x22[^\x22]*\.doc/i"; flowbits:set,email.doc; flowbits:set,email.rtf; flowbits:noalert; classtype:misc-activity; sid:18551; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP RTF malformed second pfragments field"; flow:established,to_server; flowbits:isset,email.rtf; file_data:mime; content:"pFragments"; distance:0; nocase; content:"{|5C|sv"; within:15; nocase; pcre:"/^[^\x3B\x7D]{0,10}\x3B[^\x3B\x7D]{64}/smiR"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,44652; reference:cve,2010-3333; reference:url,www.microsoft.com/technet/security/bulletin/MS10-087.mspx; classtype:attempted-user; sid:18704; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Rich text file .rtf attachment"; flow:established,to_server; content:"name="; nocase; content:".rtf"; fast_pattern:only; pcre:"/name=\x22[^\x22]*\.rtf/i"; flowbits:set,email.rtf; flowbits:noalert; classtype:misc-activity; sid:18701; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP RTF malformed second pfragments field"; flow:established,to_server; flowbits:isset,email.rtf; content:"pFragments"; nocase; content:"{|5C|sv"; within:15; nocase; pcre:"/^[^\x3B\x7D]{0,10}\x3B[^\x3B\x7D]{64}/smiR"; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,44652; reference:cve,2010-3333; reference:url,www.microsoft.com/technet/security/bulletin/MS10-087.mspx; classtype:attempted-user; sid:18705; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP RTF malformed pfragments field"; flow:established,to_server; flowbits:isset,email.rtf; file_data:mime; content:"pFragments"; distance:0; nocase; content:"{|5C|sv"; within:15; nocase; pcre:"/[^\x3b\x7d]*\x3b[^\x3b\x7d]*\x3b.{8}/smiR"; byte_test:4,>,4,0,relative,little, string, hex; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,44652; reference:cve,2010-3333; reference:url,www.microsoft.com/technet/security/bulletin/MS10-087.mspx; classtype:attempted-user; sid:18702; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP RTF malformed pfragments field"; flow:established,to_server; flowbits:isset,email.rtf; content:"pFragments"; nocase; content:"{|5C|sv"; within:15; nocase; pcre:"/[^\x3b\x7d]*\x3b[^\x3b\x7d]*\x3b.{8}/smiR"; byte_test:4,>,4,0,relative,little, string, hex; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; reference:bugtraq,44652; reference:cve,2010-3333; reference:url,www.microsoft.com/technet/security/bulletin/MS10-087.mspx; classtype:attempted-user; sid:18703; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .msh2 attachment file type blocked by Outlook detected"; flow:to_server,established; content:".msh2"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emsh2\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18860; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .sct attachment file type blocked by Outlook detected"; flow:to_server,established; content:".sct"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2esct\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18878; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .wsh attachment file type blocked by Outlook detected"; flow:to_server,established; content:".wsh"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2ewsh\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18898; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .hta attachment file type blocked by Outlook detected"; flow:to_server,established; content:".hta"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2ehta\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18831; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .ps1xml attachment file type blocked by Outlook detected"; flow:to_server,established; content:".ps1xml"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eps1xml\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18882; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .app attachment file type blocked by Outlook detected"; flow:to_server,established; content:".app"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eapp\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18813; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP Novell GroupWise internet agent RRULE parsing buffer overflow attempt"; flow:established,to_server; content:"BEGIN:VCALENDAR"; nocase; content:"|0A|RRULE"; distance:0; nocase; isdataat:300,relative; content:!"|0A|"; within:300; metadata:policy balanced-ips drop, policy security-ips drop; reference:bugtraq,44732; reference:cve,2010-4715; classtype:attempted-admin; sid:18768; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .mad attachment file type blocked by Outlook detected"; flow:to_server,established; content:".mad"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emad\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18840; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SMTP Ipswitch IMail Server List Mailer Reply-To address buffer overflow attempt"; flow:to_server,established; content:"Reply-To|3A|"; nocase; isdataat:1024,relative; content:"Reply-To|3A|"; distance:0; pcre:"/^Reply\-To\x3a[^\n]{512}.*^Reply\-To\x3a[^\n]{512}/ism"; reference:bugtraq,41717; reference:url,osvdb.org/show/osvdb/66438; classtype:attempted-admin; sid:18808; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .mat attachment file type blocked by Outlook detected"; flow:to_server,established; content:".mat"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emat\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18847; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .ksh attachment file type blocked by Outlook detected"; flow:to_server,established; content:".ksh"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eksh\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18838; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .vsw attachment file type blocked by Outlook detected"; flow:to_server,established; content:".vsw"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2evsw\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18894; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .mdz attachment file type blocked by Outlook detected"; flow:to_server,established; content:".mdz"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emdz\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18856; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .shb attachment file type blocked by Outlook detected"; flow:to_server,established; content:".shb"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eshb\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18879; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .cpl attachment file type blocked by Outlook detected"; flow:to_server,established; content:".cpl"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2ecpl\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18822; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .psc2 attachment file type blocked by Outlook detected"; flow:to_server,established; content:".psc2"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2epsc2\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18886; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .msi attachment file type blocked by Outlook detected"; flow:to_server,established; content:".msi"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emsi\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18864; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .cer attachment file type blocked by Outlook detected"; flow:to_server,established; content:".cer"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2ecer\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18817; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .pst attachment file type blocked by Outlook detected"; flow:to_server,established; content:".pst"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2epst\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18874; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .msh1 attachment file type blocked by Outlook detected"; flow:to_server,established; content:".msh1"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emsh1\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18859; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .osd attachment file type blocked by Outlook detected"; flow:to_server,established; content:".osd"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eosd\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18868; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .mam attachment file type blocked by Outlook detected"; flow:to_server,established; content:".mam"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emam\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18843; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .isp attachment file type blocked by Outlook detected"; flow:to_server,established; content:".isp"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eisp\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18834; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .exe attachment file type blocked by Outlook detected"; flow:to_server,established; content:".exe"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eexe\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18826; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .inf attachment file type blocked by Outlook detected"; flow:to_server,established; content:".inf"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2einf\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18832; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .fxp attachment file type blocked by Outlook detected"; flow:to_server,established; content:".fxp"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2efxp\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18827; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .pif attachment file type blocked by Outlook detected"; flow:to_server,established; content:".pif"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2epif\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18870; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .vbs attachment file type blocked by Outlook detected"; flow:to_server,established; content:".vbs"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2evbs\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18892; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .mas attachment file type blocked by Outlook detected"; flow:to_server,established; content:".mas"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emas\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18846; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .mshxml attachment file type blocked by Outlook detected"; flow:to_server,established; content:".mshxml"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emshxml\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18861; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .ps2 attachment file type blocked by Outlook detected"; flow:to_server,established; content:".ps2"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eps2\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18883; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .cnt attachment file type blocked by Outlook detected"; flow:to_server,established; content:".cnt"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2ecnt\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18820; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .mdw attachment file type blocked by Outlook detected"; flow:to_server,established; content:".mdw"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emdw\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18855; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .wsf attachment file type blocked by Outlook detected"; flow:to_server,established; content:".wsf"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2ewsf\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18897; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .asp attachment file type blocked by Outlook detected"; flow:to_server,established; content:".asp"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2easp\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18814; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .lnk attachment file type blocked by Outlook detected"; flow:to_server,established; content:".lnk"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2elnk\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18839; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .msp attachment file type blocked by Outlook detected"; flow:to_server,established; content:".msp"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emsp\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18865; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .crt attachment file type blocked by Outlook detected"; flow:to_server,established; content:".crt"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2ecrt\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18823; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .plg attachment file type blocked by Outlook detected"; flow:to_server,established; content:".plg"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eplg\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18871; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .tmp attachment file type blocked by Outlook detected"; flow:to_server,established; content:".tmp"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2etmp\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18887; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .vsmacros attachment file type blocked by Outlook detected"; flow:to_server,established; content:".vsmacros"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2evsmacros\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18893; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .mav attachment file type blocked by Outlook detected"; flow:to_server,established; content:".mav"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emav\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18849; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .reg attachment file type blocked by Outlook detected"; flow:to_server,established; content:".reg"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2ereg\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18875; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .chm attachment file type blocked by Outlook detected"; flow:to_server,established; content:".chm"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2echm\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18818; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .its attachment file type blocked by Outlook detected"; flow:to_server,established; content:".its"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eits\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18835; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .mag attachment file type blocked by Outlook detected"; flow:to_server,established; content:".mag"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emag\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18842; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .mdb attachment file type blocked by Outlook detected"; flow:to_server,established; content:".mdb"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emdb\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18852; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .pcd attachment file type blocked by Outlook detected"; flow:to_server,established; content:".pcd"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2epcd\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18869; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .ade attachment file type blocked by Outlook detected"; flow:to_server,established; content:".ade"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eade\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18811; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .ins attachment file type blocked by Outlook detected"; flow:to_server,established; content:".ins"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eins\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18833; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .gadget attachment file type blocked by Outlook detected"; flow:to_server,established; content:".gadget"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2egadget\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18828; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .mar attachment file type blocked by Outlook detected"; flow:to_server,established; content:".mar"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emar\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18845; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .mdt attachment file type blocked by Outlook detected"; flow:to_server,established; content:".mdt"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emdt\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18854; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .msh1xml attachment file type blocked by Outlook detected"; flow:to_server,established; content:".msh1xml"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emsh1xml\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18862; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .ps2xml attachment file type blocked by Outlook detected"; flow:to_server,established; content:".ps2xml"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eps2xml\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18884; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .bas attachment file type blocked by Outlook detected"; flow:to_server,established; content:".bas"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2ebas\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18815; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .prf attachment file type blocked by Outlook detected"; flow:to_server,established; content:".prf"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eprf\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18872; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .url attachment file type blocked by Outlook detected"; flow:to_server,established; content:".url"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eurl\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18888; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .mau attachment file type blocked by Outlook detected"; flow:to_server,established; content:".mau"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emau\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18848; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .vb attachment file type blocked by Outlook detected"; flow:to_server,established; content:".vb"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2evb\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18889; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .mst attachment file type blocked by Outlook detected"; flow:to_server,established; content:".mst"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emst\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18866; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .cmd attachment file type blocked by Outlook detected"; flow:to_server,established; content:".cmd"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2ecmd\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18819; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .js attachment file type blocked by Outlook detected"; flow:to_server,established; content:".js"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2ejs\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18836; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .scf attachment file type blocked by Outlook detected"; flow:to_server,established; content:".scf"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2escf\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18876; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .maf attachment file type blocked by Outlook detected"; flow:to_server,established; content:".maf"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emaf\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18841; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .mda attachment file type blocked by Outlook detected"; flow:to_server,established; content:".mda"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emda\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18851; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .msh attachment file type blocked by Outlook detected"; flow:to_server,established; content:".msh"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emsh\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18858; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .wsc attachment file type blocked by Outlook detected"; flow:to_server,established; content:".wsc"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2ewsc\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18896; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .csh attachment file type blocked by Outlook detected"; flow:to_server,established; content:".csh"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2ecsh\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18824; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .maq attachment file type blocked by Outlook detected"; flow:to_server,established; content:".maq"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emaq\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18844; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .ps1 attachment file type blocked by Outlook detected"; flow:to_server,established; content:".ps1"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eps1\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18881; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .mde attachment file type blocked by Outlook detected"; flow:to_server,established; content:".mde"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emde\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18853; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .scr attachment file type blocked by Outlook detected"; flow:to_server,established; content:".scr"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2escr\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18877; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .adp attachment file type blocked by Outlook detected"; flow:to_server,established; content:".adp"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eadp\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18812; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .hpj attachment file type blocked by Outlook detected"; flow:to_server,established; content:".hpj"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2ehpj\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18830; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .hlp attachment file type blocked by Outlook detected"; flow:to_server,established; content:".hlp"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2ehlp\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18829; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .vbe attachment file type blocked by Outlook detected"; flow:to_server,established; content:".vbe"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2evbe\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18890; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .com attachment file type blocked by Outlook detected"; flow:to_server,established; content:".com"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2ecom\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18821; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .msh2xml attachment file type blocked by Outlook detected"; flow:to_server,established; content:".msh2xml"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emsh2xml\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18863; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .bat attachment file type blocked by Outlook detected"; flow:to_server,established; content:".bat"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2ebat\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18816; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .jse attachment file type blocked by Outlook detected"; flow:to_server,established; content:".jse"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2ejse\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18837; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .msc attachment file type blocked by Outlook detected"; flow:to_server,established; content:".msc"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emsc\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18857; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .vbp attachment file type blocked by Outlook detected"; flow:to_server,established; content:".vbp"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2evbp\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18891; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .ops attachment file type blocked by Outlook detected"; flow:to_server,established; content:".ops"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eops\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18867; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .shs attachment file type blocked by Outlook detected"; flow:to_server,established; content:".shs"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eshs\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18880; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .ws attachment file type blocked by Outlook detected"; flow:to_server,established; content:".ws"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2ews\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18895; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .der attachment file type blocked by Outlook detected"; flow:to_server,established; content:".der"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eder\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18825; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .maw attachment file type blocked by Outlook detected"; flow:to_server,established; content:".maw"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2emaw\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18850; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .xnk attachment file type blocked by Outlook detected"; flow:to_server,established; content:".xnk"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2exnk\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18899; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .prg attachment file type blocked by Outlook detected"; flow:to_server,established; content:".prg"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2eprg\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18873; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP .psc1 attachment file type blocked by Outlook detected"; flow:to_server,established; content:".psc1"; fast_pattern:only; pcre:"/filename\s*=\s*\x22[^\x22]*\x2epsc1\s*\x22/i"; reference:url,office.microsoft.com/en-us/outlook-help/blocked-attachments-in-outlook-HA001229952.aspx; classtype:policy-violation; sid:18885; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP Ipswitch IMail Server Mailing List Message Subject buffer overflow"; flow:to_server,established; content:"Subject|3A 20|"; nocase; content:"?Q?"; distance:0; fast_pattern; pcre:"/Subject\x3a\x20[^\n]*\x3fQ\x3f/smi"; reference:url,secunia.com/advisories/40638; classtype:attempted-admin; sid:19213; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"SMTP Postfix SMTP Server SASL AUTH Handle Reuse Memory Corruption"; flow:to_server,established; content:"EHLO"; nocase; content:"AUTH|20|"; distance:0; nocase; content:"AUTH|20|"; distance:0; nocase; metadata:policy security-ips drop; reference:bugtraq,47778; reference:cve,2011-1720; classtype:attempted-user; sid:19708; rev:2;)
