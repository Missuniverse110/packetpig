# alert udp $EXTERNAL_NET any -> $HOME_NET 7001 (msg:"POLICY AFS access"; flow:to_server; content:"|00 00 03 E7 00 00 00 00 00 00 00|e|00 00 00 00 00 00 00 00 0D 05 00 00 00 00 00 00 00|"; fast_pattern:only; reference:nessus,10441; classtype:misc-activity; sid:1504; rev:10;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY battle-mail traffic"; flow:to_server,established; content:"BattleMail"; classtype:policy-violation; sid:490; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"POLICY psyBNC access"; flow:from_server,established; content:"Welcome!psyBNC@lam3rz.de"; fast_pattern:only; classtype:bad-unknown; sid:493; rev:7;)
# Copyright 2001-2005 Sourcefire, Inc. All Rights Reserved
#
# This file may contain proprietary rules that were created, tested and
# certified by Sourcefire, Inc. (the "VRT Certified Rules") as well as
# rules that were created by Sourcefire and other third parties and
# distributed under the GNU General Public License (the "GPL Rules").  The
# VRT Certified Rules contained in this file are the property of
# Sourcefire, Inc. Copyright 2005 Sourcefire, Inc. All Rights Reserved.
# The GPL Rules created by Sourcefire, Inc. are the property of
# Sourcefire, Inc. Copyright 2002-2005 Sourcefire, Inc. All Rights
# Reserved.  All other GPL Rules are owned and copyrighted by their
# respective owners (please see www.snort.org/contributors for a list of
# owners and their respective copyrights).  In order to determine what
# rules are VRT Certified Rules or GPL Rules, please refer to the VRT
# Certified Rules License Agreement.
#
#
# $Id: policy.rules,v 1.107.2.18 2011-09-13 16:40:05 vrtbuild Exp $
#-------------
# POLICY RULES
#-------------
#

# alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY FTP anonymous login attempt"; flow:to_server,established; content:"USER"; fast_pattern:only; pcre:"/^USER\s+(anonymous|ftp)[^\w]*[\r\n]/smi"; classtype:misc-activity; sid:553; rev:10;)

alert tcp $HOME_NET 23 -> $EXTERNAL_NET any (msg:"POLICY WinGate telnet server response"; flow:from_server,established; content:"WinGate>"; reference:arachnids,366; reference:cve,1999-0657; classtype:misc-activity; sid:555; rev:8;)


# we have started to see multiple versions of this beyond 003.003, so we have
# expanded this signature to take that into account.
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"POLICY VNC server response"; flow:established; content:"RFB 0"; depth:5; content:".0"; depth:2; offset:7; classtype:misc-activity; sid:560; rev:6;)

alert udp $EXTERNAL_NET any -> $HOME_NET 5632 (msg:"POLICY PCAnywhere server response"; content:"ST"; depth:2; reference:arachnids,239; classtype:misc-activity; sid:566; rev:6;)
alert tcp $SMTP_SERVERS 25 -> $EXTERNAL_NET any (msg:"POLICY SMTP relaying denied"; flow:established,from_server; content:"550 5.7.1"; depth:70; reference:arachnids,249; reference:url,mail-abuse.org/tsi/ar-fix.html; classtype:misc-activity; sid:567; rev:11;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 9100 (msg:"POLICY HP JetDirect LCD modification attempt"; flow:to_server,established; content:"@PJL RDYMSG DISPLAY ="; reference:arachnids,302; reference:bugtraq,2245; classtype:misc-activity; sid:568; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 9000:9002 (msg:"POLICY HP JetDirect LCD modification attempt"; flow:to_server,established; content:"@PJL RDYMSG DISPLAY ="; reference:arachnids,302; reference:bugtraq,2245; classtype:misc-activity; sid:510; rev:8;)

# NOTES: This signature would be better off using uricontent, and having the
# http decoder looking at 5800 and 5802, but that is on by default
alert tcp $EXTERNAL_NET any -> $HOME_NET 5800:5802 (msg:"POLICY vncviewer Java applet download attempt"; flow:to_server,established; content:"/vncviewer.jar"; reference:nessus,10758; classtype:misc-activity; sid:1846; rev:4;)

alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY FTP file_id.diz access possible warez site"; flow:to_server,established; content:"RETR"; nocase; content:"file_id.diz"; distance:1; nocase; classtype:suspicious-filename-detect; sid:1445; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY FTP 'STOR 1MB' possible warez site"; flow:to_server,established; content:"STOR"; nocase; content:"1MB"; distance:1; nocase; classtype:misc-activity; sid:543; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY FTP 'RETR 1MB' possible warez site"; flow:to_server,established; content:"RETR"; nocase; content:"1MB"; distance:1; nocase; classtype:misc-activity; sid:544; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY FTP 'CWD  ' possible warez site"; flow:to_server,established; content:"CWD  "; depth:5; nocase; classtype:misc-activity; sid:546; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY FTP 'MKD  ' possible warez site"; flow:to_Server,established; content:"MKD  "; depth:5; nocase; classtype:misc-activity; sid:547; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY FTP 'MKD .' possible warez site"; flow:to_server,established; content:"MKD ."; depth:5; nocase; classtype:misc-activity; sid:548; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY FTP 'CWD / ' possible warez site"; flow:to_server,established; content:"CWD"; nocase; content:"/ "; distance:1; classtype:misc-activity; sid:545; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY FTP 'MKD / ' possible warez site"; flow:to_server,established; content:"MKD"; nocase; content:"/ "; distance:1; classtype:misc-activity; sid:554; rev:6;)

alert tcp $EXTERNAL_NET any -> $HOME_NET 1723 (msg:"POLICY PPTP Start Control Request attempt"; flow:to_server,established,no_stream; content:"|00 01|"; depth:2; offset:2; content:"|00 01|"; depth:2; offset:8; classtype:attempted-admin; sid:2044; rev:5;)
alert udp $EXTERNAL_NET any -> $HOME_NET 49 (msg:"POLICY xtacacs login attempt"; flow:to_server; content:"|80 01|"; depth:2; content:"|00|"; distance:4; classtype:misc-activity; sid:2040; rev:4;)
alert udp $HOME_NET 49 -> $EXTERNAL_NET any (msg:"POLICY xtacacs accepted login response"; flow:to_client; content:"|80 02|"; depth:2; content:"|01|"; distance:4; classtype:misc-activity; sid:2042; rev:4;)
alert udp $EXTERNAL_NET any -> $HOME_NET 500 (msg:"POLICY IPSec PGPNet connection attempt"; flow:to_server; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 10 02 00 00 00 00 00 00 00 00 88 0D 00 00 5C 00 00 00 01 00 00 00 01 00 00 00|P|01 01 00 02 03 00 00 24 01 01 00 00 80 01 00 06 80 02 00 02 80 03 00 03 80 04 00 05 80 0B 00 01 00 0C 00 04 00 01|Q|80 00 00 00 24 02 01 00 00 80 01 00 05 80 02 00 01 80 03 00 03 80 04 00 02 80 0B 00 01 00 0C 00 04 00 01|Q|80 00 00 00 10|"; fast_pattern:only; classtype:protocol-command-decode; sid:1771; rev:8;)
alert udp any any -> 255.255.255.255 23945 (msg:"POLICY Data Rescue IDA Pro startup license check attempt"; flow:to_server; content:"IDA|00 01 00 00 00|"; depth:8; dsize:40; classtype:policy-violation; sid:3628; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"POLICY AOL Instant Messenger Message Send"; flow:to_server,established; content:"*|02|"; depth:2; content:"|00 04 00 06|"; within:8; distance:4; byte_jump:1,16,relative; content:"|00 02|"; within:2; classtype:policy-violation; sid:3825; rev:2;)
alert tcp $EXTERNAL_NET 5190 -> $HOME_NET any (msg:"POLICY AOL Instant Messenger Message Receive"; flow:from_server,established; content:"*|02|"; depth:2; content:"|00 04 00 07|"; within:8; distance:4; byte_jump:1,16,relative; byte_jump:2,6,relative; byte_jump:2,2,relative; byte_jump:2,2,relative; byte_jump:2,2,relative; content:"|00 02|"; within:2; classtype:policy-violation; sid:3826; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 (msg:"POLICY remote desktop protocol attempted administrator connection request"; flow:to_server,established; content:"|E0|"; depth:1; offset:5; content:"mstshash"; distance:0; nocase; content:"Administr"; distance:0; nocase; pcre:"/mstshash\s*\x3d\s*Administr/smi"; reference:bugtraq,14259; reference:cve,2005-1218; reference:url,www.microsoft.com/technet/security/bulletin/MS05-041.mspx; classtype:misc-activity; sid:4060; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY web server file upload attempt"; flow:to_server,established; content:"Content-Disposition"; nocase; content:"filename"; fast_pattern:only; nocase; reference:url,www.faqs.org/rfcs/rfc1867.html; classtype:misc-activity; sid:5708; rev:4;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 5060 (msg:"POLICY Gizmo register VOIP state"; content:"INVITE sip|3A|"; nocase; content:"User-Agent|3A|"; nocase; content:"Gizmo"; fast_pattern:only; pcre:"/^User-Agent\x3A[^\n\r]+Gizmo/smi"; reference:url,www.gizmoproject.com; classtype:policy-violation; sid:6407; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY webshots desktop traffic"; flow:to_server,established; content:"User-Agent|3A|"; nocase; http_header; content:"WebshotsNetClient"; fast_pattern:only; pcre:"/User-Agent\x3A[^\n\r]+WebshotsNetClient/smiH"; reference:url,www.webshots.com; classtype:misc-activity; sid:6408; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 8200 (msg:"POLICY GoToMyPC startup"; flow:to_server,established; content:"ercbroker.servlets.PingServlet"; nocase; reference:url,www.gotomypc.com/howItWorks.tmpl; classtype:policy-violation; sid:7032; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [80,443,8200] (msg:"POLICY GoToMyPC local service running"; flow:to_server,established; content:"jedi request"; fast_pattern:only; reference:url,www.gotomypc.com/remote_access/pc_remote_access; classtype:policy-violation; sid:7033; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 706 (msg:"POLICY silc client outbound connection"; flow:to_server,established; content:"SILC"; pcre:"/SILC\x2d\d\x2e\d/smi"; reference:url,silcnet.org/docs/draft-riikonen-silc-spec-08.txt; classtype:policy-violation; sid:7031; rev:2;)
alert tcp $EXTERNAL_NET 706 -> $HOME_NET any (msg:"POLICY silc server response"; flow:to_client,established; content:"SILC"; pcre:"/SILC\x2d\d\x2e\d/smi"; content:"silc-server"; distance:0; reference:url,silcnet.org/docs/draft-riikonen-silc-spec-08.txt; classtype:policy-violation; sid:7030; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [80,443,8200] (msg:"POLICY GoToMyPC remote control attempt"; flow:to_server,established; content:"jedi"; nocase; content:"request="; distance:0; nocase; content:"jedi="; distance:0; nocase; reference:url,www.gotomypc.com/remote_access/pc_remote_access; classtype:policy-violation; sid:7034; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Google Desktop activity"; flow:to_server,established; content:"User-Agent|3A|"; nocase; http_header; content:"Google"; nocase; http_header; content:"Desktop"; nocase; http_header; pcre:"/User-Agent\x3A[^\n\r]+Google[^\n\r]+Desktop/smiH"; classtype:policy-violation; sid:7861; rev:3;)
# alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"POLICY IPv6 packets encapsulated in IPv4"; ip_proto:41; reference:bugtraq,29235; reference:cve,2008-2136; classtype:policy-violation; sid:8446; rev:3;)
alert tcp $EXTERNAL_NET 25999 -> $HOME_NET any (msg:"POLICY Xfire login successful"; flow:established,to_client; content:"|82|"; depth:1; offset:2; content:"userid"; depth:6; offset:6; reference:url,www.fryx.ch/xfire/protocol.html; classtype:policy-violation; sid:8484; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 25999 (msg:"POLICY Xfire session initiated"; flow:established,to_server; content:"UA01"; depth:4; reference:url,www.fryx.ch/xfire/protocol.html; classtype:policy-violation; sid:8482; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 25999 (msg:"POLICY Xfire login attempted"; flow:established,to_server; content:"|01|"; depth:1; offset:2; content:"name"; depth:4; offset:6; reference:url,www.fryx.ch/xfire/protocol.html; classtype:policy-violation; sid:8483; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 9030:9031 (msg:"POLICY TOR traffic anonymizer server request"; flow:established,to_server; content:"GET /tor/server"; fast_pattern:only; classtype:policy-violation; sid:9324; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 13782 (msg:"POLICY VERITAS NetBackup system - execution function call access"; flow:established,to_server; content:"|00 18 00 1B 00 02|"; depth:18; reference:bugtraq,21565; reference:cve,2006-4902; reference:cve,2006-6822; classtype:misc-activity; sid:10130; rev:4;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Visio file download"; flow:established,to_client; content:"Visio |28|TM|29| Drawing|0D 0A|"; fast_pattern:only; reference:url,office.microsoft.com/en-us/visio/default.aspx; classtype:policy-violation; sid:11835; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 3544 (msg:"POLICY Outbound Teredo traffic detected"; flow:to_server; content:" |01|"; depth:2; offset:8; byte_test:1,&,96,0; reference:cve,2007-3038; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-038.mspx; classtype:policy-violation; sid:12065; rev:2;)
alert udp $EXTERNAL_NET 3544 -> $HOME_NET any (msg:"POLICY Inbound Teredo traffic detected"; flow:to_server; content:"?|FE 83 1F|"; depth:4; offset:8; byte_test:1,&,96,0; reference:cve,2007-3038; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-038.mspx; classtype:policy-violation; sid:12068; rev:2;)
alert udp $EXTERNAL_NET 3544 -> $HOME_NET any (msg:"POLICY Inbound Teredo traffic detected"; flow:to_server; content:" |01|"; depth:2; offset:8; byte_test:1,&,96,0; reference:cve,2007-3038; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-038.mspx; classtype:policy-violation; sid:12066; rev:3;)
alert udp $HOME_NET any -> $EXTERNAL_NET 3544 (msg:"POLICY Outbound Teredo traffic detected"; flow:to_server; content:"?|FE 83 1F|"; depth:4; offset:8; byte_test:1,&,96,0; reference:cve,2007-3038; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-038.mspx; classtype:policy-violation; sid:12067; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Adobe FLV file transfer"; flow:established,to_client; content:"FLV|01|"; content:"|00 00 00 09|"; within:4; distance:1; flowbits:set,flv.xfer; classtype:misc-activity; sid:12182; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 16800:17000 (msg:"POLICY P2PTv TVAnts TCP tracker connect traffic detected"; flow:to_server,established; flowbits:isnotset,tvant.session; content:"|04 00 07 00|"; depth:4; content:"TVANTS SHARE"; depth:12; offset:8; flowbits:set,tvant.session; classtype:policy-violation; sid:12210; rev:1;)
alert tcp $EXTERNAL_NET 16800:17000 -> $HOME_NET any (msg:"POLICY P2PTv TVAnts TCP connection traffic detected"; flow:to_client,established; flowbits:isnotset,tvant.session; content:"|04 00|"; depth:2; pcre:"/[\x01|\x02|\x03|\x04|\x05|\x06|\x07]\x00.{4}\x43\x00/R"; flowbits:set,tvant.session; classtype:policy-violation; sid:12211; rev:1;)
alert udp $HOME_NET 16800:17000 -> $EXTERNAL_NET any (msg:"POLICY P2PTv TVAnt udp traffic detected"; flowbits:isnotset,tvant.session; content:"|04 00|"; depth:2; pcre:"/[\x05|\x06|\x07]\x00.{6}[SS|DS]/R"; flowbits:set,tvant.session; classtype:policy-violation; sid:12209; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Microsoft Media Player compressed skin download - .wmz"; flow:established,to_server; content:".wmz"; nocase; http_uri; pcre:"/\x2ewmz($|[\s\x3f])/iU"; reference:bugtraq,25305; reference:cve,2007-3037; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-047.mspx; classtype:policy-violation; sid:12278; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"POLICY Ruckus P2P encrypted authentication connection"; flow:to_server,established; content:"|00 00|"; content:"www.ruckus.com"; within:14; distance:7; classtype:policy-violation; sid:12427; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Google Webmail client chat applet"; flow:established,to_server; content:"POST"; nocase; content:"/mail/channel/bind"; fast_pattern:only; classtype:policy-violation; sid:12391; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Ruckus P2P client activity"; flow:to_server,established; content:"User-Agent|3A| Ruckus/"; fast_pattern:only; classtype:policy-violation; sid:12425; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5050 (msg:"POLICY Yahoo Webmail client chat applet"; flow:established,to_server; content:"<Ymsg Command="; fast_pattern:only; classtype:policy-violation; sid:12390; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Crystal Reports file download"; flow:to_client,established; flowbits:isset, rpt.download; content:"|D0 CF 11 E0 A1 B1 1A E1 00|"; fast_pattern:only; reference:bugtraq,21261; reference:cve,2006-6133; reference:url,www.microsoft.com/technet/security/bulletin/ms07-052.mspx; classtype:policy-violation; sid:12456; rev:4;)
alert udp $HOME_NET 5353 -> 224.0.0.251 5353 (msg:"POLICY Ruckus P2P broadcast domain probe"; flow:to_server; content:"ruckus|04|_tcp|05|local"; fast_pattern:only; classtype:policy-violation; sid:12426; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Microsoft Word for Mac 5 file download"; flow:to_client,established; content:"|FE|7|00 23|"; fast_pattern:only; pcre:"/^\xfe\x37\x00\x23/m"; reference:bugtraq,25906; reference:cve,2007-3899; reference:url,www.microsoft.com/technet/security/bulletin/MS07-060.mspx; classtype:policy-violation; sid:12641; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY AIM Express usage"; flow:to_server,established; content:"Host|3A| aimexpress.aol.com"; fast_pattern:only; reference:url,www.aim.com/aimexpress.adp; classtype:policy-violation; sid:12686; rev:3;)
# alert tcp $HOME_NET 3306 -> $EXTERNAL_NET any (msg:"POLICY failed mysql login attempt"; flow:established,from_server; content:"|15 04|"; depth:2; offset:5; metadata:policy security-ips alert; reference:url,dev.mysql.com/doc/refman/5.1/en/error-messages-server.html; classtype:misc-activity; sid:13357; rev:2;)
# alert tcp $HOME_NET 21 -> $EXTERNAL_NET any (msg:"POLICY failed FTP login attempt"; flow:established,from_server; content:"530 "; depth:4; metadata:policy security-ips alert; reference:url,www.ietf.org/rfc/rfc0959.txt; classtype:misc-activity; sid:13360; rev:2;)
# alert tcp $HOME_NET 143 -> $EXTERNAL_NET any (msg:"POLICY failed IMAP login attempt - invalid username/password"; flow:established,from_server; content:"NO LOGIN"; fast_pattern:only; pcre:"/^\s*\w+\s+NO LOGIN/smi"; metadata:policy security-ips alert; reference:url,www.ietf.org/rfc/rfc3501.txt; classtype:misc-activity; sid:13359; rev:3;)
# alert tcp $HOME_NET 3306 -> $EXTERNAL_NET any (msg:"POLICY mysql login attempt from unauthorized location"; flow:established,from_server; content:"j|04|"; depth:2; offset:5; metadata:policy security-ips alert; reference:url,dev.mysql.com/doc/refman/5.1/en/error-messages-server.html; classtype:misc-activity; sid:13358; rev:2;)
# alert tcp $EXTERNAL_NET !22 -> $HOME_NET any (msg:"POLICY SSH server detected on non-standard port"; flow:established,from_server; content:"SSH-"; depth:4; nocase; pcre:"/^SSH-[12]\.\d+/smi"; reference:url,www.ietf.org/rfc/rfc4251.txt; classtype:protocol-command-decode; sid:13586; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"POLICY TOR proxy connection initiation - second alternate port"; flow:to_server,established; content:"TOR"; content:"client <identity>"; classtype:policy-violation; sid:13698; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 9001:9030 (msg:"POLICY TOR proxy connection initiation"; flow:to_server,established; content:"TOR"; content:"client <identity>"; classtype:policy-violation; sid:13696; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"POLICY TOR proxy connection initiation - alternate port"; flow:to_server,established; content:"TOR"; content:"client <identity>"; classtype:policy-violation; sid:13697; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Habbo chat client successful login"; flow:to_client,established; content:"document.habboLoggedIn = true"; fast_pattern:only; metadata:policy security-ips drop; reference:url,www.habbo.com; classtype:policy-violation; sid:13863; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Microsoft Watson error reporting attempt"; flow:to_server,established; content:"User-Agent|3A| MSDW"; fast_pattern:only; content:"watson.microsoft.com"; content:"StageOne"; http_uri; metadata:policy security-ips drop; reference:url,oca.microsoft.com/en/dcp20.asp; classtype:policy-violation; sid:13864; rev:5;)
alert tcp $EXTERNAL_NET 38101 -> $HOME_NET any (msg:"POLICY Habbo chat client avatar control"; flow:to_client,established; content:"/flatctrl useradmin/"; fast_pattern:only; metadata:policy security-ips drop; reference:url,www.habbo.com; classtype:policy-violation; sid:13861; rev:2;)
# alert tcp $HOME_NET any -> any 3689 (msg:"POLICY iTunes client login attempt"; flow:established,to_server; flowbits:isset,itunes.serverinfo.request; content:"/login"; depth:6; offset:4; nocase; reference:url,www.apple.com/itunes/; classtype:misc-activity; sid:13899; rev:4;)
# alert tcp $HOME_NET any -> any 3689 (msg:"POLICY iTunes client request for server info"; flow:established,to_server; content:"/server-info"; flowbits:set,itunes.serverinfo.request; flowbits:noalert; reference:url,www.apple.com/itunes/; classtype:misc-activity; sid:13898; rev:4;)
# alert udp $HOME_NET 5353 -> 224.0.0.251 5353 (msg:"POLICY iTunes server multicast DNS response"; content:"Library|05|_daap|04|_tcp|05|local"; fast_pattern:only; content:"|00|!"; depth:2; offset:1; content:"|0E|i"; depth:2; offset:12; nocase; reference:url,www.apple.com/itunes/; reference:url,www.multicastdns.org; classtype:misc-activity; sid:13900; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY XBOX avatar retrieval request"; flow:to_server,established; content:"/avatar/"; http_uri; content:"User-Agent|3A| Xbox Live Client/"; http_header; content:"Host|3A|avatar.xboxlive.com|0D 0A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; classtype:policy-violation; sid:15172; rev:5;)
alert udp $HOME_NET any -> $HOME_NET 53 (msg:"POLICY Suspicious .ru dns query"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|ru|00|"; distance:0; pcre:"/[\x05-\x20][bcdfghjklmnpqrstvwxyz]{5,32}\x02ru\x00/i"; metadata:policy security-ips drop; classtype:trojan-activity; sid:15168; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY XBOX Netflix client activity"; flow:to_server,established; content:"User-Agent|3A| NETFLIX360|0D 0A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; classtype:policy-violation; sid:15170; rev:4;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"POLICY Nintendo Wii SSL Server Hello"; flow:to_client,established; content:"Nintendo of America Inc"; fast_pattern:only; content:"noa.nintendo.com"; content:"|16|"; depth:1; content:"|02|"; depth:6; offset:5; metadata:policy balanced-ips drop, policy security-ips drop, service ssl; classtype:policy-violation; sid:15185; rev:2;)
alert udp $HOME_NET any -> $HOME_NET 53 (msg:"POLICY Suspicious .cn dns query"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|cn|00|"; distance:0; pcre:"/[\x05-\x20][bcdfghjklmnpqrstvwxyz]{5,32}\x02cn\x00/i"; metadata:policy security-ips drop; classtype:trojan-activity; sid:15167; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY XBOX Marketplace http request"; flow:to_server,established; content:"/global"; http_uri; content:"/marketplace"; http_uri; content:"User-Agent|3A| Xbox Live Client/"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; classtype:policy-violation; sid:15171; rev:4;)
alert udp $HOME_NET any -> $EXTERNAL_NET 88 (msg:"POLICY XBOX Live Kerberos authentication request"; flow:to_server; content:"Xbox Version="; fast_pattern:only; content:"PASSPORT.NET"; metadata:policy balanced-ips drop, policy security-ips drop, service kerberos; classtype:policy-violation; sid:15169; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"POLICY pdf file sent via email"; flow:to_server,established; content:"JVBERi0x"; flowbits:set,email.pdf; flowbits:noalert; classtype:policy-violation; sid:15361; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY X-LINK2STATE CHUNK command attempt"; flow:to_server,established; content:"X-LINK2STATE"; fast_pattern:only; pcre:"/^X-LINK2STATE\s+CHUNK/smi"; reference:bugtraq,13118; reference:cve,2005-0560; reference:nessus,18024; reference:url,www.microsoft.com/technet/security/bulletin/MS05-021.mspx; classtype:protocol-command-decode; sid:3627; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY attempted download of a PDF with embedded Flash over http"; flow:to_client,established; flowbits:isset,http.pdf; content:"stream"; fast_pattern; nocase; pcre:"/^[\x0A\x0D]{1,2}[CF]WS/iR"; reference:bugtraq,35759; reference:bugtraq,44503; reference:cve,2009-1862; reference:cve,2010-3654; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:policy-violation; sid:15727; rev:9;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Adobe PDF start-of-file alternate header obfuscation"; flow:established,to_client; flowbits:isset,http.pdf; content:"%!PS-Adobe-"; fast_pattern:only; metadata:policy security-ips drop; reference:url,www.adobe.com/devnet/acrobat/pdfs/pdf_reference_1-7.pdf; classtype:misc-activity; sid:16354; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 (msg:"POLICY potentially executable file upload via FTP"; flow:established,to_server; content:"STOR"; depth:4; nocase; pcre:"/^STOR[^\r\n]+?\.(com|dll|exe|js|vbs)\s+/smi"; reference:url,tools.ietf.org/html/rfc959; classtype:policy-violation; sid:16363; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Adobe PDF alternate file magic obfuscation"; flow:established,to_client; flowbits:isset,http.pdf; content:"%COS-0.2"; depth:1032; content:"PDF-"; distance:0; metadata:policy security-ips drop; reference:url,www.adobe.com/devnet/acrobat/pdfs/pdf_reference_1-7.pdf; classtype:misc-activity; sid:16390; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Ultimate Packer for Executables/UPX v0.51-v0.61 packed file download"; flow:to_client,established; flowbits:isset,http.exe; content:"`|E8 00 00 00 00|X|83 E8|=P|8D B8|"; content:"|FF|W"; within:2; distance:3; content:"|8A 06|F|88 07|G|EB EB 90 90 90 B8 01 00 00 00 01|"; within:17; distance:28; reference:url,upx.sourceforge.net; reference:url,www.microsoft.com/whdc/system/platform/firmware/PECOFF.mspx; classtype:misc-activity; sid:16434; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Ultimate Packer for Executables/UPX v2.90,v2.93-3.00 packed file download"; flow:to_client,established; flowbits:isset,http.exe; content:"`|BE|"; content:"|8D BE|"; within:2; distance:4; pcre:"/^\x57(\x83\xCD\xFF)?\x89\xE5\x8D\x9C\x24.{4}\x31\xC0\x50\x39\xDC\x75\xFB\x46\x46\x53\x68.{4}\x57\x83\xC3\x04\x53\x68.{4}\x56\x83\xC3\x04\x53\x50\xC7\x03.{4}\x90\x90/R"; reference:url,upx.sourceforge.net; reference:url,www.microsoft.com/whdc/system/platform/firmware/PECOFF.mspx; classtype:misc-activity; sid:16436; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Ultimate Packer for Executables/UPX v0.62-v1.22 packed file download"; flow:to_client,established; flowbits:isset,http.exe; content:"|8A 06|F|88 07|G|01 DB|u|07 8B 1E 83 EE FC 11 DB|"; pcre:"/^(\x72\xED\xB8\x01.{3}|\x8A\x07\x72\xEB\xB8\x01\x00\x00\x00)\x01\xDB\x75\x07\x8B\x1E\x83\xEE\xFC\x11\xDB\x11\xC0\x01\xDB[\x73\x77].{3}\x8B\x1E\x83\xEE\xFC/R"; reference:url,upx.sourceforge.net; reference:url,www.microsoft.com/whdc/system/platform/firmware/PECOFF.mspx; classtype:misc-activity; sid:16435; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY PDF with click-to-launch executable"; flow:established,to_client; flowbits:isset,http.pdf; content:"obj"; nocase; content:"<<"; within:4; content:"/Launch"; within:100; fast_pattern; content:"/F"; pcre:"/\/F[^\/>]+\.(exe|dll|com|swf)/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2010-1240; reference:url,blog.didierstevens.com/2010/03/29/escape-from-pdf/; reference:url,blogs.adobe.com/adobereader/2010/04/didier_stevens_launch_function.html; classtype:misc-activity; sid:16523; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Google Chat web client connection"; flow:established,to_server; content:"/talkgadget/popout"; fast_pattern; nocase; http_uri; classtype:policy-violation; sid:12303; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Crystal Reports file download"; flow:to_server,established; content:".rpt"; fast_pattern; nocase; http_uri; flowbits:set, rpt.download; flowbits:noalert; classtype:policy-violation; sid:12455; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Google Desktop initial install  - installer request"; flow:to_server,established; content:"/installer?"; fast_pattern; nocase; http_uri; content:"action=install"; http_uri; content:"version="; http_uri; content:"id="; http_uri; content:"brand=GGLD"; http_uri; content:"hl="; http_uri; content:"User-Agent|3A|"; nocase; http_header; content:"Google"; nocase; http_header; content:"Desktop"; nocase; http_header; pcre:"/User-Agent\x3A[^\n\r]+Google[^\n\r]+Desktop/smiH"; classtype:policy-violation; sid:7859; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY download of executable content"; flow:to_client,established; content:"application/octet-stream"; fast_pattern; nocase; http_header; pcre:"/^Content-Type\x3a[\x20\x09]+application\/octet-stream/smiH"; file_data; content:"MZ"; within:2; reference:url,www.microsoft.com/smallbusiness/resources/technology/security/practice_safe_computing_and_thwart_online_thugs.mspx; classtype:policy-violation; sid:11192; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Yahoo Messenger web client connection"; flow:established,to_server; content:"/BootStrapper.swf"; fast_pattern; nocase; http_uri; classtype:policy-violation; sid:12305; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Habbo chat client item information download"; flow:to_server,established; content:"/gamedata/external?id=external_"; fast_pattern; nocase; http_uri; metadata:policy security-ips drop; reference:url,www.habbo.com; classtype:policy-violation; sid:13862; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"POLICY Namazu incoming namazu.cgi access"; flow:to_server,established; content:"/namazu.cgi?query="; fast_pattern; nocase; http_uri; content:"&submit=Search"; http_uri; reference:url,www.namazu.org/doc/manual.html; classtype:web-application-activity; sid:5706; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY AOL Instant Messenger web client connection"; flow:established,to_server; content:"HostCheck.aspx"; fast_pattern; nocase; http_uri; content:"aimexpress.aol.com"; http_uri; pcre:"/Cookie\x3A.*s_sq=aolsnssignin/si"; classtype:policy-violation; sid:12304; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Microsoft Messenger web client connection"; flow:established,to_server; content:"mainui.aspx"; fast_pattern; nocase; http_uri; content:"webmessenger"; nocase; classtype:policy-violation; sid:12306; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Google Desktop search query"; flow:to_server,established; content:"/complete/search?"; fast_pattern; nocase; http_uri; content:"q="; http_uri; content:"output=desktop"; http_uri; content:"sourceid=gd"; http_uri; content:"User-Agent|3A|"; nocase; http_header; content:"Google"; nocase; http_header; content:"Desktop"; nocase; http_header; pcre:"/User-Agent\x3A[^\n\r]+Google[^\n\r]+Desktop/smiH"; classtype:policy-violation; sid:7860; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Namazu outbound namazu.cgi access"; flow:to_server,established; content:"/namazu.cgi?query="; fast_pattern; nocase; http_uri; content:"&submit=Search"; http_uri; reference:url,www.namazu.org/doc/manual.html; classtype:web-application-activity; sid:5707; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Kontiki runtime detection"; flow:to_server,established; content:"User-Agent|3A| Kontiki Client"; fast_pattern; nocase; http_header; metadata:policy security-ips alert; reference:url,www.extremetech.com/article2/0,3973,365073,00.asp; classtype:policy-violation; sid:5797; rev:13;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Gizmo VOIP client start-up version check"; flow:established,to_server; content:"/dll/app?"; fast_pattern; nocase; http_uri; content:"class=DLL"; nocase; http_uri; content:"ApplicationID"; nocase; http_uri; content:"Gizmo"; nocase; http_uri; reference:url,www.gizmoproject.com; classtype:policy-violation; sid:6406; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Google Desktop initial install - firstuse request"; flow:to_server,established; content:"/firstuse?"; fast_pattern; nocase; http_uri; content:"version="; http_uri; content:"id="; http_uri; content:"brand=GGLD"; http_uri; content:"hl="; http_uri; content:"User-Agent|3A|"; nocase; http_header; content:"Google"; nocase; http_header; content:"Desktop"; nocase; http_header; pcre:"/User-Agent\x3A[^\n\r]+Google[^\n\r]+Desktop/smiH"; classtype:policy-violation; sid:7858; rev:6;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY download of executable content - x-header"; flow:to_client,established; content:"application/x-msdos-program"; fast_pattern; nocase; http_header; pcre:"/^Content-Type\x3a[\x20\x09]+application\/x-msdos-program/smiH"; pcre:"/(\r?\n){2}MZ/sm"; reference:url,www.microsoft.com/smallbusiness/resources/technology/security/practice_safe_computing_and_thwart_online_thugs.mspx; classtype:policy-violation; sid:16313; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY download of .dat file"; flow:established,to_server; content:".dat"; nocase; http_uri; pcre:"/\.dat(\x3F|$)/Ui"; classtype:misc-activity; sid:16630; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY download of .bin file"; flow:established,to_server; content:".bin"; nocase; http_uri; pcre:"/\.bin(\x3F|$)/Ui"; classtype:misc-activity; sid:16629; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY file URI scheme"; flow:established,to_client; content:"file|3A 2F 2F|"; nocase; reference:url,tools.ietf.org/html/rfc1630; reference:url,tools.ietf.org/html/rfc1738; classtype:policy-violation; sid:16642; rev:2;)
# alert tcp $HOME_NET 22 -> $EXTERNAL_NET any (msg:"POLICY Tandberg VCS SSH default key"; flow:established,to_client; content:"|BF E2 52 B5 9A 23 8F E9 FE 10 49 C4 36 BD 31 85 D6 7E 41 C9 15 42 F1 01|"; metadata:policy security-ips drop; reference:cve,2009-4510; reference:url,www.tandberg.com/video-conferencing-network-infrastructure/video-communication-server.jsp; reference:url,www.vsecurity.com/resources/advisory/20100409-1/; classtype:misc-activity; sid:16680; rev:4;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 17185 (msg:"POLICY VxWorks remote debugging agent login attempt"; content:"|00 00 00 00 00 00 00 02 55 55 55 55 00 00 00 01 00 00 00 01|"; depth:20; offset:4; metadata:policy security-ips drop; reference:cve,2010-2965; reference:url,blog.metasploit.com/2010/08/vxworks-vulnerabilities.html; reference:url,www.kb.cert.org/vuls/id/362332; classtype:protocol-command-decode; sid:17110; rev:2;)
# alert tcp any [139,445] -> $HOME_NET any (msg:"POLICY Portable Executable binary file transfer over SMB"; flow:to_client,established; content:"|FF|SMB"; depth:4; offset:4; byte_jump:1,28,relative,multiplier 2; content:"MZ|90 00|"; within:4; distance:2; byte_jump:4,56,relative,little; content:"PE|00 00|"; within:4; distance:-64; classtype:policy-violation; sid:17210; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY base64-encoded uri data object found"; flow:to_client,established; file_data; content:"base64"; pcre:"/<\s*object[^>]*?data\s*\x3A[^,>]*?base64/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,tools.ietf.org/html/rfc2397; classtype:policy-violation; sid:17291; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Microsoft Media Player compressed skin download - .wmd"; flow:established,to_server; content:".wmd"; nocase; http_uri; pcre:"/\x2ewmd\b/iU"; reference:bugtraq,25305; reference:cve,2007-3037; reference:url,www.microsoft.com/technet/security/Bulletin/MS07-047.mspx; classtype:policy-violation; sid:17546; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY download of Windows .lnk file that executes cmd.exe detected"; flow:to_client,established; flowbits:isset,http.lnk; content:"WINDOWS|5C|system32|5C|cmd|2E|exe"; nocase; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:bugtraq,15069; reference:cve,2005-2122; reference:url,www.microsoft.com/technet/security/Bulletin/MS05-049.mspx; classtype:attempted-user; sid:17442; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 6504 (msg:"POLICY CA BightStor ARCserver Backup possible insecure method access"; flow:established, to_server; dce_iface:506b1890-14c8-11d1-bbc3-00805fa6962e; dce_opnum:383-396; metadata:policy balanced-ips drop, policy security-ips drop, service dcerpc; reference:cve,2007-5328; reference:url,secunia.com/advisories/27192/; classtype:attempted-user; sid:17577; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY download of a PDF with embedded JavaScript - JS string"; flow:established,to_client; content:"obj"; nocase; content:"<<"; within:4; content:"/JS"; distance:0; fast_pattern; nocase; pcre:"/obj[\s\x0d\x0a]{0,2}<<[^>]*?\x2fJS[\s|>|<]/smi"; reference:url,www.adobe.com/devnet/acrobat/javascript.html; classtype:policy-violation; sid:17668; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY FlashPix file download request"; flow:to_server, established; content:".fpx"; nocase; flowbits:set,http.fpx; flowbits:noalert; classtype:policy-violation; sid:17739; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY Microsoft Excel with embedded Flash file attachment"; flow:established,to_server; flowbits:isset,email.xls; file_data:mime; content:"ShockwaveFlashObjects"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; classtype:attempted-user; sid:18548; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Microsoft Excel with embedded Flash file transfer"; flow:to_client,established; flowbits:isset,http.xls; content:"ShockwaveFlashObjects"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; classtype:attempted-user; sid:18545; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY Microsoft Word with embedded Flash file attachment"; flow:established,to_server; flowbits:isset,email.doc; file_data:mime; content:"CONTROL ShockwaveFlash.ShockwaveFlash"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; classtype:attempted-user; sid:18549; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY Microsoft Powerpoint with embedded Flash file attachment"; flow:established,to_server; flowbits:isset,email.ppt; file_data:mime; content:"|53 00 68 00 6F 00 63 00 6B 00 77 00 61 00 76 00 65 00 20 00 46 00 6C 00 61 00 73 00 68 00 20 00 4F 00 62 00 6A 00 65 00 63 00 74 00|"; distance:0; metadata:policy balanced-ips drop, policy security-ips drop, service smtp; classtype:attempted-user; sid:18550; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Microsoft Word with embedded Flash file transfer"; flow:to_client,established; flowbits:isset,http.doc; content:"CONTROL ShockwaveFlash.ShockwaveFlash"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:cve,2011-0611; reference:url,www.adobe.com/support/security/advisories/apsa11-02.html; classtype:attempted-user; sid:18546; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Microsoft Powerpoint with embedded Flash file transfer"; flow:to_client,established; flowbits:isset,http.ppt; content:"|53 00 68 00 6F 00 63 00 6B 00 77 00 61 00 76 00 65 00 20 00 46 00 6C 00 61 00 73 00 68 00 20 00 4F 00 62 00 6A 00 65 00 63 00 74 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy security-ips drop, service http; classtype:attempted-user; sid:18547; rev:2;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"POLICY Dropbox desktop software in use"; flow:to_client,established; content:"|30 14 06 03 55 04 03 14 0D 2A|.dropbox.com"; nocase; classtype:policy-violation; sid:18609; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Dropbox desktop software in use"; flow:to_server,established; content:"/subscribe?host_int="; nocase; http_uri; content:"dropbox.com"; nocase; http_header; classtype:policy-violation; sid:18608; rev:3;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY PDF file with embedded PDF object"; flow:established,to_client; file_data; content:"EmbeddedFile"; distance:0; nocase; content:"3C7064663E"; distance:0; nocase; content:"3C2F7064663E"; distance:0; nocase; reference:url,www.adobe.com/devnet/acrobat/javascript.html; classtype:policy-violation; sid:18684; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY RTF file with embedded OLE object"; flow:established,to_client; flowbits:isset,http.rtf; file_data; content:"d0cf11e"; distance:0; nocase; reference:url,www.adobe.com/devnet/acrobat/javascript.html; classtype:policy-violation; sid:18685; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY download of a PDF with embedded JavaScript - JavaScript string"; flow:established,to_client; content:"obj"; nocase; content:"<<"; within:4; content:"/JavaScript"; distance:0; fast_pattern; nocase; pcre:"/obj[\s\x0d\x0a]{0,2}<<[^>]*\x2fJavaScript/smi"; reference:url,www.adobe.com/devnet/acrobat/javascript.html; classtype:policy-violation; sid:18681; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY download of a PDF with OpenAction object"; flow:established,to_client; content:"obj"; nocase; content:"<<"; within:4; content:"/OpenAction"; distance:0; fast_pattern; nocase; pcre:"/obj[\s\x0d\x0a]{0,2}<<[^>]*\x2fOpenAction/smi"; reference:url,www.adobe.com/devnet/acrobat/javascript.html; classtype:policy-violation; sid:18682; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Excel file with embedded PDF object"; flow:established,to_client; flowbits:isset,http.xls; file_data; content:"startxref"; distance:0; nocase; content:"%%EOF"; distance:0; nocase; isdataat:!3,relative; reference:url,www.adobe.com/devnet/acrobat/javascript.html; classtype:policy-violation; sid:18683; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Visual Basic script download attempt"; flow:to_server,established; content:".vbs"; nocase; http_uri; pcre:"/\x2evbs\b/Usi"; classtype:protocol-command-decode; sid:18758; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Apple Mach-O executable download attempt"; flow:established,to_client; file_data; content:"|CA FE BA BE|"; within:4; byte_test:4, <, 20, 0, relative; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,developer.apple.com/library/mac/#documentation/DeveloperTools/Conceptual/MachORuntime/Reference/reference.html; classtype:policy-violation; sid:18983; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY Microsoft Excel with embedded Flash file attachment attempt"; flow:established,to_server; flowbits:isset,email.xls; content:"GV1M"; fast_pattern:only; pcre:"/[A-Za-z0-9_\x2f][A-Za-z0-9_\x2f][BFJNRVZdhlptx159]GV1M[IJK]/"; classtype:attempted-user; sid:19065; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY Microsoft Excel with embedded Flash file attachment attempt"; flow:established,to_server; flowbits:isset,email.xls; content:"ZXUw"; fast_pattern:only; pcre:"/[A-Za-z0-9_\x2f][EUk0]ZXUw[ghijklmnopqr][A-Za-z0-9_\x2f]/"; classtype:attempted-user; sid:19066; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY Microsoft Excel with embedded Flash file attachment attempt"; flow:established,to_server; flowbits:isset,email.xls; content:"RldTC"; fast_pattern:only; pcre:"/RldTC[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuv][A-Za-z0-9_\x2f][A-Za-z0-9_\x2f]/"; classtype:attempted-user; sid:19067; rev:1;)
# alert udp $HOME_NET any -> $HOME_NET 53 (msg:"POLICY Suspicious .cc dns query"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|cc|00|"; distance:0; pcre:"/[\x05-\x20][bcdfghjklmnpqrstvwxyz]{5,32}\x02cc\x00/i"; metadata:policy security-ips drop; classtype:trojan-activity; sid:19020; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY Microsoft Excel with embedded Flash file attachment attempt"; flow:established,to_server; flowbits:isset,email.xls; content:"Q1dTC"; fast_pattern:only; pcre:"/Q1dTC[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuv][A-Za-z0-9_\x2f][A-Za-z0-9_\x2f]/"; classtype:attempted-user; sid:19070; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY Microsoft Excel with embedded Flash file attachment attempt"; flow:established,to_server; flowbits:isset,email.xls; content:"DV1M"; fast_pattern:only; pcre:"/[A-Za-z0-9_\x2f][A-Za-z0-9_\x2f][BFJNRVZdhlptx159]DV1M[IJK]/"; classtype:attempted-user; sid:19068; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY Microsoft Excel with embedded Flash file attachment attempt"; flow:established,to_server; flowbits:isset,email.xls; content:"NXUw"; fast_pattern:only; pcre:"/[A-Za-z0-9_\x2f][EUk0]NXUw[ghijklmnopqr][A-Za-z0-9_\x2f]/"; classtype:attempted-user; sid:19069; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY HP Universal CMDB server axis2 service upload attempt"; flow:established,to_server; content:"/axis2/axis2-admin/upload"; fast_pattern:only; nocase; http_uri; content:"POST"; http_method; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,secunia.com/advisories/42763/; classtype:attempted-admin; sid:19158; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY Microsoft Excel file download"; flow:to_client,established; file_data; content:"|D0 CF 11 E0|"; within:4; content:"W|00|o|00|r|00|k|00|b|00|o|00|o|00|k|00|"; fast_pattern:only; flowbits:set,http.xls; classtype:policy-violation; sid:19166; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Google Chrome extension download attempt"; flow:to_server,established; content:".crx"; nocase; http_uri; pcre:"/^[^\?]*\.crx([\?\x5c\x2f]|$)/Usi"; flowbits:set,http.crx; classtype:protocol-command-decode; sid:19215; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Cisco Webex wrf download attempt"; flow:to_server,established; content:".wrf"; nocase; http_uri; pcre:"/\.wrf\b/Ui"; flowbits:set,http.wrf; flowbits:noalert; classtype:policy-violation; sid:19224; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Zip archive file download"; flow:to_server,established; content:".zip"; nocase; http_uri; pcre:"/\x2Ezip([\?\x5c\x2f]|$)/smiU"; flowbits:set,http.zip; classtype:policy-violation; sid:19211; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY attempted download of a PDF with embedded Flash over smtp"; flow:to_server,established; content:"dHJlYW0K"; fast_pattern:only; pcre:"/dHJlYW0K[A-Za-z0-9_\x2f][FVl1]dT/s"; reference:bugtraq,35759; reference:bugtraq,44503; reference:cve,2009-1862; reference:cve,2010-3654; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:policy-violation; sid:19273; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY attempted download of a PDF with embedded Flash over smtp"; flow:to_server,established; content:"cmVhbQ0K"; fast_pattern:only; pcre:"/cmVhbQ0K[A-Za-z0-9_\x2f][FVl1]dT/s"; reference:bugtraq,35759; reference:bugtraq,44503; reference:cve,2009-1862; reference:cve,2010-3654; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:policy-violation; sid:19271; rev:1;)
alert tcp $EXTERNAL_NET 110 -> $HOME_NET any (msg:"POLICY attempted download of a PDF with embedded Flash over pop3"; flow:to_client,established; content:"cmVhbQ0K"; fast_pattern:only; pcre:"/cmVhbQ0K[A-Za-z0-9_\x2f][FVl1]dT/s"; reference:bugtraq,35759; reference:bugtraq,44503; reference:cve,2009-1862; reference:cve,2010-3654; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:policy-violation; sid:19277; rev:1;)
alert tcp $EXTERNAL_NET 110 -> $HOME_NET any (msg:"POLICY attempted download of a PDF with embedded Flash over pop3"; flow:to_client,established; content:"cmVhbQ"; fast_pattern:only; pcre:"/cmVhbQ[opqr][A-Za-z0-9_\x2f]/s"; reference:bugtraq,35759; reference:bugtraq,44503; reference:cve,2009-1862; reference:cve,2010-3654; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:policy-violation; sid:19280; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY attempted download of a PDF with embedded Flash over smtp"; flow:to_server,established; content:"cmVhbQ"; fast_pattern:only; pcre:"/cmVhbQ[opqr][A-Za-z0-9_\x2f]/s"; reference:bugtraq,35759; reference:bugtraq,44503; reference:cve,2009-1862; reference:cve,2010-3654; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:policy-violation; sid:19274; rev:1;)
alert tcp $EXTERNAL_NET 110 -> $HOME_NET any (msg:"POLICY attempted download of a PDF with embedded Flash over pop3"; flow:to_client,established; content:"c3RyZWFtCi5X"; fast_pattern:only; reference:bugtraq,35759; reference:bugtraq,44503; reference:cve,2009-1862; reference:cve,2010-3654; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:policy-violation; sid:19278; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY attempted download of a PDF with embedded Flash over smtp"; flow:to_server,established; content:"c3RyZWFtDQ"; fast_pattern:only; pcre:"/c3RyZWFtDQ[opqr][A-Za-z0-9_\x2f]V1N8/s"; reference:bugtraq,35759; reference:bugtraq,44503; reference:cve,2009-1862; reference:cve,2010-3654; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:policy-violation; sid:19269; rev:1;)
alert tcp $EXTERNAL_NET 110 -> $HOME_NET any (msg:"POLICY attempted download of a PDF with embedded Flash over pop3"; flow:to_client,established; content:"c3RyZWFtDQ"; fast_pattern:only; pcre:"/c3RyZWFtDQ[opqr][A-Za-z0-9_\x2f]V1N8/s"; reference:bugtraq,35759; reference:bugtraq,44503; reference:cve,2009-1862; reference:cve,2010-3654; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:policy-violation; sid:19275; rev:1;)
alert tcp $EXTERNAL_NET 110 -> $HOME_NET any (msg:"POLICY attempted download of a PDF with embedded Flash over pop3"; flow:to_client,established; content:"dHJlYW0K"; fast_pattern:only; pcre:"/dHJlYW0K[A-Za-z0-9_\x2f][FVl1]dT/s"; reference:bugtraq,35759; reference:bugtraq,44503; reference:cve,2009-1862; reference:cve,2010-3654; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:policy-violation; sid:19279; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY attempted download of a PDF with embedded Flash over smtp"; flow:to_server,established; content:"c3RyZWFtCi5X"; fast_pattern:only; reference:bugtraq,35759; reference:bugtraq,44503; reference:cve,2009-1862; reference:cve,2010-3654; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:policy-violation; sid:19272; rev:1;)
alert tcp $EXTERNAL_NET [139,445] -> $HOME_NET any (msg:"POLICY attempted download of a PDF with embedded Flash over smb"; flow:to_client,established; content:"stream"; fast_pattern; nocase; pcre:"/^[\x0A\x0D]{1,2}[CF]WS/iR"; reference:bugtraq,35759; reference:bugtraq,44503; reference:cve,2009-1862; reference:cve,2010-3654; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:policy-violation; sid:19268; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"POLICY attempted download of a PDF with embedded Flash over smtp"; flow:to_server,established; content:"dHJlYW0NCi5X"; fast_pattern:only; reference:bugtraq,35759; reference:bugtraq,44503; reference:cve,2009-1862; reference:cve,2010-3654; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:policy-violation; sid:19270; rev:1;)
alert tcp $EXTERNAL_NET 110 -> $HOME_NET any (msg:"POLICY attempted download of a PDF with embedded Flash over pop3"; flow:to_client,established; content:"dHJlYW0NCi5X"; fast_pattern:only; reference:bugtraq,35759; reference:bugtraq,44503; reference:cve,2009-1862; reference:cve,2010-3654; reference:url,blogs.adobe.com/psirt/2009/07/potential_adobe_reader_and_fla.html; classtype:policy-violation; sid:19276; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY proxycgi proxy connection detected"; flow:established,to_server; content:"/cgi-bin/anon-www.cgi/http"; fast_pattern:only; http_uri; reference:url,anonymouse.org; classtype:policy-violation; sid:19475; rev:1;)
alert udp $HOME_NET any -> any 53 (msg:"POLICY hamachi VPN outbound traffic detected"; flow:to_server; content:"|01 00|"; depth:2; offset:2; content:"|0A|hamachi-dc|0F|logmein-gateway|03|com"; fast_pattern:only; reference:url,secure.logmein.com/products/hamachi2/download.aspx; classtype:policy-violation; sid:19474; rev:1;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"POLICY stunnel proxy connection detected"; flow:established,to_client; content:"|13 16|Stunnel Developers Ltd"; fast_pattern:only; reference:url,en.wikipedia.org/wiki/Stunnel; classtype:policy-violation; sid:19473; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY proxytunnel proxy connection detected"; flow:established,to_server; content:"CONNECT localhost|3A|22"; depth:20; nocase; reference:url,proxytunnel.sourceforge.net; classtype:policy-violation; sid:19472; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"POLICY dnstunnel v0.5 outbound traffic detected"; flow:to_server; content:"|01 00|"; depth:2; offset:2; byte_test:1,>,20,12; content:"|00 10 00 01|"; offset:34; detection_filter:track by_src, count 5, seconds 1; reference:url,www.hsc.fr/ressources/outils/dns2tcp/index.html.en; classtype:policy-violation; sid:19471; rev:1;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"POLICY self-signed SSL certificate with default Internet Widgits Pty Ltd organization name"; flow:established,to_client; content:"|55 04 0A 13 18|Internet Widgits Pty Ltd"; fast_pattern:only; nocase; reference:url,en.wikipedia.org/wiki/Self-signed_certificate; reference:url,security.ncsa.illinois.edu/research/grid-howtos/usefulopenssl.html; classtype:policy-violation; sid:19551; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY PDF with click-to-launch executable"; flow:established,to_client; flowbits:isset,http.pdf; content:"/F"; content:"/Mac"; fast_pattern; nocase; pcre:"/\x2fF\s*(<<|)\s*\x2fMac\s*\x28/smi"; metadata:policy security-ips drop; reference:cve,2010-1240; reference:url,blog.didierstevens.com/2010/03/29/escape-from-pdf/; reference:url,blogs.adobe.com/adobereader/2010/04/didier_stevens_launch_function.html; classtype:misc-activity; sid:19648; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY PDF with click-to-launch executable"; flow:established,to_client; flowbits:isset,http.pdf; content:"/F"; content:"/Unix"; fast_pattern; nocase; pcre:"/\x2fF\s*(<<|)\s*\x2fUnix\s*\x28/smi"; metadata:policy security-ips drop; reference:cve,2010-1240; reference:url,blog.didierstevens.com/2010/03/29/escape-from-pdf/; reference:url,blogs.adobe.com/adobereader/2010/04/didier_stevens_launch_function.html; classtype:misc-activity; sid:19647; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY PDF with click-to-launch executable"; flow:established,to_client; flowbits:isset,http.pdf; content:"/F"; content:"/DOS"; fast_pattern; nocase; pcre:"/\x2fF\s*(<<|)\s*\x2fDOS\s*\x28/smi"; metadata:policy security-ips drop; reference:cve,2010-1240; reference:url,blog.didierstevens.com/2010/03/29/escape-from-pdf/; reference:url,blogs.adobe.com/adobereader/2010/04/didier_stevens_launch_function.html; classtype:misc-activity; sid:19646; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Rapidshare file-sharing site contacted"; flow:established,to_server; content:"auth.html?"; nocase; http_uri; content:"authcode="; distance:0; nocase; http_uri; content:"Host|3A| www.rapidshare.com"; fast_pattern:only; nocase; http_header; reference:url,www.rapidshare.com; classtype:policy-violation; sid:19737; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Filesonic file-sharing site contacted"; flow:established,to_server; content:"Host|3A| www.filesonic.com"; fast_pattern:only; nocase; http_header; reference:url,www.filesonic.com; classtype:policy-violation; sid:19735; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Megaupload file-sharing site contacted"; flow:established,to_server; content:"/upload_done.php"; nocase; http_uri; content:".megaupload.com"; fast_pattern:only; nocase; http_header; pcre:"/^Host\x3A[^\r\n]+\.megaupload\.com/Hsmi"; reference:url,www.megaupload.com; classtype:policy-violation; sid:19736; rev:1;)
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"POLICY logmein.com connection attempt"; flow:to_client,established; content:"secure|2E|logmein|2E|com"; fast_pattern:only; reference:url,secure.logmein.com; classtype:policy-violation; sid:19780; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY String.fromCharCode with multiple encoding types detected"; flow:to_client,established; file_data; content:"String.fromCharCode"; fast_pattern:only; pcre:"/String\x2efromCharCode\s*\x28[^\x29]*0x[0-9a-f]{2}\s*,[^\x29]*,\s*0[0-7]{1,3}\s*,[^\x29]*,\s*[1-9][0-9]{0,2}\s*,/smi"; classtype:policy-violation; sid:19884; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY randomized javascript encodings detected"; flow:to_client,established; file_data; content:"script"; content:"%u"; pcre:"/%u[0-9a-f]{2}[^\x29]*%[0-9a-f]{2}[^\x29]*%u[0-9a-f]{2}[^\x29]*%[0-9a-f]{2}/"; classtype:policy-violation; sid:19867; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY potential javascript unescape obfuscation attempt detected"; flow:to_client,established; file_data; content:".write"; content:"unescape"; pcre:"/\x2ewrite\s*\x28\s*unescape\s*\x28/smi"; classtype:policy-violation; sid:19887; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY base64-encoded data object found"; flow:to_client,established; file_data; content:"text/html"; nocase; content:"base64"; within:20; nocase; pcre:"/data\s*\x3a\s*text\x2fhtml\s*\x3bbase64\s*,/smi"; metadata:policy balanced-ips drop, policy security-ips drop, service http; reference:url,tools.ietf.org/html/rfc2397; classtype:policy-violation; sid:19889; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY potential javascript unescape obfuscation attempt detected"; flow:to_client,established; file_data; content:".write"; content:"unescape"; pcre:"/var\s*([^\s]+)\s*=\s*unescape\s*\x28.*\x2ewrite\s*\x28\s*\1/smi"; classtype:policy-violation; sid:19888; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET !6666:7000 (msg:"POLICY IRC dns request on non-standard port"; flow:to_server,established; content:"USERHOST "; fast_pattern:only; pcre:"/^\s*USERHOST/smi"; metadata:policy security-ips drop; classtype:trojan-activity; sid:20095; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET !6666:7000 (msg:"POLICY IRC channel join on non-standard port"; flow:to_server,established; content:"JOIN "; fast_pattern:only; pcre:"/^\s*JOIN/smi"; metadata:policy security-ips drop; classtype:trojan-activity; sid:20092; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET !6666:7000 (msg:"POLICY IRC DCC chat request on non-standard port"; flow:to_server,established; content:"PRIVMSG "; nocase; content:" |3A|.DCC MALWARE chat"; distance:0; nocase; pcre:"/^\s*PRIVMSG/smi"; metadata:policy security-ips drop; classtype:trojan-activity; sid:20091; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET !6666:7000 (msg:"POLICY IRC nick change on non-standard port"; flow:to_server,established; content:"NICK "; fast_pattern:only; pcre:"/^\s*NICK/smi"; metadata:policy security-ips drop; classtype:trojan-activity; sid:20089; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET !6666:7000 (msg:"POLICY IRC channel notice on non-standard port"; flow:to_server,established; content:"NOTICE "; fast_pattern:only; pcre:"/^\s*NOTICE/smi"; metadata:policy security-ips drop; classtype:trojan-activity; sid:20093; rev:1;)
# alert tcp $HOME_NET any <> $EXTERNAL_NET !6666:7000 (msg:"POLICY IRC message on non-standard port"; flow:established; content:"PRIVMSG "; fast_pattern:only; pcre:"/^\s*PRIVMSG/smi"; metadata:policy security-ips drop; classtype:trojan-activity; sid:20094; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET !6666:7000 (msg:"POLICY IRC DCC file transfer request on non-standard port"; flow:to_server,established; content:"PRIVMSG "; nocase; content:" |3A|.DCC SEND"; distance:0; nocase; pcre:"/^\s*PRIVMSG/smi"; metadata:policy security-ips drop; classtype:trojan-activity; sid:20090; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"POLICY Oracle Sun GlassFish Server war file upload attempt"; flow:established,to_server; content:"/applications/upload"; http_uri; pcre:"/^(\.jsf|Frame\.jsf)?form\x3atitle\x3atopButtons\x3auploadButton=(\s*OK\s*|Processing)/R"; content:"form|3A|title|3A|sheet1|3A|section1|3A|prop1|3A|extension"; fast_pattern; content:".war"; within:100; reference:bugtraq,47438; reference:cve,2011-0807; classtype:attempted-admin; sid:20157; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY attempted download of a PDF with embedded PICT image"; flow:established,to_client; flowbits:isset,http.pdf; file_data; content:"PICT"; fast_pattern:only; content:"stream"; nocase; pcre:"/^[^\x0A]*?.{88}PICT/mR"; metadata:policy security-ips drop; classtype:policy-violation; sid:20146; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"POLICY Glype proxy usage detected"; flow:established,to_server; content:"/browse.php?u=Oi8v"; nocase; http_uri; content:"&b="; distance:0; nocase; http_uri; reference:url,www.glype.com; classtype:policy-violation; sid:20136; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"POLICY attempted download of a PDF with embedded PCX image"; flow:established,to_client; flowbits:isset,http.pdf; file_data; content:"stream"; nocase; pcre:"/^[^\x0A]*?\x0A[\x00\x02\x03\x05][\x00\x01][\x01\x04\x08\x24].{60}\x00.{5}\x00{58}/mR"; metadata:policy security-ips drop; classtype:policy-violation; sid:20151; rev:1;)
